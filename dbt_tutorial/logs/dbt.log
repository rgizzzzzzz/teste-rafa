[0m12:00:29.157035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4ce31a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4bafdcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4bafdcf0>]}


============================== 12:00:29.163470 | a7e3fcc1-6423-4622-9ee9-6a3d5522defd ==============================
[0m12:00:29.163470 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:00:29.164317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:00:29.438381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7e3fcc1-6423-4622-9ee9-6a3d5522defd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4bafdc90>]}
[0m12:00:29.453995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7e3fcc1-6423-4622-9ee9-6a3d5522defd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4b9ff820>]}
[0m12:00:29.460002 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m12:00:29.478526 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:00:29.485645 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:00:29.486434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a7e3fcc1-6423-4622-9ee9-6a3d5522defd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4b9ff640>]}
[0m12:00:30.995209 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/dim_product.sql
[0m12:00:31.005328 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/fact_sales.sql
[0m12:00:31.008566 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/sales_order_detail.sql
[0m12:00:31.011711 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/sales_order_header.sql
[0m12:00:31.152258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7e3fcc1-6423-4622-9ee9-6a3d5522defd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4a95beb0>]}
[0m12:00:31.163906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7e3fcc1-6423-4622-9ee9-6a3d5522defd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4a95bee0>]}
[0m12:00:31.164713 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 311 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m12:00:31.165453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7e3fcc1-6423-4622-9ee9-6a3d5522defd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4c51f100>]}
[0m12:00:31.167135 [info ] [MainThread]: 
[0m12:00:31.168153 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:00:31.169464 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m12:00:31.177986 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m12:00:31.178802 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m12:00:31.179326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:31.279830 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "host.docker.internal" (192.168.1.106), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m12:00:31.292088 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m12:00:31.292765 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:00:31.293351 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m12:00:31.293844 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m12:00:31.294344 [debug] [ThreadPool]: On list_Adventureworks: No close available on handle
[0m12:00:31.295386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:31.295814 [debug] [MainThread]: Connection 'list_Adventureworks' was properly closed.
[0m12:00:31.296343 [info ] [MainThread]: 
[0m12:00:31.296885 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.13 seconds (0.13s).
[0m12:00:31.297541 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "host.docker.internal" (192.168.1.106), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m12:00:31.298171 [debug] [MainThread]: Command `dbt run` failed at 12:00:31.298094 after 2.16 seconds
[0m12:00:31.298665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4ce31a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4a95bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4a9bc460>]}
[0m12:00:31.299229 [debug] [MainThread]: Flushing usage events
[0m12:00:53.138451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f992ae79a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9929afde10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9929afdde0>]}


============================== 12:00:53.144305 | 0f185c81-6307-4e5c-96d1-08cc38b0a81d ==============================
[0m12:00:53.144305 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:00:53.144992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:00:53.145961 [info ] [MainThread]: Setting up your profile.
[0m12:01:00.523431 [debug] [MainThread]: Command `dbt init` succeeded at 12:01:00.523195 after 7.40 seconds
[0m12:01:00.524509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f992ae79a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9929afde40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9929afde70>]}
[0m12:01:00.525589 [debug] [MainThread]: Flushing usage events
[0m12:10:49.326482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa948135a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa946c01c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa946c01c60>]}


============================== 12:10:49.332436 | 0bbd8124-99b7-4e99-add4-5537e05b54df ==============================
[0m12:10:49.332436 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:10:49.333126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:10:49.588337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bbd8124-99b7-4e99-add4-5537e05b54df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa946c01de0>]}
[0m12:10:49.604190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bbd8124-99b7-4e99-add4-5537e05b54df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa946cf88b0>]}
[0m12:10:49.609908 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m12:10:49.630208 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:10:49.669796 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:10:49.670806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0bbd8124-99b7-4e99-add4-5537e05b54df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa946cf9e40>]}
[0m12:10:51.100263 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/dim_product.sql
[0m12:10:51.110353 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/fact_sales.sql
[0m12:10:51.113361 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/sales_order_detail.sql
[0m12:10:51.116255 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/sales_order_header.sql
[0m12:10:51.258151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bbd8124-99b7-4e99-add4-5537e05b54df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9463b67a0>]}
[0m12:10:51.268901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bbd8124-99b7-4e99-add4-5537e05b54df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa946345930>]}
[0m12:10:51.269604 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 311 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m12:10:51.270317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bbd8124-99b7-4e99-add4-5537e05b54df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa947bb31f0>]}
[0m12:10:51.271976 [info ] [MainThread]: 
[0m12:10:51.272914 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:10:51.274265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m12:10:51.282574 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m12:10:51.283311 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m12:10:51.283886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:51.337745 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:10:51.339121 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m12:10:51.340394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now create_Adventureworks_warehouse)
[0m12:10:51.341180 [debug] [ThreadPool]: Creating schema "database: "Adventureworks"
schema: "warehouse"
"
[0m12:10:51.345464 [debug] [ThreadPool]: Using postgres connection "create_Adventureworks_warehouse"
[0m12:10:51.346048 [debug] [ThreadPool]: On create_Adventureworks_warehouse: BEGIN
[0m12:10:51.346734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:51.351745 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:10:51.352376 [debug] [ThreadPool]: Using postgres connection "create_Adventureworks_warehouse"
[0m12:10:51.352933 [debug] [ThreadPool]: On create_Adventureworks_warehouse: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "create_Adventureworks_warehouse"} */
create schema if not exists "warehouse"
[0m12:10:51.355002 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m12:10:51.355999 [debug] [ThreadPool]: On create_Adventureworks_warehouse: COMMIT
[0m12:10:51.356578 [debug] [ThreadPool]: Using postgres connection "create_Adventureworks_warehouse"
[0m12:10:51.357072 [debug] [ThreadPool]: On create_Adventureworks_warehouse: COMMIT
[0m12:10:51.360734 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m12:10:51.361352 [debug] [ThreadPool]: On create_Adventureworks_warehouse: Close
[0m12:10:51.362914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_Adventureworks_warehouse, now list_Adventureworks_warehouse)
[0m12:10:51.367213 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_warehouse"
[0m12:10:51.367742 [debug] [ThreadPool]: On list_Adventureworks_warehouse: BEGIN
[0m12:10:51.368218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:51.373065 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:10:51.373608 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_warehouse"
[0m12:10:51.374108 [debug] [ThreadPool]: On list_Adventureworks_warehouse: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_warehouse"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
[0m12:10:51.377183 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m12:10:51.378337 [debug] [ThreadPool]: On list_Adventureworks_warehouse: ROLLBACK
[0m12:10:51.379015 [debug] [ThreadPool]: On list_Adventureworks_warehouse: Close
[0m12:10:51.382601 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:51.383151 [debug] [MainThread]: On master: BEGIN
[0m12:10:51.383635 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:51.388406 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:10:51.388982 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:51.389553 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:10:51.395810 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m12:10:51.399201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bbd8124-99b7-4e99-add4-5537e05b54df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9463ea140>]}
[0m12:10:51.399850 [debug] [MainThread]: On master: ROLLBACK
[0m12:10:51.400596 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:51.401103 [debug] [MainThread]: On master: BEGIN
[0m12:10:51.402022 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:10:51.402537 [debug] [MainThread]: On master: COMMIT
[0m12:10:51.403032 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:51.403512 [debug] [MainThread]: On master: COMMIT
[0m12:10:51.404212 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:10:51.404724 [debug] [MainThread]: On master: Close
[0m12:10:51.405481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:10:51.406127 [info ] [MainThread]: 
[0m12:10:51.412505 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.dim_product
[0m12:10:51.412876 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.sales_order_detail
[0m12:10:51.413226 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.sales_order_header
[0m12:10:51.413979 [info ] [Thread-1 (]: 1 of 2 START sql table model warehouse.dim_product ............................. [RUN]
[0m12:10:51.414895 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.sales_order_detail'
[0m12:10:51.415808 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.sales_order_header'
[0m12:10:51.416728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_warehouse, now model.dbt_tutorial.dim_product)
[0m12:10:51.417643 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.sales_order_detail
[0m12:10:51.418472 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.sales_order_header
[0m12:10:51.419268 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.dim_product
[0m12:10:51.425986 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.sales_order_detail"
[0m12:10:51.428238 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.sales_order_header"
[0m12:10:51.431131 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.dim_product"
[0m12:10:51.439840 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.sales_order_detail (compile): 12:10:51.419960 => 12:10:51.439524
[0m12:10:51.441061 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.sales_order_detail
[0m12:10:51.441418 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.sales_order_header (compile): 12:10:51.426498 => 12:10:51.441262
[0m12:10:51.442922 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.sales_order_header
[0m12:10:51.443257 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.dim_product (compile): 12:10:51.428808 => 12:10:51.443101
[0m12:10:51.444221 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.fact_sales
[0m12:10:51.444704 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.dim_product
[0m12:10:51.445420 [info ] [Thread-4 (]: 2 of 2 START sql table model warehouse.fact_sales .............................. [RUN]
[0m12:10:51.467362 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_tutorial.fact_sales'
[0m12:10:51.483602 [debug] [Thread-4 (]: Began compiling node model.dbt_tutorial.fact_sales
[0m12:10:51.486193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:10:51.492615 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_tutorial.fact_sales"
[0m12:10:51.493154 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */
select * from (
        SELECT 
    productid, 
    "name", 
    productnumber, 
    makeflag, 
    finishedgoodsflag, 
    color, 
    safetystocklevel, 
    reorderpoint, 
    standardcost, 
    listprice, 
    "size", 
    sizeunitmeasurecode, 
    weightunitmeasurecode, 
    "weight", 
    daystomanufacture, 
    productline, 
    "class", 
    "style", 
    productsubcategoryid, 
    productmodelid, 
    sellstartdate, 
    sellenddate, 
    discontinueddate, 
    modifieddate
FROM 
    "Adventureworks"."production"."product"
    ) as __dbt_sbq
    where false
    limit 0

[0m12:10:51.494194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:51.498377 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.fact_sales (compile): 12:10:51.486667 => 12:10:51.498190
[0m12:10:51.498978 [debug] [Thread-4 (]: Began executing node model.dbt_tutorial.fact_sales
[0m12:10:51.502564 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_tutorial.fact_sales"
[0m12:10:51.502938 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m12:10:51.509192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:10:51.509904 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */
select * from (
        select
    
      cast(null as int) as productid, 
      cast(null as varchar) as name, 
      cast(null as varchar) as productnumber, 
      cast(null as boolean) as makeflag, 
      cast(null as boolean) as finishedgoodsflag, 
      cast(null as varchar) as color, 
      cast(null as int) as safetystocklevel, 
      cast(null as int) as reorderpoint, 
      cast(null as numeric) as standardcost, 
      cast(null as numeric) as listprice, 
      cast(null as varchar) as size, 
      cast(null as varchar) as sizeunitmeasurecode, 
      cast(null as varchar) as weightunitmeasurecode, 
      cast(null as numeric) as weight, 
      cast(null as int) as daystomanufacture, 
      cast(null as varchar) as productline, 
      cast(null as varchar) as class, 
      cast(null as varchar) as style, 
      cast(null as int) as productsubcategoryid, 
      cast(null as int) as productmodelid, 
      cast(null as timestamp) as sellstartdate, 
      cast(null as timestamp) as sellenddate, 
      cast(null as timestamp) as discontinueddate, 
      cast(null as timestamp) as modifieddate
    ) as __dbt_sbq
    where false
    limit 0

[0m12:10:51.511768 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m12:10:51.534752 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.dim_product"
[0m12:10:51.535737 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:10:51.536400 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: BEGIN
[0m12:10:51.537066 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:10:51.537501 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:10:51.538472 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: BEGIN
[0m12:10:51.539492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:10:51.540234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:10:51.540860 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */

  
    

  create  table "Adventureworks"."warehouse"."dim_product__dbt_tmp"
  
  
    
  
  (
    productid int not null primary key,
    name varchar,
    productnumber varchar,
    makeflag boolean,
    finishedgoodsflag boolean,
    color varchar,
    safetystocklevel int,
    reorderpoint int,
    standardcost numeric,
    listprice numeric,
    size varchar,
    sizeunitmeasurecode varchar,
    weightunitmeasurecode varchar,
    weight numeric,
    daystomanufacture int,
    productline varchar,
    class varchar,
    style varchar,
    productsubcategoryid int,
    productmodelid int,
    sellstartdate timestamp,
    sellenddate timestamp,
    discontinueddate timestamp,
    modifieddate timestamp
    
    )
 ;
    insert into "Adventureworks"."warehouse"."dim_product__dbt_tmp" (
      productid, name, productnumber, makeflag, finishedgoodsflag, color, safetystocklevel, reorderpoint, standardcost, listprice, size, sizeunitmeasurecode, weightunitmeasurecode, weight, daystomanufacture, productline, class, style, productsubcategoryid, productmodelid, sellstartdate, sellenddate, discontinueddate, modifieddate
    )
  
  (
    
    select productid, name, productnumber, makeflag, finishedgoodsflag, color, safetystocklevel, reorderpoint, standardcost, listprice, size, sizeunitmeasurecode, weightunitmeasurecode, weight, daystomanufacture, productline, class, style, productsubcategoryid, productmodelid, sellstartdate, sellenddate, discontinueddate, modifieddate
    from (
        SELECT 
    productid, 
    "name", 
    productnumber, 
    makeflag, 
    finishedgoodsflag, 
    color, 
    safetystocklevel, 
    reorderpoint, 
    standardcost, 
    listprice, 
    "size", 
    sizeunitmeasurecode, 
    weightunitmeasurecode, 
    "weight", 
    daystomanufacture, 
    productline, 
    "class", 
    "style", 
    productsubcategoryid, 
    productmodelid, 
    sellstartdate, 
    sellenddate, 
    discontinueddate, 
    modifieddate
FROM 
    "Adventureworks"."production"."product"
    ) as model_subq
  );
  
[0m12:10:51.542619 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:10:51.543261 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:10:51.543991 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */

  
    

  create  table "Adventureworks"."warehouse"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    with __dbt__cte__sales_order_header as (


SELECT 
    salesorderid, 
    revisionnumber, 
    orderdate, 
    duedate, 
    shipdate, 
    status, 
    onlineorderflag, 
    purchaseordernumber,  
    subtotal, 
    taxamt, 
    freight, 
    totaldue, 
    rowguid as row_id,
    modifieddate
FROM "Adventureworks"."sales"."salesorderheader"
),  __dbt__cte__sales_order_detail as (


SELECT 
    salesorderid, 
    salesorderdetailid, 
    carriertrackingnumber, 
    orderqty, 
    productid, 
    specialofferid, 
    unitprice, 
    unitpricediscount, 
    rowguid as row_id, 
    modifieddate
from "Adventureworks"."sales"."salesorderdetail"
)SELECT 
    h.salesorderid, 
    d.salesorderdetailid,
    h.revisionnumber, 
    h.orderdate, 
    h.duedate, 
    h.shipdate, 
    h.status, 
    h.onlineorderflag, 
    h.purchaseordernumber, 
    h.subtotal, 
    h.taxamt, 
    h.freight, 
    h.totaldue,
    d.carriertrackingnumber, 
    d.orderqty, 
    d.productid, 
    d.specialofferid, 
    d.unitprice, 
    d.unitpricediscount
FROM __dbt__cte__sales_order_header AS h
JOIN __dbt__cte__sales_order_detail AS d
ON h.salesorderid = d.salesorderid
  );
  
[0m12:10:51.555849 [debug] [Thread-1 (]: SQL status: INSERT 0 504 in 0.0 seconds
[0m12:10:51.561673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:10:51.562344 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */
alter table "Adventureworks"."warehouse"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:10:51.563344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:10:51.585031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:10:51.585800 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "Adventureworks".INFORMATION_SCHEMA.columns
      where table_name = 'dim_product'
        
        and table_schema = 'warehouse'
        
      order by ordinal_position

  
[0m12:10:51.595560 [debug] [Thread-1 (]: SQL status: SELECT 24 in 0.0 seconds
[0m12:10:51.603647 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:10:51.604461 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */

    
  
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".productid is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".name is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".productnumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".makeflag is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".finishedgoodsflag is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".color is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".safetystocklevel is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".reorderpoint is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".standardcost is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".listprice is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".size is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".sizeunitmeasurecode is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".weightunitmeasurecode is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".weight is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".daystomanufacture is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".productline is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".class is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".style is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".productsubcategoryid is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".productmodelid is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".sellstartdate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".sellenddate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".discontinueddate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".modifieddate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  

  
[0m12:10:51.606171 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m12:10:51.607334 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: COMMIT
[0m12:10:51.607914 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:10:51.608453 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: COMMIT
[0m12:10:51.621453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:10:51.625786 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:10:51.626457 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */
drop table if exists "Adventureworks"."warehouse"."dim_product__dbt_backup" cascade
[0m12:10:51.627389 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:10:51.628781 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.dim_product (execute): 12:10:51.446009 => 12:10:51.628597
[0m12:10:51.629371 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: Close
[0m12:10:51.630205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bbd8124-99b7-4e99-add4-5537e05b54df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa946719e40>]}
[0m12:10:51.630943 [info ] [Thread-1 (]: 1 of 2 OK created sql table model warehouse.dim_product ........................ [[32mINSERT 0 504[0m in 0.21s]
[0m12:10:51.631949 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.dim_product
[0m12:10:51.745854 [debug] [Thread-4 (]: SQL status: SELECT 121317 in 0.0 seconds
[0m12:10:51.748748 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:10:51.749340 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */
alter table "Adventureworks"."warehouse"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m12:10:51.750333 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:10:51.754124 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:10:51.754719 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */

    
  
  comment on table "Adventureworks"."warehouse"."fact_sales" is $dbt_comment_literal_block$Sales fact table$dbt_comment_literal_block$;

  
[0m12:10:51.756156 [debug] [Thread-4 (]: SQL status: COMMENT in 0.0 seconds
[0m12:10:51.758461 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:10:51.759077 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "Adventureworks".INFORMATION_SCHEMA.columns
      where table_name = 'fact_sales'
        
        and table_schema = 'warehouse'
        
      order by ordinal_position

  
[0m12:10:51.764161 [debug] [Thread-4 (]: SQL status: SELECT 19 in 0.0 seconds
[0m12:10:51.767247 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:10:51.767886 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */

    
  
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".salesorderid is $dbt_comment_literal_block$sales order id from salesorderheader table$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".salesorderdetailid is $dbt_comment_literal_block$sales order detail id from the salesorderdetail table$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".revisionnumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".orderdate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".duedate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".shipdate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".status is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".onlineorderflag is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".purchaseordernumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".subtotal is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".taxamt is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".freight is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".totaldue is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".carriertrackingnumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".orderqty is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".productid is $dbt_comment_literal_block$ID of the product in product dimension$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".specialofferid is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".unitprice is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".unitpricediscount is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  

  
[0m12:10:51.769098 [debug] [Thread-4 (]: SQL status: COMMENT in 0.0 seconds
[0m12:10:51.770211 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: COMMIT
[0m12:10:51.770759 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:10:51.771275 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: COMMIT
[0m12:10:51.774806 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:10:51.776875 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:10:51.777422 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */
drop table if exists "Adventureworks"."warehouse"."fact_sales__dbt_backup" cascade
[0m12:10:51.778221 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:10:51.779462 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.fact_sales (execute): 12:10:51.499588 => 12:10:51.779323
[0m12:10:51.779990 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: Close
[0m12:10:51.780780 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bbd8124-99b7-4e99-add4-5537e05b54df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa946395450>]}
[0m12:10:51.781487 [info ] [Thread-4 (]: 2 of 2 OK created sql table model warehouse.fact_sales ......................... [[32mSELECT 121317[0m in 0.31s]
[0m12:10:51.782293 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.fact_sales
[0m12:10:51.784047 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:51.784589 [debug] [MainThread]: On master: BEGIN
[0m12:10:51.785132 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:10:51.790055 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:10:51.790793 [debug] [MainThread]: On master: COMMIT
[0m12:10:51.791371 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:51.791902 [debug] [MainThread]: On master: COMMIT
[0m12:10:51.792601 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:10:51.793119 [debug] [MainThread]: On master: Close
[0m12:10:51.793992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:51.794621 [debug] [MainThread]: Connection 'model.dbt_tutorial.dim_product' was properly closed.
[0m12:10:51.795165 [debug] [MainThread]: Connection 'model.dbt_tutorial.sales_order_detail' was properly closed.
[0m12:10:51.795696 [debug] [MainThread]: Connection 'model.dbt_tutorial.sales_order_header' was properly closed.
[0m12:10:51.796205 [debug] [MainThread]: Connection 'model.dbt_tutorial.fact_sales' was properly closed.
[0m12:10:51.796737 [info ] [MainThread]: 
[0m12:10:51.797341 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m12:10:51.798251 [debug] [MainThread]: Command end result
[0m12:10:51.808881 [info ] [MainThread]: 
[0m12:10:51.809602 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:10:51.810230 [info ] [MainThread]: 
[0m12:10:51.810867 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:10:51.811606 [debug] [MainThread]: Command `dbt run` succeeded at 12:10:51.811520 after 2.50 seconds
[0m12:10:51.812200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa948135a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa94a24c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9463e5870>]}
[0m12:10:51.812864 [debug] [MainThread]: Flushing usage events
[0m12:17:52.239434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b2311a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b0e01c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b0e01c30>]}


============================== 12:17:52.245612 | 748a029e-aacc-48c0-afd2-509990351c72 ==============================
[0m12:17:52.245612 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:17:52.246556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:17:52.515905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '748a029e-aacc-48c0-afd2-509990351c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b0e01db0>]}
[0m12:17:52.532793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '748a029e-aacc-48c0-afd2-509990351c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b0ef88b0>]}
[0m12:17:52.539289 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m12:17:52.561934 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:17:53.644824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:17:53.645712 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/warehouse/sales_order_header.sql
[0m12:17:53.646348 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/warehouse/sales_order_detail.sql
[0m12:17:53.670368 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/sales_order_header.sql
[0m12:17:53.680351 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/sales_order_detail.sql
[0m12:17:53.737494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '748a029e-aacc-48c0-afd2-509990351c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b01340d0>]}
[0m12:17:53.748892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '748a029e-aacc-48c0-afd2-509990351c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b055db40>]}
[0m12:17:53.749698 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 311 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m12:17:53.750404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '748a029e-aacc-48c0-afd2-509990351c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b055dab0>]}
[0m12:17:53.751889 [info ] [MainThread]: 
[0m12:17:53.753013 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:53.754387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m12:17:53.762685 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m12:17:53.763472 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m12:17:53.764067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:53.821270 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m12:17:53.822703 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m12:17:53.824261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now list_Adventureworks_warehouse)
[0m12:17:53.828976 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_warehouse"
[0m12:17:53.829593 [debug] [ThreadPool]: On list_Adventureworks_warehouse: BEGIN
[0m12:17:53.830162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:17:53.835039 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:17:53.835647 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_warehouse"
[0m12:17:53.836332 [debug] [ThreadPool]: On list_Adventureworks_warehouse: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_warehouse"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
[0m12:17:53.838722 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m12:17:53.839939 [debug] [ThreadPool]: On list_Adventureworks_warehouse: ROLLBACK
[0m12:17:53.840674 [debug] [ThreadPool]: On list_Adventureworks_warehouse: Close
[0m12:17:53.844562 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:53.845198 [debug] [MainThread]: On master: BEGIN
[0m12:17:53.845762 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:53.850652 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:17:53.851208 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:53.851790 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:53.856480 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m12:17:53.859792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '748a029e-aacc-48c0-afd2-509990351c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b0580fa0>]}
[0m12:17:53.860455 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:53.861180 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:53.861661 [debug] [MainThread]: On master: BEGIN
[0m12:17:53.862540 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:17:53.863057 [debug] [MainThread]: On master: COMMIT
[0m12:17:53.863590 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:53.864076 [debug] [MainThread]: On master: COMMIT
[0m12:17:53.864849 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:17:53.865379 [debug] [MainThread]: On master: Close
[0m12:17:53.866237 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:53.866845 [info ] [MainThread]: 
[0m12:17:53.871395 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.dim_product
[0m12:17:53.871736 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.sales_order_detail
[0m12:17:53.872049 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.sales_order_header
[0m12:17:53.872653 [info ] [Thread-1 (]: 1 of 4 START sql table model warehouse.dim_product ............................. [RUN]
[0m12:17:53.873399 [info ] [Thread-2 (]: 2 of 4 START sql table model warehouse.sales_order_detail ...................... [RUN]
[0m12:17:53.874132 [info ] [Thread-3 (]: 3 of 4 START sql table model warehouse.sales_order_header ...................... [RUN]
[0m12:17:53.875029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_warehouse, now model.dbt_tutorial.dim_product)
[0m12:17:53.875846 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.sales_order_detail'
[0m12:17:53.876707 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.sales_order_header'
[0m12:17:53.877312 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.dim_product
[0m12:17:53.877947 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.sales_order_detail
[0m12:17:53.878510 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.sales_order_header
[0m12:17:53.886021 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.dim_product"
[0m12:17:53.888357 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.sales_order_detail"
[0m12:17:53.890657 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.sales_order_header"
[0m12:17:53.894475 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.dim_product (compile): 12:17:53.879157 => 12:17:53.894296
[0m12:17:53.894811 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.sales_order_detail (compile): 12:17:53.886624 => 12:17:53.894651
[0m12:17:53.895407 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.dim_product
[0m12:17:53.895866 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.sales_order_header (compile): 12:17:53.888953 => 12:17:53.895713
[0m12:17:53.896507 [debug] [Thread-2 (]: Began executing node model.dbt_tutorial.sales_order_detail
[0m12:17:53.923158 [debug] [Thread-3 (]: Began executing node model.dbt_tutorial.sales_order_header
[0m12:17:53.935771 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:17:53.939180 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_tutorial.sales_order_detail"
[0m12:17:53.942332 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_tutorial.sales_order_header"
[0m12:17:53.943015 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */
select * from (
        SELECT 
    productid, 
    "name", 
    productnumber, 
    makeflag, 
    finishedgoodsflag, 
    color, 
    safetystocklevel, 
    reorderpoint, 
    standardcost, 
    listprice, 
    "size", 
    sizeunitmeasurecode, 
    weightunitmeasurecode, 
    "weight", 
    daystomanufacture, 
    productline, 
    "class", 
    "style", 
    productsubcategoryid, 
    productmodelid, 
    sellstartdate, 
    sellenddate, 
    discontinueddate, 
    modifieddate
FROM 
    "Adventureworks"."production"."product"
    ) as __dbt_sbq
    where false
    limit 0

[0m12:17:53.944580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:17:53.946707 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m12:17:53.947439 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: BEGIN
[0m12:17:53.948141 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.sales_order_header"
[0m12:17:53.948421 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:17:53.949010 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: BEGIN
[0m12:17:53.950465 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:17:53.950927 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m12:17:53.957737 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:17:53.958606 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */
select * from (
        select
    
      cast(null as int) as productid, 
      cast(null as varchar) as name, 
      cast(null as varchar) as productnumber, 
      cast(null as boolean) as makeflag, 
      cast(null as boolean) as finishedgoodsflag, 
      cast(null as varchar) as color, 
      cast(null as int) as safetystocklevel, 
      cast(null as int) as reorderpoint, 
      cast(null as numeric) as standardcost, 
      cast(null as numeric) as listprice, 
      cast(null as varchar) as size, 
      cast(null as varchar) as sizeunitmeasurecode, 
      cast(null as varchar) as weightunitmeasurecode, 
      cast(null as numeric) as weight, 
      cast(null as int) as daystomanufacture, 
      cast(null as varchar) as productline, 
      cast(null as varchar) as class, 
      cast(null as varchar) as style, 
      cast(null as int) as productsubcategoryid, 
      cast(null as int) as productmodelid, 
      cast(null as timestamp) as sellstartdate, 
      cast(null as timestamp) as sellenddate, 
      cast(null as timestamp) as discontinueddate, 
      cast(null as timestamp) as modifieddate
    ) as __dbt_sbq
    where false
    limit 0

[0m12:17:53.958972 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:17:53.959283 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:17:53.960313 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m12:17:53.960587 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.sales_order_header"
[0m12:17:53.961136 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m12:17:53.982921 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_header"} */

  
    

  create  table "Adventureworks"."warehouse"."sales_order_header__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    salesorderid, 
    revisionnumber, 
    orderdate, 
    duedate, 
    shipdate, 
    status, 
    onlineorderflag, 
    purchaseordernumber,  
    subtotal, 
    taxamt, 
    freight, 
    totaldue, 
    rowguid as row_id,
    modifieddate
FROM "Adventureworks"."sales"."salesorderheader"
  );
  
[0m12:17:53.985627 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.dim_product"
[0m12:17:53.986388 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_detail"} */

  
    

  create  table "Adventureworks"."warehouse"."sales_order_detail__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    salesorderid, 
    salesorderdetailid, 
    carriertrackingnumber, 
    orderqty, 
    productid, 
    specialofferid, 
    unitprice, 
    unitpricediscount, 
    rowguid as row_id, 
    modifieddate
from "Adventureworks"."sales"."salesorderdetail"
  );
  
[0m12:17:53.991663 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:17:53.992545 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: BEGIN
[0m12:17:53.993487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:17:53.994064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:17:53.994657 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */

  
    

  create  table "Adventureworks"."warehouse"."dim_product__dbt_tmp"
  
  
    
  
  (
    productid int not null primary key,
    name varchar,
    productnumber varchar,
    makeflag boolean,
    finishedgoodsflag boolean,
    color varchar,
    safetystocklevel int,
    reorderpoint int,
    standardcost numeric,
    listprice numeric,
    size varchar,
    sizeunitmeasurecode varchar,
    weightunitmeasurecode varchar,
    weight numeric,
    daystomanufacture int,
    productline varchar,
    class varchar,
    style varchar,
    productsubcategoryid int,
    productmodelid int,
    sellstartdate timestamp,
    sellenddate timestamp,
    discontinueddate timestamp,
    modifieddate timestamp
    
    )
 ;
    insert into "Adventureworks"."warehouse"."dim_product__dbt_tmp" (
      productid, name, productnumber, makeflag, finishedgoodsflag, color, safetystocklevel, reorderpoint, standardcost, listprice, size, sizeunitmeasurecode, weightunitmeasurecode, weight, daystomanufacture, productline, class, style, productsubcategoryid, productmodelid, sellstartdate, sellenddate, discontinueddate, modifieddate
    )
  
  (
    
    select productid, name, productnumber, makeflag, finishedgoodsflag, color, safetystocklevel, reorderpoint, standardcost, listprice, size, sizeunitmeasurecode, weightunitmeasurecode, weight, daystomanufacture, productline, class, style, productsubcategoryid, productmodelid, sellstartdate, sellenddate, discontinueddate, modifieddate
    from (
        SELECT 
    productid, 
    "name", 
    productnumber, 
    makeflag, 
    finishedgoodsflag, 
    color, 
    safetystocklevel, 
    reorderpoint, 
    standardcost, 
    listprice, 
    "size", 
    sizeunitmeasurecode, 
    weightunitmeasurecode, 
    "weight", 
    daystomanufacture, 
    productline, 
    "class", 
    "style", 
    productsubcategoryid, 
    productmodelid, 
    sellstartdate, 
    sellenddate, 
    discontinueddate, 
    modifieddate
FROM 
    "Adventureworks"."production"."product"
    ) as model_subq
  );
  
[0m12:17:54.000664 [debug] [Thread-1 (]: SQL status: INSERT 0 504 in 0.0 seconds
[0m12:17:54.006031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:17:54.006744 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */
alter table "Adventureworks"."warehouse"."dim_product" rename to "dim_product__dbt_backup"
[0m12:17:54.008014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:17:54.010446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:17:54.011147 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */
alter table "Adventureworks"."warehouse"."dim_product__dbt_tmp" rename to "dim_product"
[0m12:17:54.012355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:17:54.035658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:17:54.036588 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "Adventureworks".INFORMATION_SCHEMA.columns
      where table_name = 'dim_product'
        
        and table_schema = 'warehouse'
        
      order by ordinal_position

  
[0m12:17:54.042382 [debug] [Thread-1 (]: SQL status: SELECT 24 in 0.0 seconds
[0m12:17:54.050611 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:17:54.050966 [debug] [Thread-3 (]: SQL status: SELECT 31465 in 0.0 seconds
[0m12:17:54.051745 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */

    
  
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".productid is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".name is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".productnumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".makeflag is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".finishedgoodsflag is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".color is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".safetystocklevel is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".reorderpoint is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".standardcost is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".listprice is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".size is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".sizeunitmeasurecode is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".weightunitmeasurecode is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".weight is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".daystomanufacture is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".productline is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".class is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".style is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".productsubcategoryid is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".productmodelid is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".sellstartdate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".sellenddate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".discontinueddate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."dim_product".modifieddate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  

  
[0m12:17:54.054407 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.sales_order_header"
[0m12:17:54.055510 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_header"} */
alter table "Adventureworks"."warehouse"."sales_order_header__dbt_tmp" rename to "sales_order_header"
[0m12:17:54.056139 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m12:17:54.056807 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:17:54.057621 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: COMMIT
[0m12:17:54.060458 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.sales_order_header"
[0m12:17:54.061091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:17:54.061740 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_header"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "Adventureworks".INFORMATION_SCHEMA.columns
      where table_name = 'sales_order_header'
        
        and table_schema = 'warehouse'
        
      order by ordinal_position

  
[0m12:17:54.062371 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: COMMIT
[0m12:17:54.068029 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.0 seconds
[0m12:17:54.070974 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.sales_order_header"
[0m12:17:54.071695 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_header"} */

    
  
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_header".salesorderid is $dbt_comment_literal_block$sales order id$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_header".revisionnumber is $dbt_comment_literal_block$revision number$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_header".orderdate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_header".duedate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_header".shipdate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_header".status is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_header".onlineorderflag is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_header".purchaseordernumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_header".subtotal is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_header".taxamt is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_header".freight is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_header".totaldue is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_header".row_id is $dbt_comment_literal_block$Row Identifier$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_header".modifieddate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  

  
[0m12:17:54.091892 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:17:54.092327 [debug] [Thread-3 (]: SQL status: COMMENT in 0.0 seconds
[0m12:17:54.096542 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m12:17:54.097881 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: COMMIT
[0m12:17:54.098518 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */
drop table if exists "Adventureworks"."warehouse"."dim_product__dbt_backup" cascade
[0m12:17:54.099131 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.sales_order_header"
[0m12:17:54.100167 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: COMMIT
[0m12:17:54.106633 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:17:54.109869 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.sales_order_header"
[0m12:17:54.110508 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_header"} */
drop table if exists "Adventureworks"."warehouse"."sales_order_header__dbt_backup" cascade
[0m12:17:54.111704 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:17:54.112043 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:17:54.113442 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.sales_order_header (execute): 12:17:53.939781 => 12:17:54.113238
[0m12:17:54.114799 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.dim_product (execute): 12:17:53.897026 => 12:17:54.114666
[0m12:17:54.115438 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: Close
[0m12:17:54.116053 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: Close
[0m12:17:54.117012 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748a029e-aacc-48c0-afd2-509990351c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8afdabc70>]}
[0m12:17:54.117788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748a029e-aacc-48c0-afd2-509990351c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8afdabe80>]}
[0m12:17:54.118604 [info ] [Thread-3 (]: 3 of 4 OK created sql table model warehouse.sales_order_header ................. [[32mSELECT 31465[0m in 0.24s]
[0m12:17:54.119574 [info ] [Thread-1 (]: 1 of 4 OK created sql table model warehouse.dim_product ........................ [[32mINSERT 0 504[0m in 0.24s]
[0m12:17:54.120472 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.sales_order_header
[0m12:17:54.121354 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.dim_product
[0m12:17:54.127322 [debug] [Thread-2 (]: SQL status: SELECT 121317 in 0.0 seconds
[0m12:17:54.130018 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m12:17:54.130600 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_detail"} */
alter table "Adventureworks"."warehouse"."sales_order_detail__dbt_tmp" rename to "sales_order_detail"
[0m12:17:54.131687 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:17:54.135577 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m12:17:54.136183 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_detail"} */

    
  
  comment on table "Adventureworks"."warehouse"."sales_order_detail" is $dbt_comment_literal_block$Intermediate sales order detail table$dbt_comment_literal_block$;

  
[0m12:17:54.137258 [debug] [Thread-2 (]: SQL status: COMMENT in 0.0 seconds
[0m12:17:54.139789 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m12:17:54.140355 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_detail"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "Adventureworks".INFORMATION_SCHEMA.columns
      where table_name = 'sales_order_detail'
        
        and table_schema = 'warehouse'
        
      order by ordinal_position

  
[0m12:17:54.145631 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.0 seconds
[0m12:17:54.148010 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m12:17:54.148586 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_detail"} */

    
  
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_detail".salesorderid is $dbt_comment_literal_block$sales order id$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_detail".salesorderdetailid is $dbt_comment_literal_block$foreign key to sales order detail id$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_detail".carriertrackingnumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_detail".orderqty is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_detail".productid is $dbt_comment_literal_block$Foreign key to product table$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_detail".specialofferid is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_detail".unitprice is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_detail".unitpricediscount is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_detail".row_id is $dbt_comment_literal_block$Row Identifier$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."sales_order_detail".modifieddate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  

  
[0m12:17:54.149580 [debug] [Thread-2 (]: SQL status: COMMENT in 0.0 seconds
[0m12:17:54.150593 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: COMMIT
[0m12:17:54.151115 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m12:17:54.151640 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: COMMIT
[0m12:17:54.162311 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:17:54.164556 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m12:17:54.165182 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_detail"} */
drop table if exists "Adventureworks"."warehouse"."sales_order_detail__dbt_backup" cascade
[0m12:17:54.166182 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:17:54.168043 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.sales_order_detail (execute): 12:17:53.936394 => 12:17:54.167890
[0m12:17:54.168615 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: Close
[0m12:17:54.169444 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748a029e-aacc-48c0-afd2-509990351c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b015c280>]}
[0m12:17:54.170403 [info ] [Thread-2 (]: 2 of 4 OK created sql table model warehouse.sales_order_detail ................. [[32mSELECT 121317[0m in 0.29s]
[0m12:17:54.171180 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.sales_order_detail
[0m12:17:54.172325 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.fact_sales
[0m12:17:54.173141 [info ] [Thread-4 (]: 4 of 4 START sql table model warehouse.fact_sales .............................. [RUN]
[0m12:17:54.174277 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_tutorial.fact_sales'
[0m12:17:54.174973 [debug] [Thread-4 (]: Began compiling node model.dbt_tutorial.fact_sales
[0m12:17:54.177907 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_tutorial.fact_sales"
[0m12:17:54.183529 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.fact_sales (compile): 12:17:54.175535 => 12:17:54.183302
[0m12:17:54.184150 [debug] [Thread-4 (]: Began executing node model.dbt_tutorial.fact_sales
[0m12:17:54.187593 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_tutorial.fact_sales"
[0m12:17:54.193094 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:17:54.193747 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: BEGIN
[0m12:17:54.194326 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:17:54.199722 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:17:54.200431 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:17:54.201029 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */

  
    

  create  table "Adventureworks"."warehouse"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    h.salesorderid, 
    d.salesorderdetailid,
    h.revisionnumber, 
    h.orderdate, 
    h.duedate, 
    h.shipdate, 
    h.status, 
    h.onlineorderflag, 
    h.purchaseordernumber, 
    h.subtotal, 
    h.taxamt, 
    h.freight, 
    h.totaldue,
    d.carriertrackingnumber, 
    d.orderqty, 
    d.productid, 
    d.specialofferid, 
    d.unitprice, 
    d.unitpricediscount
FROM "Adventureworks"."warehouse"."sales_order_header" AS h
JOIN "Adventureworks"."warehouse"."sales_order_detail" AS d
ON h.salesorderid = d.salesorderid
  );
  
[0m12:17:54.427789 [debug] [Thread-4 (]: SQL status: SELECT 121317 in 0.0 seconds
[0m12:17:54.430653 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:17:54.431322 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */
alter table "Adventureworks"."warehouse"."fact_sales" rename to "fact_sales__dbt_backup"
[0m12:17:54.432298 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:17:54.434464 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:17:54.434999 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */
alter table "Adventureworks"."warehouse"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m12:17:54.435948 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:17:54.437893 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:17:54.438456 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */

    
  
  comment on table "Adventureworks"."warehouse"."fact_sales" is $dbt_comment_literal_block$Sales fact table$dbt_comment_literal_block$;

  
[0m12:17:54.439403 [debug] [Thread-4 (]: SQL status: COMMENT in 0.0 seconds
[0m12:17:54.442522 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:17:54.443138 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "Adventureworks".INFORMATION_SCHEMA.columns
      where table_name = 'fact_sales'
        
        and table_schema = 'warehouse'
        
      order by ordinal_position

  
[0m12:17:54.448175 [debug] [Thread-4 (]: SQL status: SELECT 19 in 0.0 seconds
[0m12:17:54.451004 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:17:54.451657 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */

    
  
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".salesorderid is $dbt_comment_literal_block$sales order id from salesorderheader table$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".salesorderdetailid is $dbt_comment_literal_block$sales order detail id from the salesorderdetail table$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".revisionnumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".orderdate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".duedate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".shipdate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".status is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".onlineorderflag is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".purchaseordernumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".subtotal is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".taxamt is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".freight is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".totaldue is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".carriertrackingnumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".orderqty is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".productid is $dbt_comment_literal_block$ID of the product in product dimension$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".specialofferid is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".unitprice is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."warehouse"."fact_sales".unitpricediscount is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  

  
[0m12:17:54.452713 [debug] [Thread-4 (]: SQL status: COMMENT in 0.0 seconds
[0m12:17:54.453796 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: COMMIT
[0m12:17:54.454345 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:17:54.454875 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: COMMIT
[0m12:17:54.465342 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:17:54.467720 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m12:17:54.468430 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */
drop table if exists "Adventureworks"."warehouse"."fact_sales__dbt_backup" cascade
[0m12:17:54.475020 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:17:54.476605 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.fact_sales (execute): 12:17:54.184623 => 12:17:54.476459
[0m12:17:54.477161 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: Close
[0m12:17:54.477994 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '748a029e-aacc-48c0-afd2-509990351c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8afdff7c0>]}
[0m12:17:54.478713 [info ] [Thread-4 (]: 4 of 4 OK created sql table model warehouse.fact_sales ......................... [[32mSELECT 121317[0m in 0.30s]
[0m12:17:54.479570 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.fact_sales
[0m12:17:54.481236 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:54.481851 [debug] [MainThread]: On master: BEGIN
[0m12:17:54.482405 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:54.487543 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:17:54.488260 [debug] [MainThread]: On master: COMMIT
[0m12:17:54.488817 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:54.489329 [debug] [MainThread]: On master: COMMIT
[0m12:17:54.490031 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:17:54.490572 [debug] [MainThread]: On master: Close
[0m12:17:54.491458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:54.492034 [debug] [MainThread]: Connection 'model.dbt_tutorial.dim_product' was properly closed.
[0m12:17:54.492559 [debug] [MainThread]: Connection 'model.dbt_tutorial.sales_order_detail' was properly closed.
[0m12:17:54.493138 [debug] [MainThread]: Connection 'model.dbt_tutorial.sales_order_header' was properly closed.
[0m12:17:54.493654 [debug] [MainThread]: Connection 'model.dbt_tutorial.fact_sales' was properly closed.
[0m12:17:54.494173 [info ] [MainThread]: 
[0m12:17:54.494847 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m12:17:54.496037 [debug] [MainThread]: Command end result
[0m12:17:54.506493 [info ] [MainThread]: 
[0m12:17:54.507306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:54.508025 [info ] [MainThread]: 
[0m12:17:54.509031 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:17:54.509948 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:54.509854 after 2.28 seconds
[0m12:17:54.510533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b2311a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b055fd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8b055d810>]}
[0m12:17:54.511080 [debug] [MainThread]: Flushing usage events
[0m12:18:38.442191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3867ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee37101c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee37101cc0>]}


============================== 12:18:38.447913 | e9bc6154-1104-4c61-82e9-0a5c35967eff ==============================
[0m12:18:38.447913 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:18:38.448615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:18:38.697842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9bc6154-1104-4c61-82e9-0a5c35967eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee37101b40>]}
[0m12:18:38.713563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9bc6154-1104-4c61-82e9-0a5c35967eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee371fcac0>]}
[0m12:18:38.719372 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m12:18:38.740158 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m12:18:39.802794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:39.803407 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:39.808229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9bc6154-1104-4c61-82e9-0a5c35967eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee365a40d0>]}
[0m12:18:39.812325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9bc6154-1104-4c61-82e9-0a5c35967eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee36504400>]}
[0m12:18:39.812957 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 311 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m12:18:39.813559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9bc6154-1104-4c61-82e9-0a5c35967eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee36504430>]}
[0m12:18:39.815014 [info ] [MainThread]: 
[0m12:18:39.816037 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:18:39.817566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks_warehouse'
[0m12:18:39.825886 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_warehouse"
[0m12:18:39.826937 [debug] [ThreadPool]: On list_Adventureworks_warehouse: BEGIN
[0m12:18:39.827452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:39.898946 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:18:39.899686 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_warehouse"
[0m12:18:39.900216 [debug] [ThreadPool]: On list_Adventureworks_warehouse: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_warehouse"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
[0m12:18:39.902585 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:18:39.903979 [debug] [ThreadPool]: On list_Adventureworks_warehouse: ROLLBACK
[0m12:18:39.904650 [debug] [ThreadPool]: On list_Adventureworks_warehouse: Close
[0m12:18:39.908846 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:39.909461 [debug] [MainThread]: On master: BEGIN
[0m12:18:39.909983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:39.914903 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:18:39.915470 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:39.916033 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:18:39.920634 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m12:18:39.924433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9bc6154-1104-4c61-82e9-0a5c35967eff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3658d2d0>]}
[0m12:18:39.925044 [debug] [MainThread]: On master: ROLLBACK
[0m12:18:39.925742 [debug] [MainThread]: On master: Close
[0m12:18:39.926515 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:18:39.927149 [info ] [MainThread]: 
[0m12:18:39.932258 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.dim_product
[0m12:18:39.932608 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.sales_order_detail
[0m12:18:39.932925 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.sales_order_header
[0m12:18:39.933760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_warehouse, now model.dbt_tutorial.dim_product)
[0m12:18:39.934729 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.sales_order_detail'
[0m12:18:39.935542 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.sales_order_header'
[0m12:18:39.936213 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.dim_product
[0m12:18:39.936870 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.sales_order_detail
[0m12:18:39.937456 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.sales_order_header
[0m12:18:39.943797 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.dim_product"
[0m12:18:39.945961 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.sales_order_detail"
[0m12:18:39.948313 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.sales_order_header"
[0m12:18:39.951758 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.sales_order_detail (compile): 12:18:39.944255 => 12:18:39.951592
[0m12:18:39.952438 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.dim_product (compile): 12:18:39.937957 => 12:18:39.952285
[0m12:18:39.952727 [debug] [Thread-2 (]: Began executing node model.dbt_tutorial.sales_order_detail
[0m12:18:39.953264 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.sales_order_header (compile): 12:18:39.946543 => 12:18:39.952953
[0m12:18:39.953965 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.dim_product
[0m12:18:39.954884 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.sales_order_detail (execute): 12:18:39.954700 => 12:18:39.954713
[0m12:18:39.955483 [debug] [Thread-3 (]: Began executing node model.dbt_tutorial.sales_order_header
[0m12:18:39.956180 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.dim_product (execute): 12:18:39.955966 => 12:18:39.955972
[0m12:18:39.957191 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.sales_order_detail
[0m12:18:39.957892 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.sales_order_header (execute): 12:18:39.957744 => 12:18:39.957750
[0m12:18:39.958773 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.dim_product
[0m12:18:39.959755 [debug] [Thread-4 (]: Began running node test.dbt_tutorial.not_null_sales_order_detail_row_id.744470fd6b
[0m12:18:39.960032 [debug] [Thread-2 (]: Began running node test.dbt_tutorial.unique_sales_order_detail_row_id.6ece690534
[0m12:18:39.960721 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.sales_order_header
[0m12:18:39.961578 [debug] [Thread-1 (]: Began running node test.dbt_tutorial.not_null_dim_product_productid.51449dfe6f
[0m12:18:39.962216 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_tutorial.not_null_sales_order_detail_row_id.744470fd6b'
[0m12:18:39.962926 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.sales_order_detail, now test.dbt_tutorial.unique_sales_order_detail_row_id.6ece690534)
[0m12:18:39.963535 [debug] [Thread-3 (]: Began running node test.dbt_tutorial.unique_dim_product_productid.cfdf676d85
[0m12:18:39.964378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.dim_product, now test.dbt_tutorial.not_null_dim_product_productid.51449dfe6f)
[0m12:18:39.964941 [debug] [Thread-4 (]: Began compiling node test.dbt_tutorial.not_null_sales_order_detail_row_id.744470fd6b
[0m12:18:39.965502 [debug] [Thread-2 (]: Began compiling node test.dbt_tutorial.unique_sales_order_detail_row_id.6ece690534
[0m12:18:39.966250 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.sales_order_header, now test.dbt_tutorial.unique_dim_product_productid.cfdf676d85)
[0m12:18:39.966842 [debug] [Thread-1 (]: Began compiling node test.dbt_tutorial.not_null_dim_product_productid.51449dfe6f
[0m12:18:39.975988 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_sales_order_detail_row_id.744470fd6b"
[0m12:18:39.980561 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_tutorial.unique_sales_order_detail_row_id.6ece690534"
[0m12:18:39.981220 [debug] [Thread-3 (]: Began compiling node test.dbt_tutorial.unique_dim_product_productid.cfdf676d85
[0m12:18:39.984120 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_dim_product_productid.51449dfe6f"
[0m12:18:39.988503 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_tutorial.unique_dim_product_productid.cfdf676d85"
[0m12:18:39.993860 [debug] [Thread-3 (]: Timing info for test.dbt_tutorial.unique_dim_product_productid.cfdf676d85 (compile): 12:18:39.985472 => 12:18:39.993681
[0m12:18:39.994202 [debug] [Thread-4 (]: Timing info for test.dbt_tutorial.not_null_sales_order_detail_row_id.744470fd6b (compile): 12:18:39.967344 => 12:18:39.994031
[0m12:18:39.995079 [debug] [Thread-3 (]: Began executing node test.dbt_tutorial.unique_dim_product_productid.cfdf676d85
[0m12:18:39.995583 [debug] [Thread-1 (]: Timing info for test.dbt_tutorial.not_null_dim_product_productid.51449dfe6f (compile): 12:18:39.981752 => 12:18:39.995396
[0m12:18:39.995989 [debug] [Thread-2 (]: Timing info for test.dbt_tutorial.unique_sales_order_detail_row_id.6ece690534 (compile): 12:18:39.976504 => 12:18:39.995784
[0m12:18:39.996519 [debug] [Thread-4 (]: Began executing node test.dbt_tutorial.not_null_sales_order_detail_row_id.744470fd6b
[0m12:18:39.997353 [debug] [Thread-3 (]: Timing info for test.dbt_tutorial.unique_dim_product_productid.cfdf676d85 (execute): 12:18:39.997152 => 12:18:39.997167
[0m12:18:39.998036 [debug] [Thread-1 (]: Began executing node test.dbt_tutorial.not_null_dim_product_productid.51449dfe6f
[0m12:18:39.998721 [debug] [Thread-2 (]: Began executing node test.dbt_tutorial.unique_sales_order_detail_row_id.6ece690534
[0m12:18:39.999439 [debug] [Thread-4 (]: Timing info for test.dbt_tutorial.not_null_sales_order_detail_row_id.744470fd6b (execute): 12:18:39.999281 => 12:18:39.999291
[0m12:18:40.000489 [debug] [Thread-3 (]: Finished running node test.dbt_tutorial.unique_dim_product_productid.cfdf676d85
[0m12:18:40.001284 [debug] [Thread-1 (]: Timing info for test.dbt_tutorial.not_null_dim_product_productid.51449dfe6f (execute): 12:18:40.001092 => 12:18:40.001098
[0m12:18:40.002113 [debug] [Thread-2 (]: Timing info for test.dbt_tutorial.unique_sales_order_detail_row_id.6ece690534 (execute): 12:18:40.001858 => 12:18:40.001873
[0m12:18:40.003384 [debug] [Thread-4 (]: Finished running node test.dbt_tutorial.not_null_sales_order_detail_row_id.744470fd6b
[0m12:18:40.004278 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.fact_sales
[0m12:18:40.005414 [debug] [Thread-1 (]: Finished running node test.dbt_tutorial.not_null_dim_product_productid.51449dfe6f
[0m12:18:40.006400 [debug] [Thread-2 (]: Finished running node test.dbt_tutorial.unique_sales_order_detail_row_id.6ece690534
[0m12:18:40.007057 [debug] [Thread-4 (]: Began running node test.dbt_tutorial.greater_than_column_sales_order_header_duedate__orderdate.2d27c1e37f
[0m12:18:40.007872 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_tutorial.unique_dim_product_productid.cfdf676d85, now model.dbt_tutorial.fact_sales)
[0m12:18:40.008518 [debug] [Thread-1 (]: Began running node test.dbt_tutorial.not_null_sales_order_header_row_id.4bffe69438
[0m12:18:40.009150 [debug] [Thread-2 (]: Began running node test.dbt_tutorial.test_due_date_before_order_date
[0m12:18:40.009879 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_tutorial.not_null_sales_order_detail_row_id.744470fd6b, now test.dbt_tutorial.greater_than_column_sales_order_header_duedate__orderdate.2d27c1e37f)
[0m12:18:40.010464 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.fact_sales
[0m12:18:40.011152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_tutorial.not_null_dim_product_productid.51449dfe6f, now test.dbt_tutorial.not_null_sales_order_header_row_id.4bffe69438)
[0m12:18:40.011864 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_tutorial.unique_sales_order_detail_row_id.6ece690534, now test.dbt_tutorial.test_due_date_before_order_date)
[0m12:18:40.012426 [debug] [Thread-4 (]: Began compiling node test.dbt_tutorial.greater_than_column_sales_order_header_duedate__orderdate.2d27c1e37f
[0m12:18:40.015075 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.fact_sales"
[0m12:18:40.015690 [debug] [Thread-1 (]: Began compiling node test.dbt_tutorial.not_null_sales_order_header_row_id.4bffe69438
[0m12:18:40.016263 [debug] [Thread-2 (]: Began compiling node test.dbt_tutorial.test_due_date_before_order_date
[0m12:18:40.020186 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_tutorial.greater_than_column_sales_order_header_duedate__orderdate.2d27c1e37f"
[0m12:18:40.023479 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_sales_order_header_row_id.4bffe69438"
[0m12:18:40.025681 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_tutorial.test_due_date_before_order_date"
[0m12:18:40.026595 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.fact_sales (compile): 12:18:40.012921 => 12:18:40.026426
[0m12:18:40.027996 [debug] [Thread-3 (]: Began executing node model.dbt_tutorial.fact_sales
[0m12:18:40.028823 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.fact_sales (execute): 12:18:40.028634 => 12:18:40.028646
[0m12:18:40.029841 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.fact_sales
[0m12:18:40.030553 [debug] [Thread-3 (]: Began running node test.dbt_tutorial.unique_sales_order_header_row_id.71dca2b08e
[0m12:18:40.030994 [debug] [Thread-4 (]: Timing info for test.dbt_tutorial.greater_than_column_sales_order_header_duedate__orderdate.2d27c1e37f (compile): 12:18:40.016755 => 12:18:40.030835
[0m12:18:40.031330 [debug] [Thread-2 (]: Timing info for test.dbt_tutorial.test_due_date_before_order_date (compile): 12:18:40.024062 => 12:18:40.031183
[0m12:18:40.032195 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.fact_sales, now test.dbt_tutorial.unique_sales_order_header_row_id.71dca2b08e)
[0m12:18:40.032910 [debug] [Thread-1 (]: Timing info for test.dbt_tutorial.not_null_sales_order_header_row_id.4bffe69438 (compile): 12:18:40.021099 => 12:18:40.032749
[0m12:18:40.033212 [debug] [Thread-4 (]: Began executing node test.dbt_tutorial.greater_than_column_sales_order_header_duedate__orderdate.2d27c1e37f
[0m12:18:40.033821 [debug] [Thread-2 (]: Began executing node test.dbt_tutorial.test_due_date_before_order_date
[0m12:18:40.034406 [debug] [Thread-3 (]: Began compiling node test.dbt_tutorial.unique_sales_order_header_row_id.71dca2b08e
[0m12:18:40.034976 [debug] [Thread-1 (]: Began executing node test.dbt_tutorial.not_null_sales_order_header_row_id.4bffe69438
[0m12:18:40.036005 [debug] [Thread-4 (]: Timing info for test.dbt_tutorial.greater_than_column_sales_order_header_duedate__orderdate.2d27c1e37f (execute): 12:18:40.035807 => 12:18:40.035824
[0m12:18:40.036902 [debug] [Thread-2 (]: Timing info for test.dbt_tutorial.test_due_date_before_order_date (execute): 12:18:40.036747 => 12:18:40.036754
[0m12:18:40.040404 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_tutorial.unique_sales_order_header_row_id.71dca2b08e"
[0m12:18:40.041223 [debug] [Thread-1 (]: Timing info for test.dbt_tutorial.not_null_sales_order_header_row_id.4bffe69438 (execute): 12:18:40.041033 => 12:18:40.041044
[0m12:18:40.042184 [debug] [Thread-4 (]: Finished running node test.dbt_tutorial.greater_than_column_sales_order_header_duedate__orderdate.2d27c1e37f
[0m12:18:40.043198 [debug] [Thread-2 (]: Finished running node test.dbt_tutorial.test_due_date_before_order_date
[0m12:18:40.044510 [debug] [Thread-1 (]: Finished running node test.dbt_tutorial.not_null_sales_order_header_row_id.4bffe69438
[0m12:18:40.045180 [debug] [Thread-4 (]: Began running node test.dbt_tutorial.relationships_fact_sales_productid__productid__ref_dim_product_.44c71ed0c4
[0m12:18:40.046797 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_tutorial.greater_than_column_sales_order_header_duedate__orderdate.2d27c1e37f, now test.dbt_tutorial.relationships_fact_sales_productid__productid__ref_dim_product_.44c71ed0c4)
[0m12:18:40.047402 [debug] [Thread-4 (]: Began compiling node test.dbt_tutorial.relationships_fact_sales_productid__productid__ref_dim_product_.44c71ed0c4
[0m12:18:40.053267 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_tutorial.relationships_fact_sales_productid__productid__ref_dim_product_.44c71ed0c4"
[0m12:18:40.053597 [debug] [Thread-3 (]: Timing info for test.dbt_tutorial.unique_sales_order_header_row_id.71dca2b08e (compile): 12:18:40.037491 => 12:18:40.053444
[0m12:18:40.054491 [debug] [Thread-3 (]: Began executing node test.dbt_tutorial.unique_sales_order_header_row_id.71dca2b08e
[0m12:18:40.055150 [debug] [Thread-3 (]: Timing info for test.dbt_tutorial.unique_sales_order_header_row_id.71dca2b08e (execute): 12:18:40.054951 => 12:18:40.054958
[0m12:18:40.056025 [debug] [Thread-3 (]: Finished running node test.dbt_tutorial.unique_sales_order_header_row_id.71dca2b08e
[0m12:18:40.062160 [debug] [Thread-4 (]: Timing info for test.dbt_tutorial.relationships_fact_sales_productid__productid__ref_dim_product_.44c71ed0c4 (compile): 12:18:40.047969 => 12:18:40.061983
[0m12:18:40.062713 [debug] [Thread-4 (]: Began executing node test.dbt_tutorial.relationships_fact_sales_productid__productid__ref_dim_product_.44c71ed0c4
[0m12:18:40.063310 [debug] [Thread-4 (]: Timing info for test.dbt_tutorial.relationships_fact_sales_productid__productid__ref_dim_product_.44c71ed0c4 (execute): 12:18:40.063160 => 12:18:40.063166
[0m12:18:40.064165 [debug] [Thread-4 (]: Finished running node test.dbt_tutorial.relationships_fact_sales_productid__productid__ref_dim_product_.44c71ed0c4
[0m12:18:40.065635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:40.066173 [debug] [MainThread]: Connection 'test.dbt_tutorial.not_null_sales_order_header_row_id.4bffe69438' was properly closed.
[0m12:18:40.066679 [debug] [MainThread]: Connection 'test.dbt_tutorial.test_due_date_before_order_date' was properly closed.
[0m12:18:40.067175 [debug] [MainThread]: Connection 'test.dbt_tutorial.unique_sales_order_header_row_id.71dca2b08e' was properly closed.
[0m12:18:40.067831 [debug] [MainThread]: Connection 'test.dbt_tutorial.relationships_fact_sales_productid__productid__ref_dim_product_.44c71ed0c4' was properly closed.
[0m12:18:40.069806 [debug] [MainThread]: Command end result
[0m12:18:40.099468 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:18:40.100197 [info ] [MainThread]: Building catalog
[0m12:18:40.102192 [debug] [ThreadPool]: Acquiring new postgres connection 'Adventureworks.information_schema'
[0m12:18:40.108043 [debug] [ThreadPool]: Using postgres connection "Adventureworks.information_schema"
[0m12:18:40.108724 [debug] [ThreadPool]: On Adventureworks.information_schema: BEGIN
[0m12:18:40.109319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:40.115461 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:18:40.116528 [debug] [ThreadPool]: Using postgres connection "Adventureworks.information_schema"
[0m12:18:40.117278 [debug] [ThreadPool]: On Adventureworks.information_schema: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "Adventureworks.information_schema"} */

    
    

    select
        'Adventureworks' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('warehouse') or upper(sch.nspname) = upper('production') or upper(sch.nspname) = upper('sales'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:18:40.124703 [debug] [ThreadPool]: SQL status: SELECT 503 in 0.0 seconds
[0m12:18:40.139061 [debug] [ThreadPool]: On Adventureworks.information_schema: ROLLBACK
[0m12:18:40.140294 [debug] [ThreadPool]: On Adventureworks.information_schema: Close
[0m12:18:40.156521 [info ] [MainThread]: Catalog written to /mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/target/catalog.json
[0m12:18:40.157852 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:18:40.157686 after 1.73 seconds
[0m12:18:40.158508 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:18:40.159035 [debug] [MainThread]: Connection 'Adventureworks.information_schema' was properly closed.
[0m12:18:40.159697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee3867ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee371fcac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee36504340>]}
[0m12:18:40.160287 [debug] [MainThread]: Flushing usage events
[0m12:19:25.806006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe904a6da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe903795b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe903795b70>]}


============================== 12:19:25.812000 | 334a4b3e-e050-4a07-aa44-c4eeeaefb358 ==============================
[0m12:19:25.812000 [info ] [MainThread]: Running with dbt=1.5.11
[0m12:19:25.812700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:19:26.067228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '334a4b3e-e050-4a07-aa44-c4eeeaefb358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9037959f0>]}
[0m12:19:26.082923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '334a4b3e-e050-4a07-aa44-c4eeeaefb358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9036a08b0>]}
[0m12:21:08.553589 [error] [MainThread]: Encountered an error:

[0m12:21:08.565221 [error] [MainThread]: Traceback (most recent call last):
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/main.py", line 315, in docs_serve
    results = task.run()
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m12:21:08.566145 [debug] [MainThread]: Command `dbt docs serve` failed at 12:21:08.566044 after 102.77 seconds
[0m12:21:08.566796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe904a6da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9036a08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9036a3b20>]}
[0m12:21:08.567407 [debug] [MainThread]: Flushing usage events
[0m14:33:57.068194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0c4f9a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0b00dc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0b00dc60>]}


============================== 14:33:57.074549 | a21d00d5-ddce-430a-8cc6-e08888ae5938 ==============================
[0m14:33:57.074549 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:33:57.075234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:33:57.344595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a21d00d5-ddce-430a-8cc6-e08888ae5938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0b00dde0>]}
[0m14:33:57.360154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a21d00d5-ddce-430a-8cc6-e08888ae5938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0aa7c8b0>]}
[0m14:33:57.366086 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m14:33:57.388229 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:33:57.433196 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:33:57.434127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a21d00d5-ddce-430a-8cc6-e08888ae5938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0aa7de40>]}
[0m14:33:58.891818 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/dim_product.sql
[0m14:33:58.902340 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/fact_sales.sql
[0m14:33:58.905332 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/sales_order_detail.sql
[0m14:33:58.908318 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/sales_order_header.sql
[0m14:33:59.045215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a21d00d5-ddce-430a-8cc6-e08888ae5938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0a7c6fb0>]}
[0m14:33:59.056608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a21d00d5-ddce-430a-8cc6-e08888ae5938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0a75d930>]}
[0m14:33:59.057414 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 311 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m14:33:59.058041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a21d00d5-ddce-430a-8cc6-e08888ae5938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0bf771f0>]}
[0m14:33:59.059612 [info ] [MainThread]: 
[0m14:33:59.060525 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:33:59.061846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m14:33:59.070009 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m14:33:59.070870 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m14:33:59.071435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:59.128976 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m14:33:59.130414 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m14:33:59.131593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now create_Adventureworks_teste)
[0m14:33:59.132367 [debug] [ThreadPool]: Creating schema "database: "Adventureworks"
schema: "teste"
"
[0m14:33:59.136608 [debug] [ThreadPool]: Using postgres connection "create_Adventureworks_teste"
[0m14:33:59.137144 [debug] [ThreadPool]: On create_Adventureworks_teste: BEGIN
[0m14:33:59.137685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:59.142471 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:33:59.143105 [debug] [ThreadPool]: Using postgres connection "create_Adventureworks_teste"
[0m14:33:59.143648 [debug] [ThreadPool]: On create_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "create_Adventureworks_teste"} */
create schema if not exists "teste"
[0m14:33:59.144549 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m14:33:59.145525 [debug] [ThreadPool]: On create_Adventureworks_teste: COMMIT
[0m14:33:59.146046 [debug] [ThreadPool]: Using postgres connection "create_Adventureworks_teste"
[0m14:33:59.146578 [debug] [ThreadPool]: On create_Adventureworks_teste: COMMIT
[0m14:33:59.149849 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m14:33:59.150376 [debug] [ThreadPool]: On create_Adventureworks_teste: Close
[0m14:33:59.152084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_Adventureworks_teste, now list_Adventureworks_teste)
[0m14:33:59.156349 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m14:33:59.156962 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m14:33:59.157454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:59.162425 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:33:59.163130 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m14:33:59.163750 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m14:33:59.166120 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:33:59.167309 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m14:33:59.168004 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m14:33:59.171648 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:59.172243 [debug] [MainThread]: On master: BEGIN
[0m14:33:59.172815 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:33:59.177651 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:33:59.178245 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:59.178818 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:33:59.183473 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m14:33:59.186852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a21d00d5-ddce-430a-8cc6-e08888ae5938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0a7ffdf0>]}
[0m14:33:59.187521 [debug] [MainThread]: On master: ROLLBACK
[0m14:33:59.188245 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:59.188761 [debug] [MainThread]: On master: BEGIN
[0m14:33:59.189617 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:33:59.190177 [debug] [MainThread]: On master: COMMIT
[0m14:33:59.190694 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:59.191210 [debug] [MainThread]: On master: COMMIT
[0m14:33:59.191873 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:33:59.192421 [debug] [MainThread]: On master: Close
[0m14:33:59.193184 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:33:59.193831 [info ] [MainThread]: 
[0m14:33:59.198552 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.dim_product
[0m14:33:59.198919 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.sales_order_detail
[0m14:33:59.199218 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.sales_order_header
[0m14:33:59.199900 [info ] [Thread-1 (]: 1 of 4 START sql table model teste.dim_product ................................. [RUN]
[0m14:33:59.200594 [info ] [Thread-2 (]: 2 of 4 START sql table model teste.sales_order_detail .......................... [RUN]
[0m14:33:59.201292 [info ] [Thread-3 (]: 3 of 4 START sql table model teste.sales_order_header .......................... [RUN]
[0m14:33:59.202136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.dim_product)
[0m14:33:59.202989 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.sales_order_detail'
[0m14:33:59.203808 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.sales_order_header'
[0m14:33:59.204440 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.dim_product
[0m14:33:59.205013 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.sales_order_detail
[0m14:33:59.205599 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.sales_order_header
[0m14:33:59.212195 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.dim_product"
[0m14:33:59.214437 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.sales_order_detail"
[0m14:33:59.217768 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.sales_order_header"
[0m14:33:59.221668 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.sales_order_header (compile): 14:33:59.215072 => 14:33:59.221477
[0m14:33:59.222013 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.sales_order_detail (compile): 14:33:59.212745 => 14:33:59.221864
[0m14:33:59.222713 [debug] [Thread-3 (]: Began executing node model.dbt_tutorial.sales_order_header
[0m14:33:59.223070 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.dim_product (compile): 14:33:59.206163 => 14:33:59.222915
[0m14:33:59.223612 [debug] [Thread-2 (]: Began executing node model.dbt_tutorial.sales_order_detail
[0m14:33:59.245375 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.dim_product
[0m14:33:59.253433 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_tutorial.sales_order_header"
[0m14:33:59.256727 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_tutorial.sales_order_detail"
[0m14:33:59.269724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m14:33:59.271300 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */
select * from (
        SELECT 
    productid, 
    "name", 
    productnumber, 
    makeflag, 
    finishedgoodsflag, 
    color, 
    safetystocklevel, 
    reorderpoint, 
    standardcost, 
    listprice, 
    "size", 
    sizeunitmeasurecode, 
    weightunitmeasurecode, 
    "weight", 
    daystomanufacture, 
    productline, 
    "class", 
    "style", 
    productsubcategoryid, 
    productmodelid, 
    sellstartdate, 
    sellenddate, 
    discontinueddate, 
    modifieddate
FROM 
    "Adventureworks"."production"."product"
    ) as __dbt_sbq
    where false
    limit 0

[0m14:33:59.272158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:59.273698 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.sales_order_header"
[0m14:33:59.274268 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m14:33:59.274843 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: BEGIN
[0m14:33:59.275796 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: BEGIN
[0m14:33:59.276606 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:33:59.277624 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:33:59.279166 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:33:59.285605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m14:33:59.286713 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */
select * from (
        select
    
      cast(null as int) as productid, 
      cast(null as varchar) as name, 
      cast(null as varchar) as productnumber, 
      cast(null as boolean) as makeflag, 
      cast(null as boolean) as finishedgoodsflag, 
      cast(null as varchar) as color, 
      cast(null as int) as safetystocklevel, 
      cast(null as int) as reorderpoint, 
      cast(null as numeric) as standardcost, 
      cast(null as numeric) as listprice, 
      cast(null as varchar) as size, 
      cast(null as varchar) as sizeunitmeasurecode, 
      cast(null as varchar) as weightunitmeasurecode, 
      cast(null as numeric) as weight, 
      cast(null as int) as daystomanufacture, 
      cast(null as varchar) as productline, 
      cast(null as varchar) as class, 
      cast(null as varchar) as style, 
      cast(null as int) as productsubcategoryid, 
      cast(null as int) as productmodelid, 
      cast(null as timestamp) as sellstartdate, 
      cast(null as timestamp) as sellenddate, 
      cast(null as timestamp) as discontinueddate, 
      cast(null as timestamp) as modifieddate
    ) as __dbt_sbq
    where false
    limit 0

[0m14:33:59.287069 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:33:59.287347 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:33:59.288314 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m14:33:59.288629 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m14:33:59.289111 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.sales_order_header"
[0m14:33:59.289695 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_detail"} */

  
    

  create  table "Adventureworks"."teste"."sales_order_detail__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    salesorderid, 
    salesorderdetailid, 
    carriertrackingnumber, 
    orderqty, 
    productid, 
    specialofferid, 
    unitprice, 
    unitpricediscount, 
    rowguid as row_id, 
    modifieddate
from "Adventureworks"."sales"."salesorderdetail"
  );
  
[0m14:33:59.313122 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.dim_product"
[0m14:33:59.313508 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_header"} */

  
    

  create  table "Adventureworks"."teste"."sales_order_header__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    salesorderid, 
    revisionnumber, 
    orderdate, 
    duedate, 
    shipdate, 
    status, 
    onlineorderflag, 
    purchaseordernumber,  
    subtotal, 
    taxamt, 
    freight, 
    totaldue, 
    rowguid as row_id,
    modifieddate
FROM "Adventureworks"."sales"."salesorderheader"
  );
  
[0m14:33:59.319640 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m14:33:59.320332 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: BEGIN
[0m14:33:59.321415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:33:59.322060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m14:33:59.322760 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */

  
    

  create  table "Adventureworks"."teste"."dim_product__dbt_tmp"
  
  
    
  
  (
    productid int not null primary key,
    name varchar,
    productnumber varchar,
    makeflag boolean,
    finishedgoodsflag boolean,
    color varchar,
    safetystocklevel int,
    reorderpoint int,
    standardcost numeric,
    listprice numeric,
    size varchar,
    sizeunitmeasurecode varchar,
    weightunitmeasurecode varchar,
    weight numeric,
    daystomanufacture int,
    productline varchar,
    class varchar,
    style varchar,
    productsubcategoryid int,
    productmodelid int,
    sellstartdate timestamp,
    sellenddate timestamp,
    discontinueddate timestamp,
    modifieddate timestamp
    
    )
 ;
    insert into "Adventureworks"."teste"."dim_product__dbt_tmp" (
      productid, name, productnumber, makeflag, finishedgoodsflag, color, safetystocklevel, reorderpoint, standardcost, listprice, size, sizeunitmeasurecode, weightunitmeasurecode, weight, daystomanufacture, productline, class, style, productsubcategoryid, productmodelid, sellstartdate, sellenddate, discontinueddate, modifieddate
    )
  
  (
    
    select productid, name, productnumber, makeflag, finishedgoodsflag, color, safetystocklevel, reorderpoint, standardcost, listprice, size, sizeunitmeasurecode, weightunitmeasurecode, weight, daystomanufacture, productline, class, style, productsubcategoryid, productmodelid, sellstartdate, sellenddate, discontinueddate, modifieddate
    from (
        SELECT 
    productid, 
    "name", 
    productnumber, 
    makeflag, 
    finishedgoodsflag, 
    color, 
    safetystocklevel, 
    reorderpoint, 
    standardcost, 
    listprice, 
    "size", 
    sizeunitmeasurecode, 
    weightunitmeasurecode, 
    "weight", 
    daystomanufacture, 
    productline, 
    "class", 
    "style", 
    productsubcategoryid, 
    productmodelid, 
    sellstartdate, 
    sellenddate, 
    discontinueddate, 
    modifieddate
FROM 
    "Adventureworks"."production"."product"
    ) as model_subq
  );
  
[0m14:33:59.328806 [debug] [Thread-1 (]: SQL status: INSERT 0 504 in 0.0 seconds
[0m14:33:59.334975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m14:33:59.335699 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */
alter table "Adventureworks"."teste"."dim_product__dbt_tmp" rename to "dim_product"
[0m14:33:59.336886 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:33:59.358534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m14:33:59.359375 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "Adventureworks".INFORMATION_SCHEMA.columns
      where table_name = 'dim_product'
        
        and table_schema = 'teste'
        
      order by ordinal_position

  
[0m14:33:59.365582 [debug] [Thread-1 (]: SQL status: SELECT 24 in 0.0 seconds
[0m14:33:59.374443 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m14:33:59.375283 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */

    
  
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".productid is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".name is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".productnumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".makeflag is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".finishedgoodsflag is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".color is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".safetystocklevel is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".reorderpoint is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".standardcost is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".listprice is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".size is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".sizeunitmeasurecode is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".weightunitmeasurecode is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".weight is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".daystomanufacture is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".productline is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".class is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".style is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".productsubcategoryid is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".productmodelid is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".sellstartdate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".sellenddate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".discontinueddate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."dim_product".modifieddate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  

  
[0m14:33:59.377461 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m14:33:59.379142 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: COMMIT
[0m14:33:59.379833 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m14:33:59.380472 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: COMMIT
[0m14:33:59.393397 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:33:59.398204 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.dim_product"
[0m14:33:59.399139 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.dim_product"} */
drop table if exists "Adventureworks"."teste"."dim_product__dbt_backup" cascade
[0m14:33:59.399518 [debug] [Thread-3 (]: SQL status: SELECT 31465 in 0.0 seconds
[0m14:33:59.400582 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:33:59.403068 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.sales_order_header"
[0m14:33:59.404614 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.dim_product (execute): 14:33:59.257355 => 14:33:59.404463
[0m14:33:59.405333 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_header"} */
alter table "Adventureworks"."teste"."sales_order_header__dbt_tmp" rename to "sales_order_header"
[0m14:33:59.406055 [debug] [Thread-1 (]: On model.dbt_tutorial.dim_product: Close
[0m14:33:59.407377 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:33:59.408049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a21d00d5-ddce-430a-8cc6-e08888ae5938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a09ff40d0>]}
[0m14:33:59.411512 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.sales_order_header"
[0m14:33:59.412687 [info ] [Thread-1 (]: 1 of 4 OK created sql table model teste.dim_product ............................ [[32mINSERT 0 504[0m in 0.21s]
[0m14:33:59.413483 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_header"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "Adventureworks".INFORMATION_SCHEMA.columns
      where table_name = 'sales_order_header'
        
        and table_schema = 'teste'
        
      order by ordinal_position

  
[0m14:33:59.414260 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.dim_product
[0m14:33:59.420125 [debug] [Thread-3 (]: SQL status: SELECT 14 in 0.0 seconds
[0m14:33:59.422946 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.sales_order_header"
[0m14:33:59.423616 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_header"} */

    
  
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_header".salesorderid is $dbt_comment_literal_block$sales order id$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_header".revisionnumber is $dbt_comment_literal_block$revision number$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_header".orderdate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_header".duedate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_header".shipdate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_header".status is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_header".onlineorderflag is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_header".purchaseordernumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_header".subtotal is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_header".taxamt is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_header".freight is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_header".totaldue is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_header".row_id is $dbt_comment_literal_block$Row Identifier$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_header".modifieddate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  

  
[0m14:33:59.424738 [debug] [Thread-3 (]: SQL status: COMMENT in 0.0 seconds
[0m14:33:59.425803 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: COMMIT
[0m14:33:59.426424 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.sales_order_header"
[0m14:33:59.427070 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: COMMIT
[0m14:33:59.442985 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m14:33:59.445695 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.sales_order_header"
[0m14:33:59.446428 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_header"} */
drop table if exists "Adventureworks"."teste"."sales_order_header__dbt_backup" cascade
[0m14:33:59.447501 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:33:59.449003 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.sales_order_header (execute): 14:33:59.224126 => 14:33:59.448810
[0m14:33:59.449587 [debug] [Thread-3 (]: On model.dbt_tutorial.sales_order_header: Close
[0m14:33:59.450480 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a21d00d5-ddce-430a-8cc6-e08888ae5938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0aafde70>]}
[0m14:33:59.451217 [info ] [Thread-3 (]: 3 of 4 OK created sql table model teste.sales_order_header ..................... [[32mSELECT 31465[0m in 0.25s]
[0m14:33:59.452093 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.sales_order_header
[0m14:33:59.466718 [debug] [Thread-2 (]: SQL status: SELECT 121317 in 0.0 seconds
[0m14:33:59.469656 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m14:33:59.470282 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_detail"} */
alter table "Adventureworks"."teste"."sales_order_detail__dbt_tmp" rename to "sales_order_detail"
[0m14:33:59.471247 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:33:59.474989 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m14:33:59.475554 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_detail"} */

    
  
  comment on table "Adventureworks"."teste"."sales_order_detail" is $dbt_comment_literal_block$Intermediate sales order detail table$dbt_comment_literal_block$;

  
[0m14:33:59.476527 [debug] [Thread-2 (]: SQL status: COMMENT in 0.0 seconds
[0m14:33:59.479710 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m14:33:59.480359 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_detail"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "Adventureworks".INFORMATION_SCHEMA.columns
      where table_name = 'sales_order_detail'
        
        and table_schema = 'teste'
        
      order by ordinal_position

  
[0m14:33:59.485793 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.0 seconds
[0m14:33:59.488221 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m14:33:59.488829 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_detail"} */

    
  
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_detail".salesorderid is $dbt_comment_literal_block$sales order id$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_detail".salesorderdetailid is $dbt_comment_literal_block$foreign key to sales order detail id$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_detail".carriertrackingnumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_detail".orderqty is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_detail".productid is $dbt_comment_literal_block$Foreign key to product table$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_detail".specialofferid is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_detail".unitprice is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_detail".unitpricediscount is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_detail".row_id is $dbt_comment_literal_block$Row Identifier$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."sales_order_detail".modifieddate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  

  
[0m14:33:59.489793 [debug] [Thread-2 (]: SQL status: COMMENT in 0.0 seconds
[0m14:33:59.490834 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: COMMIT
[0m14:33:59.491402 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m14:33:59.491939 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: COMMIT
[0m14:33:59.504177 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m14:33:59.536223 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.sales_order_detail"
[0m14:33:59.536958 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.sales_order_detail"} */
drop table if exists "Adventureworks"."teste"."sales_order_detail__dbt_backup" cascade
[0m14:33:59.537918 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:33:59.539207 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.sales_order_detail (execute): 14:33:59.254097 => 14:33:59.539065
[0m14:33:59.539837 [debug] [Thread-2 (]: On model.dbt_tutorial.sales_order_detail: Close
[0m14:33:59.540627 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a21d00d5-ddce-430a-8cc6-e08888ae5938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a09b2f0d0>]}
[0m14:33:59.541322 [info ] [Thread-2 (]: 2 of 4 OK created sql table model teste.sales_order_detail ..................... [[32mSELECT 121317[0m in 0.34s]
[0m14:33:59.542099 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.sales_order_detail
[0m14:33:59.543167 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.fact_sales
[0m14:33:59.544026 [info ] [Thread-4 (]: 4 of 4 START sql table model teste.fact_sales .................................. [RUN]
[0m14:33:59.544935 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_tutorial.fact_sales'
[0m14:33:59.545474 [debug] [Thread-4 (]: Began compiling node model.dbt_tutorial.fact_sales
[0m14:33:59.548128 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_tutorial.fact_sales"
[0m14:33:59.552713 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.fact_sales (compile): 14:33:59.545910 => 14:33:59.552542
[0m14:33:59.553671 [debug] [Thread-4 (]: Began executing node model.dbt_tutorial.fact_sales
[0m14:33:59.557429 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_tutorial.fact_sales"
[0m14:33:59.562580 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m14:33:59.563209 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: BEGIN
[0m14:33:59.563811 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:33:59.569138 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m14:33:59.569791 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m14:33:59.570365 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */

  
    

  create  table "Adventureworks"."teste"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    h.salesorderid, 
    d.salesorderdetailid,
    h.revisionnumber, 
    h.orderdate, 
    h.duedate, 
    h.shipdate, 
    h.status, 
    h.onlineorderflag, 
    h.purchaseordernumber, 
    h.subtotal, 
    h.taxamt, 
    h.freight, 
    h.totaldue,
    d.carriertrackingnumber, 
    d.orderqty, 
    d.productid, 
    d.specialofferid, 
    d.unitprice, 
    d.unitpricediscount
FROM "Adventureworks"."teste"."sales_order_header" AS h
JOIN "Adventureworks"."teste"."sales_order_detail" AS d
ON h.salesorderid = d.salesorderid
  );
  
[0m14:33:59.786471 [debug] [Thread-4 (]: SQL status: SELECT 121317 in 0.0 seconds
[0m14:33:59.789330 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m14:33:59.789926 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */
alter table "Adventureworks"."teste"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m14:33:59.790823 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:33:59.792617 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m14:33:59.793185 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */

    
  
  comment on table "Adventureworks"."teste"."fact_sales" is $dbt_comment_literal_block$Sales fact table$dbt_comment_literal_block$;

  
[0m14:33:59.794120 [debug] [Thread-4 (]: SQL status: COMMENT in 0.0 seconds
[0m14:33:59.796409 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m14:33:59.796971 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "Adventureworks".INFORMATION_SCHEMA.columns
      where table_name = 'fact_sales'
        
        and table_schema = 'teste'
        
      order by ordinal_position

  
[0m14:33:59.802195 [debug] [Thread-4 (]: SQL status: SELECT 19 in 0.0 seconds
[0m14:33:59.805332 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m14:33:59.806002 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */

    
  
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".salesorderid is $dbt_comment_literal_block$sales order id from salesorderheader table$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".salesorderdetailid is $dbt_comment_literal_block$sales order detail id from the salesorderdetail table$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".revisionnumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".orderdate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".duedate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".shipdate is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".status is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".onlineorderflag is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".purchaseordernumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".subtotal is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".taxamt is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".freight is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".totaldue is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".carriertrackingnumber is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".orderqty is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".productid is $dbt_comment_literal_block$ID of the product in product dimension$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".specialofferid is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".unitprice is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  
    
    
    comment on column "Adventureworks"."teste"."fact_sales".unitpricediscount is $dbt_comment_literal_block$$dbt_comment_literal_block$;
  

  
[0m14:33:59.807020 [debug] [Thread-4 (]: SQL status: COMMENT in 0.0 seconds
[0m14:33:59.808044 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: COMMIT
[0m14:33:59.808569 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m14:33:59.809100 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: COMMIT
[0m14:33:59.828552 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m14:33:59.830939 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.fact_sales"
[0m14:33:59.831525 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.fact_sales"} */
drop table if exists "Adventureworks"."teste"."fact_sales__dbt_backup" cascade
[0m14:33:59.832467 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:33:59.833800 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.fact_sales (execute): 14:33:59.554337 => 14:33:59.833657
[0m14:33:59.834348 [debug] [Thread-4 (]: On model.dbt_tutorial.fact_sales: Close
[0m14:33:59.835140 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a21d00d5-ddce-430a-8cc6-e08888ae5938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0ab593f0>]}
[0m14:33:59.835845 [info ] [Thread-4 (]: 4 of 4 OK created sql table model teste.fact_sales ............................. [[32mSELECT 121317[0m in 0.29s]
[0m14:33:59.836709 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.fact_sales
[0m14:33:59.838429 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:59.839504 [debug] [MainThread]: On master: BEGIN
[0m14:33:59.839990 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:33:59.845000 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:33:59.845665 [debug] [MainThread]: On master: COMMIT
[0m14:33:59.846166 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:59.846661 [debug] [MainThread]: On master: COMMIT
[0m14:33:59.847321 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:33:59.847815 [debug] [MainThread]: On master: Close
[0m14:33:59.849194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:59.849819 [debug] [MainThread]: Connection 'model.dbt_tutorial.dim_product' was properly closed.
[0m14:33:59.850353 [debug] [MainThread]: Connection 'model.dbt_tutorial.sales_order_detail' was properly closed.
[0m14:33:59.850849 [debug] [MainThread]: Connection 'model.dbt_tutorial.sales_order_header' was properly closed.
[0m14:33:59.851386 [debug] [MainThread]: Connection 'model.dbt_tutorial.fact_sales' was properly closed.
[0m14:33:59.851973 [info ] [MainThread]: 
[0m14:33:59.852568 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m14:33:59.853707 [debug] [MainThread]: Command end result
[0m14:33:59.864598 [info ] [MainThread]: 
[0m14:33:59.865598 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:33:59.866343 [info ] [MainThread]: 
[0m14:33:59.866984 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:33:59.867794 [debug] [MainThread]: Command `dbt run` succeeded at 14:33:59.867687 after 2.81 seconds
[0m14:33:59.868393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0c4f9a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0e5fc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a0aa7c8b0>]}
[0m14:33:59.868979 [debug] [MainThread]: Flushing usage events
[0m14:53:08.421261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaafcb1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaae80dc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaae80dc30>]}


============================== 14:53:08.427281 | 1c334d69-685a-433e-83d0-08374788d4db ==============================
[0m14:53:08.427281 [info ] [MainThread]: Running with dbt=1.5.11
[0m14:53:08.427980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'debug': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:53:08.677362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c334d69-685a-433e-83d0-08374788d4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaae80ddb0>]}
[0m14:53:08.693142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c334d69-685a-433e-83d0-08374788d4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaadf088b0>]}
[0m14:53:08.698859 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m14:53:08.719185 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m14:53:09.849140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 6 files added, 0 files changed.
[0m14:53:09.849893 [debug] [MainThread]: Partial parsing: added file: dbt_tutorial://models/teste/int/int_sales_by_product.sql
[0m14:53:09.850473 [debug] [MainThread]: Partial parsing: added file: dbt_tutorial://models/teste/staging/stg_product.sql
[0m14:53:09.851002 [debug] [MainThread]: Partial parsing: added file: dbt_tutorial://models/teste/mart/mart_sales_by_category.sql
[0m14:53:09.851561 [debug] [MainThread]: Partial parsing: added file: dbt_tutorial://models/teste/staging/stg_sales_order_detail.sql
[0m14:53:09.852091 [debug] [MainThread]: Partial parsing: added file: dbt_tutorial://models/teste/adventureworks_source.yml
[0m14:53:09.852614 [debug] [MainThread]: Partial parsing: added file: dbt_tutorial://models/teste/staging/stg_product_category.sql
[0m14:53:09.876248 [debug] [MainThread]: 1699: static parser successfully parsed teste/int/int_sales_by_product.sql
[0m14:53:09.885877 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_product.sql
[0m14:53:09.888759 [debug] [MainThread]: 1699: static parser successfully parsed teste/mart/mart_sales_by_category.sql
[0m14:53:09.891342 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_sales_order_detail.sql
[0m14:53:09.894369 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_product_category.sql
[0m14:53:09.921195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c334d69-685a-433e-83d0-08374788d4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaadbd64a0>]}
[0m14:53:09.932613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c334d69-685a-433e-83d0-08374788d4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaadb6a110>]}
[0m14:53:09.933350 [info ] [MainThread]: Found 9 models, 9 tests, 0 snapshots, 0 analyses, 311 macros, 0 operations, 0 seed files, 6 sources, 0 exposures, 0 metrics, 0 groups
[0m14:53:09.933979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c334d69-685a-433e-83d0-08374788d4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaadb6a080>]}
[0m14:53:09.935344 [info ] [MainThread]: 
[0m14:53:09.936347 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:09.937575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m14:53:09.945775 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m14:53:09.946607 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m14:53:09.947161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:09.998149 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m14:53:09.999617 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m14:53:10.000772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now create_Adventureworks_teste)
[0m14:53:10.001619 [debug] [ThreadPool]: Creating schema "database: "Adventureworks"
schema: "teste"
"
[0m14:53:10.005664 [debug] [ThreadPool]: Using postgres connection "create_Adventureworks_teste"
[0m14:53:10.006237 [debug] [ThreadPool]: On create_Adventureworks_teste: BEGIN
[0m14:53:10.006747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:10.011487 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:53:10.012043 [debug] [ThreadPool]: Using postgres connection "create_Adventureworks_teste"
[0m14:53:10.012559 [debug] [ThreadPool]: On create_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "create_Adventureworks_teste"} */
create schema if not exists "teste"
[0m14:53:10.013392 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m14:53:10.014313 [debug] [ThreadPool]: On create_Adventureworks_teste: COMMIT
[0m14:53:10.014791 [debug] [ThreadPool]: Using postgres connection "create_Adventureworks_teste"
[0m14:53:10.015353 [debug] [ThreadPool]: On create_Adventureworks_teste: COMMIT
[0m14:53:10.018619 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m14:53:10.019211 [debug] [ThreadPool]: On create_Adventureworks_teste: Close
[0m14:53:10.021010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_Adventureworks_teste, now list_Adventureworks_teste)
[0m14:53:10.025301 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m14:53:10.025829 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m14:53:10.026457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:10.031404 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:53:10.032013 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m14:53:10.032522 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m14:53:10.034893 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m14:53:10.036014 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m14:53:10.036745 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m14:53:10.040502 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:10.041062 [debug] [MainThread]: On master: BEGIN
[0m14:53:10.041644 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:10.046524 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:53:10.047208 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:10.047767 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:53:10.052361 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m14:53:10.055718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c334d69-685a-433e-83d0-08374788d4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaadbf57b0>]}
[0m14:53:10.056415 [debug] [MainThread]: On master: ROLLBACK
[0m14:53:10.057189 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:10.057694 [debug] [MainThread]: On master: BEGIN
[0m14:53:10.058539 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:53:10.059022 [debug] [MainThread]: On master: COMMIT
[0m14:53:10.059501 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:10.059957 [debug] [MainThread]: On master: COMMIT
[0m14:53:10.060607 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:53:10.061092 [debug] [MainThread]: On master: Close
[0m14:53:10.061850 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:53:10.062482 [info ] [MainThread]: 
[0m14:53:10.067620 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m14:53:10.067964 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.stg_product_category
[0m14:53:10.068289 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m14:53:10.068908 [info ] [Thread-1 (]: 1 of 5 START sql table model teste.stg_product ................................. [RUN]
[0m14:53:10.069633 [info ] [Thread-2 (]: 2 of 5 START sql table model teste.stg_product_category ........................ [RUN]
[0m14:53:10.070326 [info ] [Thread-3 (]: 3 of 5 START sql table model teste.stg_sales_order_detail ...................... [RUN]
[0m14:53:10.071159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m14:53:10.072004 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_product_category'
[0m14:53:10.072804 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_sales_order_detail'
[0m14:53:10.073379 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m14:53:10.073940 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m14:53:10.074574 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m14:53:10.081179 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m14:53:10.083353 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m14:53:10.085534 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m14:53:10.091324 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 14:53:10.075090 => 14:53:10.091154
[0m14:53:10.091906 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_product
[0m14:53:10.092317 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 14:53:10.081735 => 14:53:10.092151
[0m14:53:10.103737 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 14:53:10.083920 => 14:53:10.103483
[0m14:53:10.119566 [debug] [Thread-2 (]: Began executing node model.dbt_tutorial.stg_product_category
[0m14:53:10.123535 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product"
[0m14:53:10.124221 [debug] [Thread-3 (]: Began executing node model.dbt_tutorial.stg_sales_order_detail
[0m14:53:10.127403 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product_category"
[0m14:53:10.130853 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_tutorial.stg_sales_order_detail"
[0m14:53:10.135946 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m14:53:10.136679 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: BEGIN
[0m14:53:10.136960 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m14:53:10.137552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:10.138360 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: BEGIN
[0m14:53:10.138789 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m14:53:10.139863 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:53:10.140580 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: BEGIN
[0m14:53:10.142022 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:53:10.144689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:10.145404 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m14:53:10.146088 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */

  
    

  create  table "Adventureworks"."teste"."stg_product__dbt_tmp"
  
  
    as
  
  (
    SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."public"."Product"
  );
  
[0m14:53:10.146491 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:10.147601 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:10.147921 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m14:53:10.148475 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.Product" does not exist
LINE 17:     "Adventureworks"."public"."Product"
             ^

[0m14:53:10.148894 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m14:53:10.149512 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */

  
    

  create  table "Adventureworks"."teste"."stg_product_category__dbt_tmp"
  
  
    as
  
  (
    SELECT
    ProductCategoryID,
    Name AS CategoryName
FROM
    "Adventureworks"."public"."ProductCategory"
  );
  
[0m14:53:10.150102 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: ROLLBACK
[0m14:53:10.150705 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */

  
    

  create  table "Adventureworks"."teste"."stg_sales_order_detail__dbt_tmp"
  
  
    as
  
  (
    SELECT
    SalesOrderID,
    ProductID,
    OrderQty,
    LineTotal
FROM
    "Adventureworks"."public"."SalesOrderDetail"
  );
  
[0m14:53:10.151651 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.ProductCategory" does not exist
LINE 16:     "Adventureworks"."public"."ProductCategory"
             ^

[0m14:53:10.152287 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (execute): 14:53:10.092890 => 14:53:10.152122
[0m14:53:10.153053 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.SalesOrderDetail" does not exist
LINE 18:     "Adventureworks"."public"."SalesOrderDetail"
             ^

[0m14:53:10.153356 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: ROLLBACK
[0m14:53:10.153961 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: Close
[0m14:53:10.154548 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: ROLLBACK
[0m14:53:10.155556 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (execute): 14:53:10.124727 => 14:53:10.155360
[0m14:53:10.156967 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (execute): 14:53:10.128386 => 14:53:10.156799
[0m14:53:10.157454 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: Close
[0m14:53:10.158258 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: Close
[0m14:53:10.176356 [debug] [Thread-2 (]: Database Error in model stg_product_category (models/teste/staging/stg_product_category.sql)
  relation "public.ProductCategory" does not exist
  LINE 16:     "Adventureworks"."public"."ProductCategory"
               ^
  compiled Code at target/run/dbt_tutorial/models/teste/staging/stg_product_category.sql
[0m14:53:10.176834 [debug] [Thread-1 (]: Database Error in model stg_product (models/teste/staging/stg_product.sql)
  relation "public.Product" does not exist
  LINE 17:     "Adventureworks"."public"."Product"
               ^
  compiled Code at target/run/dbt_tutorial/models/teste/staging/stg_product.sql
[0m14:53:10.177282 [debug] [Thread-3 (]: Database Error in model stg_sales_order_detail (models/teste/staging/stg_sales_order_detail.sql)
  relation "public.SalesOrderDetail" does not exist
  LINE 18:     "Adventureworks"."public"."SalesOrderDetail"
               ^
  compiled Code at target/run/dbt_tutorial/models/teste/staging/stg_sales_order_detail.sql
[0m14:53:10.177850 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c334d69-685a-433e-83d0-08374788d4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaae897340>]}
[0m14:53:10.178447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c334d69-685a-433e-83d0-08374788d4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaad311c90>]}
[0m14:53:10.179016 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c334d69-685a-433e-83d0-08374788d4db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaae8974f0>]}
[0m14:53:10.179786 [error] [Thread-2 (]: 2 of 5 ERROR creating sql table model teste.stg_product_category ............... [[31mERROR[0m in 0.11s]
[0m14:53:10.180499 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model teste.stg_product ........................ [[31mERROR[0m in 0.11s]
[0m14:53:10.181214 [error] [Thread-3 (]: 3 of 5 ERROR creating sql table model teste.stg_sales_order_detail ............. [[31mERROR[0m in 0.11s]
[0m14:53:10.181752 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m14:53:10.182355 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m14:53:10.182948 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m14:53:10.184763 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m14:53:10.185373 [info ] [Thread-4 (]: 4 of 5 SKIP relation teste.int_sales_by_product ................................ [[33mSKIP[0m]
[0m14:53:10.186023 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m14:53:10.186992 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m14:53:10.187624 [info ] [Thread-1 (]: 5 of 5 SKIP relation teste.mart_sales_by_category .............................. [[33mSKIP[0m]
[0m14:53:10.188329 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m14:53:10.190025 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:10.190581 [debug] [MainThread]: On master: BEGIN
[0m14:53:10.191173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:10.197030 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:53:10.197915 [debug] [MainThread]: On master: COMMIT
[0m14:53:10.198466 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:10.198945 [debug] [MainThread]: On master: COMMIT
[0m14:53:10.199748 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:53:10.200296 [debug] [MainThread]: On master: Close
[0m14:53:10.201197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:10.201700 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product' was properly closed.
[0m14:53:10.202237 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product_category' was properly closed.
[0m14:53:10.202899 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_sales_order_detail' was properly closed.
[0m14:53:10.203566 [info ] [MainThread]: 
[0m14:53:10.204183 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:53:10.204999 [debug] [MainThread]: Command end result
[0m14:53:10.215730 [info ] [MainThread]: 
[0m14:53:10.216787 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:53:10.217439 [info ] [MainThread]: 
[0m14:53:10.218057 [error] [MainThread]: [33mDatabase Error in model stg_product_category (models/teste/staging/stg_product_category.sql)[0m
[0m14:53:10.218654 [error] [MainThread]:   relation "public.ProductCategory" does not exist
[0m14:53:10.219508 [error] [MainThread]:   LINE 16:     "Adventureworks"."public"."ProductCategory"
[0m14:53:10.220799 [error] [MainThread]:                ^
[0m14:53:10.221740 [error] [MainThread]:   compiled Code at target/run/dbt_tutorial/models/teste/staging/stg_product_category.sql
[0m14:53:10.222447 [info ] [MainThread]: 
[0m14:53:10.223200 [error] [MainThread]: [33mDatabase Error in model stg_product (models/teste/staging/stg_product.sql)[0m
[0m14:53:10.223895 [error] [MainThread]:   relation "public.Product" does not exist
[0m14:53:10.224533 [error] [MainThread]:   LINE 17:     "Adventureworks"."public"."Product"
[0m14:53:10.225204 [error] [MainThread]:                ^
[0m14:53:10.225776 [error] [MainThread]:   compiled Code at target/run/dbt_tutorial/models/teste/staging/stg_product.sql
[0m14:53:10.226442 [info ] [MainThread]: 
[0m14:53:10.227055 [error] [MainThread]: [33mDatabase Error in model stg_sales_order_detail (models/teste/staging/stg_sales_order_detail.sql)[0m
[0m14:53:10.227616 [error] [MainThread]:   relation "public.SalesOrderDetail" does not exist
[0m14:53:10.228247 [error] [MainThread]:   LINE 18:     "Adventureworks"."public"."SalesOrderDetail"
[0m14:53:10.228849 [error] [MainThread]:                ^
[0m14:53:10.229479 [error] [MainThread]:   compiled Code at target/run/dbt_tutorial/models/teste/staging/stg_sales_order_detail.sql
[0m14:53:10.230079 [info ] [MainThread]: 
[0m14:53:10.230674 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
[0m14:53:10.231420 [debug] [MainThread]: Command `dbt run` failed at 14:53:10.231334 after 1.82 seconds
[0m14:53:10.232012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaafcb1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaad329d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaad32bac0>]}
[0m14:53:10.232540 [debug] [MainThread]: Flushing usage events
[0m15:31:49.801898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bac559a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bab005cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bab005c90>]}


============================== 15:31:49.807926 | 8fefcb41-c968-4b57-b215-b17f042e7902 ==============================
[0m15:31:49.807926 [info ] [MainThread]: Running with dbt=1.5.11
[0m15:31:49.808672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'debug': 'False', 'version_check': 'True', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:31:50.080429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fefcb41-c968-4b57-b215-b17f042e7902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bab005e10>]}
[0m15:31:50.096486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fefcb41-c968-4b57-b215-b17f042e7902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1baa5008b0>]}
[0m15:31:50.102359 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m15:31:50.123941 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m15:31:51.277910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m15:31:51.278946 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/adventureworks_source.yml
[0m15:31:51.279568 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product.sql
[0m15:31:51.280123 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product_category.sql
[0m15:31:51.280672 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_sales_order_detail.sql
[0m15:31:51.305269 [debug] [MainThread]: 1699: static parser successfully parsed teste/mart/mart_sales_by_category.sql
[0m15:31:51.316109 [debug] [MainThread]: 1699: static parser successfully parsed teste/int/int_sales_by_product.sql
[0m15:31:51.318860 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_sales_order_detail.sql
[0m15:31:51.321431 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_product.sql
[0m15:31:51.324046 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_product_category.sql
[0m15:31:51.340031 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_tutorial.stg_sales_order_detail' (models/teste/staging/stg_sales_order_detail.sql) depends on a source named 'adventureworks.salesorderdetail' which was not found
[0m15:31:51.340993 [debug] [MainThread]: Command `dbt run` failed at 15:31:51.340907 after 1.55 seconds
[0m15:31:51.341569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bac559a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba9d0d390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ba9d0d360>]}
[0m15:31:51.342144 [debug] [MainThread]: Flushing usage events
[0m15:33:50.547003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021b5a1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021a109c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021a109c30>]}


============================== 15:33:50.552986 | 14f8c2bd-40ab-48d7-9739-44610000aef1 ==============================
[0m15:33:50.552986 [info ] [MainThread]: Running with dbt=1.5.11
[0m15:33:50.553682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:33:50.829118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14f8c2bd-40ab-48d7-9739-44610000aef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021a109db0>]}
[0m15:33:50.845016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14f8c2bd-40ab-48d7-9739-44610000aef1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02195048b0>]}
[0m15:33:50.851053 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m15:33:50.871809 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m15:33:52.008945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m15:33:52.010011 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/adventureworks_source.yml
[0m15:33:52.010580 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_sales_order_detail.sql
[0m15:33:52.011105 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product_category.sql
[0m15:33:52.011673 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product.sql
[0m15:33:52.035865 [debug] [MainThread]: 1699: static parser successfully parsed teste/mart/mart_sales_by_category.sql
[0m15:33:52.046421 [debug] [MainThread]: 1699: static parser successfully parsed teste/int/int_sales_by_product.sql
[0m15:33:52.048950 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_sales_order_detail.sql
[0m15:33:52.051588 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_product.sql
[0m15:33:52.054055 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_product_category.sql
[0m15:33:52.069943 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_tutorial.stg_sales_order_detail' (models/teste/staging/stg_sales_order_detail.sql) depends on a source named 'adventureworks.salesorderdetail' which was not found
[0m15:33:52.070715 [debug] [MainThread]: Command `dbt run` failed at 15:33:52.070631 after 1.54 seconds
[0m15:33:52.071345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f021b5a1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0218d11330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0218d11300>]}
[0m15:33:52.071920 [debug] [MainThread]: Flushing usage events
[0m15:43:40.125911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441e3dda20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441cf09c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441cf09c00>]}


============================== 15:43:40.131834 | 08462a86-641d-451d-b280-f05d08db0a55 ==============================
[0m15:43:40.131834 [info ] [MainThread]: Running with dbt=1.5.11
[0m15:43:40.132583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:43:40.400427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08462a86-641d-451d-b280-f05d08db0a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441cf09d80>]}
[0m15:43:40.416107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08462a86-641d-451d-b280-f05d08db0a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441c3048b0>]}
[0m15:43:40.422196 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m15:43:40.443283 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m15:43:41.590920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m15:43:41.591996 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/adventureworks_source.yml
[0m15:43:41.592590 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product.sql
[0m15:43:41.593101 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_sales_order_detail.sql
[0m15:43:41.593646 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product_category.sql
[0m15:43:41.617557 [debug] [MainThread]: 1699: static parser successfully parsed teste/mart/mart_sales_by_category.sql
[0m15:43:41.628197 [debug] [MainThread]: 1699: static parser successfully parsed teste/int/int_sales_by_product.sql
[0m15:43:41.630766 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_sales_order_detail.sql
[0m15:43:41.633289 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_product.sql
[0m15:43:41.635762 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_product_category.sql
[0m15:43:41.650509 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "sales_salesorderdetail".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("sales", "salesorderdetail").
  
  To fix this, change the name of one of these resources:
  - source.dbt_tutorial.sales.salesorderdetail (models/teste/adventureworks_source.yml)
  - source.dbt_tutorial.sales.salesorderdetail (models/warehouse/source_adventureworks.yml)
[0m15:43:41.651327 [debug] [MainThread]: Command `dbt run` failed at 15:43:41.651244 after 1.54 seconds
[0m15:43:41.651982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441e3dda20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441bb02770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f441bb11360>]}
[0m15:43:41.652540 [debug] [MainThread]: Flushing usage events
[0m15:46:40.639916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff588885a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5874fdd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5874fdcf0>]}


============================== 15:46:40.646420 | e0435f97-47b9-41fd-a987-033ccc32fa17 ==============================
[0m15:46:40.646420 [info ] [MainThread]: Running with dbt=1.5.11
[0m15:46:40.647219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:46:40.924933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0435f97-47b9-41fd-a987-033ccc32fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5874fde70>]}
[0m15:46:40.940622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0435f97-47b9-41fd-a987-033ccc32fa17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5873f88b0>]}
[0m15:46:40.946848 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m15:46:40.968279 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m15:46:42.023629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m15:46:42.024626 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/adventureworks_source.yml
[0m15:46:42.025426 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/warehouse/source_adventureworks.yml
[0m15:46:42.025913 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product.sql
[0m15:46:42.026416 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product_category.sql
[0m15:46:42.026895 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_sales_order_detail.sql
[0m15:46:42.051323 [debug] [MainThread]: 1699: static parser successfully parsed teste/mart/mart_sales_by_category.sql
[0m15:46:42.061342 [debug] [MainThread]: 1699: static parser successfully parsed teste/int/int_sales_by_product.sql
[0m15:46:42.063850 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_sales_order_detail.sql
[0m15:46:42.067080 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_product.sql
[0m15:46:42.069529 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_product_category.sql
[0m15:46:42.072204 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/fact_sales.sql
[0m15:46:42.075077 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/sales_order_header.sql
[0m15:46:42.078085 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/sales_order_detail.sql
[0m15:46:42.111374 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "production_product".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("production", "product").
  
  To fix this, change the name of one of these resources:
  - source.dbt_tutorial.production.product (models/teste/adventureworks_source.yml)
  - source.dbt_tutorial.production.product (models/warehouse/source_adventureworks.yml)
[0m15:46:42.112415 [debug] [MainThread]: Command `dbt run` failed at 15:46:42.112305 after 1.49 seconds
[0m15:46:42.113060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff588885a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58632ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff58632fee0>]}
[0m15:46:42.113702 [debug] [MainThread]: Flushing usage events
[0m15:46:59.526591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ddf5ada20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dde2fdc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dde2fdc60>]}


============================== 15:46:59.533447 | c4adb7d6-cca4-4b55-b152-ecb10cc74a00 ==============================
[0m15:46:59.533447 [info ] [MainThread]: Running with dbt=1.5.11
[0m15:46:59.534255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'version_check': 'True', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:46:59.807741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4adb7d6-cca4-4b55-b152-ecb10cc74a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dde2fdde0>]}
[0m15:46:59.823632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4adb7d6-cca4-4b55-b152-ecb10cc74a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dde1fc8b0>]}
[0m15:46:59.829675 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m15:46:59.851535 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m15:47:01.015049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m15:47:01.016231 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/warehouse/source_adventureworks.yml
[0m15:47:01.017074 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/adventureworks_source.yml
[0m15:47:01.017607 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product.sql
[0m15:47:01.018122 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product_category.sql
[0m15:47:01.018644 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_sales_order_detail.sql
[0m15:47:01.042939 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/dim_product.sql
[0m15:47:01.053005 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/fact_sales.sql
[0m15:47:01.055913 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/sales_order_header.sql
[0m15:47:01.059428 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/sales_order_detail.sql
[0m15:47:01.062232 [debug] [MainThread]: 1699: static parser successfully parsed teste/mart/mart_sales_by_category.sql
[0m15:47:01.065102 [debug] [MainThread]: 1699: static parser successfully parsed teste/int/int_sales_by_product.sql
[0m15:47:01.067728 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_sales_order_detail.sql
[0m15:47:01.070352 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_product.sql
[0m15:47:01.072787 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_product_category.sql
[0m15:47:01.176401 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_tutorial.sales_order_header' (models/warehouse/sales_order_header.sql) depends on a source named 'sales.salesorderheader' which was not found
[0m15:47:01.177331 [debug] [MainThread]: Command `dbt run` failed at 15:47:01.177247 after 1.66 seconds
[0m15:47:01.177987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ddf5ada20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ddd1e9ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ddd1ebf40>]}
[0m15:47:01.178599 [debug] [MainThread]: Flushing usage events
[0m16:32:00.855741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0adc45a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ac8fdc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ac8fdc60>]}


============================== 16:32:00.861497 | 70aa3a6a-dea9-42bc-875f-58ef56cb91ae ==============================
[0m16:32:00.861497 [info ] [MainThread]: Running with dbt=1.5.11
[0m16:32:00.862186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:32:01.114761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70aa3a6a-dea9-42bc-875f-58ef56cb91ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ac8fdde0>]}
[0m16:32:01.130421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70aa3a6a-dea9-42bc-875f-58ef56cb91ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ac7f88b0>]}
[0m16:32:01.136366 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m16:32:01.156694 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m16:32:02.293579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m16:32:02.294635 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/adventureworks_source.yml
[0m16:32:02.295524 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/warehouse/source_adventureworks.yml
[0m16:32:02.296051 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product.sql
[0m16:32:02.296800 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_sales_order_detail.sql
[0m16:32:02.297321 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product_category.sql
[0m16:32:02.321083 [debug] [MainThread]: 1699: static parser successfully parsed teste/mart/mart_sales_by_category.sql
[0m16:32:02.331120 [debug] [MainThread]: 1699: static parser successfully parsed teste/int/int_sales_by_product.sql
[0m16:32:02.333734 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_sales_order_detail.sql
[0m16:32:02.336822 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_product.sql
[0m16:32:02.339329 [debug] [MainThread]: 1699: static parser successfully parsed teste/staging/stg_product_category.sql
[0m16:32:02.341846 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/dim_product.sql
[0m16:32:02.344624 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/fact_sales.sql
[0m16:32:02.347627 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/sales_order_header.sql
[0m16:32:02.350495 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/sales_order_detail.sql
[0m16:32:02.457069 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_tutorial.sales_order_header' (models/warehouse/sales_order_header.sql) depends on a source named 'sales.salesorderheader' which was not found
[0m16:32:02.457899 [debug] [MainThread]: Command `dbt run` failed at 16:32:02.457815 after 1.61 seconds
[0m16:32:02.458454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0adc45a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0abbe7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0abbe49a0>]}
[0m16:32:02.459002 [debug] [MainThread]: Flushing usage events
[0m16:37:07.151814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff419101a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff417d95cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff417d95cc0>]}


============================== 16:37:07.157486 | b376e50f-34e3-408c-89a6-cb4a37fa0a69 ==============================
[0m16:37:07.157486 [info ] [MainThread]: Running with dbt=1.5.11
[0m16:37:07.158182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:37:07.418097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b376e50f-34e3-408c-89a6-cb4a37fa0a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff417d95e40>]}
[0m16:37:07.433775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b376e50f-34e3-408c-89a6-cb4a37fa0a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff417c908b0>]}
[0m16:37:07.439626 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m16:37:07.460113 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m16:37:07.500389 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:37:07.501320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b376e50f-34e3-408c-89a6-cb4a37fa0a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff417c1af50>]}
[0m16:37:08.961442 [debug] [MainThread]: 1699: static parser successfully parsed int/int_sales_by_product.sql
[0m16:37:08.972581 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_sales_by_category.sql
[0m16:37:08.975721 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_product.sql
[0m16:37:08.978560 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_product_category.sql
[0m16:37:08.981364 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_order_detail.sql
[0m16:37:09.029319 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_tutorial.test_due_date_before_order_date' (tests/test_due_date_before_order_date.sql) depends on a node named 'sales_order_header' in package '' which was not found
[0m16:37:09.053198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b376e50f-34e3-408c-89a6-cb4a37fa0a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff417694730>]}
[0m16:37:09.063544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b376e50f-34e3-408c-89a6-cb4a37fa0a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff417c1ace0>]}
[0m16:37:09.064269 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 311 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m16:37:09.064925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b376e50f-34e3-408c-89a6-cb4a37fa0a69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41736a2f0>]}
[0m16:37:09.065654 [warn ] [MainThread]: The selection criterion 'teste' does not match any nodes
[0m16:37:09.066643 [info ] [MainThread]: 
[0m16:37:09.067257 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:37:09.068218 [debug] [MainThread]: Command end result
[0m16:37:09.077316 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:09.077102 after 1.94 seconds
[0m16:37:09.078216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff419101a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41736a2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4187b5e40>]}
[0m16:37:09.078991 [debug] [MainThread]: Flushing usage events
[0m16:38:18.017199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79048e9a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790340dc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790340dc30>]}


============================== 16:38:18.023473 | ac79fd52-95b9-4d1f-a279-65a768b33dca ==============================
[0m16:38:18.023473 [info ] [MainThread]: Running with dbt=1.5.11
[0m16:38:18.024244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'fail_fast': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:38:18.287475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac79fd52-95b9-4d1f-a279-65a768b33dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f790340ddb0>]}
[0m16:38:18.303198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac79fd52-95b9-4d1f-a279-65a768b33dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7902b088b0>]}
[0m16:38:18.309001 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m16:38:18.329072 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m16:38:18.367918 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:38:18.368949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac79fd52-95b9-4d1f-a279-65a768b33dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7903fd3760>]}
[0m16:38:19.827164 [debug] [MainThread]: 1699: static parser successfully parsed int/int_sales_by_product.sql
[0m16:38:19.837001 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_sales_by_category.sql
[0m16:38:19.839505 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_product.sql
[0m16:38:19.842036 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_product_category.sql
[0m16:38:19.844560 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_order_detail.sql
[0m16:38:19.891958 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_tutorial.test_due_date_before_order_date' (tests/test_due_date_before_order_date.sql) depends on a node named 'sales_order_header' in package '' which was not found
[0m16:38:19.914749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac79fd52-95b9-4d1f-a279-65a768b33dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79027bf430>]}
[0m16:38:19.925018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac79fd52-95b9-4d1f-a279-65a768b33dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79027e7310>]}
[0m16:38:19.925749 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 311 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m16:38:19.926537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac79fd52-95b9-4d1f-a279-65a768b33dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7902bb51e0>]}
[0m16:38:19.927344 [warn ] [MainThread]: The selection criterion 'teste' does not match any nodes
[0m16:38:19.928329 [info ] [MainThread]: 
[0m16:38:19.928943 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:38:19.929700 [debug] [MainThread]: Command end result
[0m16:38:19.939211 [debug] [MainThread]: Command `dbt run` succeeded at 16:38:19.939006 after 1.94 seconds
[0m16:38:19.940193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79048e9a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7902bb51e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7902b088b0>]}
[0m16:38:19.941099 [debug] [MainThread]: Flushing usage events
[0m16:39:02.646662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02cf301a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02cde01c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02cde01c00>]}


============================== 16:39:02.652388 | a3e07e40-2413-4d3d-a984-1773f76df36f ==============================
[0m16:39:02.652388 [info ] [MainThread]: Running with dbt=1.5.11
[0m16:39:02.653097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:39:02.908670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3e07e40-2413-4d3d-a984-1773f76df36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02cde01d80>]}
[0m16:39:02.924402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3e07e40-2413-4d3d-a984-1773f76df36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02cdefc8b0>]}
[0m16:39:02.930243 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m16:39:02.950586 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m16:39:03.993517 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m16:39:03.994174 [debug] [MainThread]: Partial parsing: deleted file: dbt_tutorial://tests/generic/test_greater_than_column.sql
[0m16:39:03.994687 [debug] [MainThread]: Partial parsing: deleted file: dbt_tutorial://tests/test_due_date_before_order_date.sql
[0m16:39:04.004847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3e07e40-2413-4d3d-a984-1773f76df36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02cd59cdc0>]}
[0m16:39:04.014413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3e07e40-2413-4d3d-a984-1773f76df36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02cd89cc10>]}
[0m16:39:04.015154 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m16:39:04.015860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3e07e40-2413-4d3d-a984-1773f76df36f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02cd89d210>]}
[0m16:39:04.016635 [warn ] [MainThread]: The selection criterion 'teste' does not match any nodes
[0m16:39:04.017607 [info ] [MainThread]: 
[0m16:39:04.018311 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:39:04.019042 [debug] [MainThread]: Command end result
[0m16:39:04.028186 [debug] [MainThread]: Command `dbt run` succeeded at 16:39:04.027958 after 1.39 seconds
[0m16:39:04.028974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02cf301a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02cd89feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02cd89fc70>]}
[0m16:39:04.029772 [debug] [MainThread]: Flushing usage events
[0m16:42:02.589282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893c40da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893af01cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893af01c90>]}


============================== 16:42:02.595270 | 7ce1db7a-7f34-4051-9cc9-bb2aa24ba293 ==============================
[0m16:42:02.595270 [info ] [MainThread]: Running with dbt=1.5.11
[0m16:42:02.595999 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:42:02.847442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ce1db7a-7f34-4051-9cc9-bb2aa24ba293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893af01e10>]}
[0m16:42:02.863079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ce1db7a-7f34-4051-9cc9-bb2aa24ba293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893affc8b0>]}
[0m16:42:02.868869 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m16:42:02.889445 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m16:42:03.959537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:42:03.960286 [debug] [MainThread]: Partial parsing: added file: dbt_tutorial://tests/test_due_date_before_order_date.sql
[0m16:42:03.985659 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_tutorial.test_due_date_before_order_date' (tests/test_due_date_before_order_date.sql) depends on a node named 'sales_order_header' in package '' which was not found
[0m16:42:03.995821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ce1db7a-7f34-4051-9cc9-bb2aa24ba293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893a391de0>]}
[0m16:42:04.006363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ce1db7a-7f34-4051-9cc9-bb2aa24ba293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893c071810>]}
[0m16:42:04.007064 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m16:42:04.007665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ce1db7a-7f34-4051-9cc9-bb2aa24ba293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893bb0e800>]}
[0m16:42:04.009029 [info ] [MainThread]: 
[0m16:42:04.009935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:42:04.012316 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m16:42:04.020919 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m16:42:04.021661 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m16:42:04.022209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:04.075291 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m16:42:04.076722 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m16:42:04.078285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now list_Adventureworks_teste)
[0m16:42:04.082727 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m16:42:04.083271 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m16:42:04.083796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:04.089081 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:42:04.089818 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m16:42:04.090384 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m16:42:04.092752 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:42:04.093863 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m16:42:04.094566 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m16:42:04.098238 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:04.098788 [debug] [MainThread]: On master: BEGIN
[0m16:42:04.099282 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:42:04.104031 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:04.104743 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:04.105369 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:42:04.109960 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m16:42:04.113377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ce1db7a-7f34-4051-9cc9-bb2aa24ba293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893a3b0b50>]}
[0m16:42:04.113988 [debug] [MainThread]: On master: ROLLBACK
[0m16:42:04.114673 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:04.115152 [debug] [MainThread]: On master: BEGIN
[0m16:42:04.116012 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:04.116600 [debug] [MainThread]: On master: COMMIT
[0m16:42:04.117089 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:04.117570 [debug] [MainThread]: On master: COMMIT
[0m16:42:04.118233 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:42:04.118720 [debug] [MainThread]: On master: Close
[0m16:42:04.119445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:42:04.120008 [info ] [MainThread]: 
[0m16:42:04.124708 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m16:42:04.125042 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.stg_product_category
[0m16:42:04.125356 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m16:42:04.125968 [info ] [Thread-1 (]: 1 of 5 START sql table model teste.stg_product ................................. [RUN]
[0m16:42:04.126788 [info ] [Thread-2 (]: 2 of 5 START sql table model teste.stg_product_category ........................ [RUN]
[0m16:42:04.127517 [info ] [Thread-3 (]: 3 of 5 START sql table model teste.stg_sales_order_detail ...................... [RUN]
[0m16:42:04.128380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m16:42:04.129241 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_product_category'
[0m16:42:04.130037 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_sales_order_detail'
[0m16:42:04.130648 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m16:42:04.131241 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m16:42:04.132247 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m16:42:04.139292 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m16:42:04.141435 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m16:42:04.143468 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m16:42:04.147058 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 16:42:04.132804 => 16:42:04.146887
[0m16:42:04.147398 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 16:42:04.139843 => 16:42:04.147243
[0m16:42:04.148137 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_product
[0m16:42:04.148617 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 16:42:04.141976 => 16:42:04.148456
[0m16:42:04.149153 [debug] [Thread-2 (]: Began executing node model.dbt_tutorial.stg_product_category
[0m16:42:04.170836 [debug] [Thread-3 (]: Began executing node model.dbt_tutorial.stg_sales_order_detail
[0m16:42:04.179572 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product"
[0m16:42:04.182929 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product_category"
[0m16:42:04.186301 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_tutorial.stg_sales_order_detail"
[0m16:42:04.190285 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:42:04.190608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:42:04.191223 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: BEGIN
[0m16:42:04.191826 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:42:04.192101 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: BEGIN
[0m16:42:04.192750 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:42:04.193368 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: BEGIN
[0m16:42:04.193954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:04.195120 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:42:04.199858 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:42:04.200766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:42:04.201094 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:42:04.201572 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:42:04.202186 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:42:04.202775 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:42:04.203385 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */

  
    

  create  table "Adventureworks"."teste"."stg_sales_order_detail__dbt_tmp"
  
  
    as
  
  (
    SELECT
    SalesOrderID,
    ProductID,
    OrderQty,
    LineTotal
FROM
    "Adventureworks"."sales"."salesorderdetail"
  );
  
[0m16:42:04.203981 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */

  
    

  create  table "Adventureworks"."teste"."stg_product__dbt_tmp"
  
  
    as
  
  (
    SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
  );
  
[0m16:42:04.204577 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */

  
    

  create  table "Adventureworks"."teste"."stg_product_category__dbt_tmp"
  
  
    as
  
  (
    SELECT
    ProductCategoryID,
    Name AS CategoryName
FROM
    "Adventureworks"."production"."productcategory"
  );
  
[0m16:42:04.206819 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "linetotal" does not exist
LINE 16:     LineTotal
             ^

[0m16:42:04.207420 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: ROLLBACK
[0m16:42:04.208347 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (execute): 16:42:04.183563 => 16:42:04.208183
[0m16:42:04.208886 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: Close
[0m16:42:04.209153 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.0 seconds
[0m16:42:04.209694 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.0 seconds
[0m16:42:04.215115 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:42:04.218272 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:42:04.218955 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
alter table "Adventureworks"."teste"."stg_product__dbt_tmp" rename to "stg_product"
[0m16:42:04.219718 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
alter table "Adventureworks"."teste"."stg_product_category__dbt_tmp" rename to "stg_product_category"
[0m16:42:04.220829 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:04.221496 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:42:04.235584 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m16:42:04.237334 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m16:42:04.238077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:42:04.238726 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:42:04.239392 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m16:42:04.240094 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m16:42:04.244545 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:42:04.248656 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:42:04.248962 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:42:04.249541 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
drop table if exists "Adventureworks"."teste"."stg_product__dbt_backup" cascade
[0m16:42:04.251614 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:42:04.252674 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:42:04.252955 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
drop table if exists "Adventureworks"."teste"."stg_product_category__dbt_backup" cascade
[0m16:42:04.254307 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (execute): 16:42:04.149686 => 16:42:04.254166
[0m16:42:04.255260 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:42:04.255555 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: Close
[0m16:42:04.256891 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (execute): 16:42:04.180185 => 16:42:04.256756
[0m16:42:04.257811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ce1db7a-7f34-4051-9cc9-bb2aa24ba293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893a3f8100>]}
[0m16:42:04.258391 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: Close
[0m16:42:04.259244 [info ] [Thread-1 (]: 1 of 5 OK created sql table model teste.stg_product ............................ [[32mSELECT 504[0m in 0.13s]
[0m16:42:04.260240 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ce1db7a-7f34-4051-9cc9-bb2aa24ba293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8939f7fd90>]}
[0m16:42:04.260919 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m16:42:04.261642 [info ] [Thread-2 (]: 2 of 5 OK created sql table model teste.stg_product_category ................... [[32mSELECT 4[0m in 0.13s]
[0m16:42:04.262952 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m16:42:04.270400 [debug] [Thread-3 (]: Database Error in model stg_sales_order_detail (models/teste/staging/stg_sales_order_detail.sql)
  column "linetotal" does not exist
  LINE 16:     LineTotal
               ^
  compiled Code at target/run/dbt_tutorial/models/teste/staging/stg_sales_order_detail.sql
[0m16:42:04.271084 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ce1db7a-7f34-4051-9cc9-bb2aa24ba293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893a3f6ec0>]}
[0m16:42:04.271781 [error] [Thread-3 (]: 3 of 5 ERROR creating sql table model teste.stg_sales_order_detail ............. [[31mERROR[0m in 0.14s]
[0m16:42:04.272547 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m16:42:04.273812 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m16:42:04.274418 [info ] [Thread-4 (]: 4 of 5 SKIP relation teste.int_sales_by_product ................................ [[33mSKIP[0m]
[0m16:42:04.275128 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m16:42:04.276024 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m16:42:04.276719 [info ] [Thread-2 (]: 5 of 5 SKIP relation teste.mart_sales_by_category .............................. [[33mSKIP[0m]
[0m16:42:04.277396 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m16:42:04.279351 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:04.279988 [debug] [MainThread]: On master: BEGIN
[0m16:42:04.280508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:42:04.285784 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:04.286713 [debug] [MainThread]: On master: COMMIT
[0m16:42:04.287321 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:04.287834 [debug] [MainThread]: On master: COMMIT
[0m16:42:04.288530 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:42:04.289012 [debug] [MainThread]: On master: Close
[0m16:42:04.289805 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:04.290312 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product' was properly closed.
[0m16:42:04.290836 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product_category' was properly closed.
[0m16:42:04.291403 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_sales_order_detail' was properly closed.
[0m16:42:04.291970 [info ] [MainThread]: 
[0m16:42:04.292558 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m16:42:04.293569 [debug] [MainThread]: Command end result
[0m16:42:04.303184 [info ] [MainThread]: 
[0m16:42:04.304145 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:42:04.304816 [info ] [MainThread]: 
[0m16:42:04.305525 [error] [MainThread]: [33mDatabase Error in model stg_sales_order_detail (models/teste/staging/stg_sales_order_detail.sql)[0m
[0m16:42:04.306178 [error] [MainThread]:   column "linetotal" does not exist
[0m16:42:04.306872 [error] [MainThread]:   LINE 16:     LineTotal
[0m16:42:04.307604 [error] [MainThread]:                ^
[0m16:42:04.308524 [error] [MainThread]:   compiled Code at target/run/dbt_tutorial/models/teste/staging/stg_sales_order_detail.sql
[0m16:42:04.309232 [info ] [MainThread]: 
[0m16:42:04.309919 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m16:42:04.310816 [debug] [MainThread]: Command `dbt run` failed at 16:42:04.310667 after 1.73 seconds
[0m16:42:04.311591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893c40da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893affc8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f893bb0e7d0>]}
[0m16:42:04.312333 [debug] [MainThread]: Flushing usage events
[0m16:45:17.105251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5688d5a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd567401cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd567401cf0>]}


============================== 16:45:17.111243 | cade8406-da6b-4c8d-9613-f7c113878e77 ==============================
[0m16:45:17.111243 [info ] [MainThread]: Running with dbt=1.5.11
[0m16:45:17.112023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:45:17.389364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cade8406-da6b-4c8d-9613-f7c113878e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd567401b70>]}
[0m16:45:17.405133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cade8406-da6b-4c8d-9613-f7c113878e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd566b008b0>]}
[0m16:45:17.411160 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m16:45:17.432551 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m16:45:18.524027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:18.524620 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:18.529292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cade8406-da6b-4c8d-9613-f7c113878e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd566785090>]}
[0m16:45:18.532810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cade8406-da6b-4c8d-9613-f7c113878e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56a9e42b0>]}
[0m16:45:18.533417 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m16:45:18.534097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cade8406-da6b-4c8d-9613-f7c113878e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56a9e4250>]}
[0m16:45:18.535410 [info ] [MainThread]: 
[0m16:45:18.536423 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:45:18.537848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks_teste'
[0m16:45:18.546512 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m16:45:18.547373 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m16:45:18.547991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:18.605842 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:45:18.606573 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m16:45:18.607107 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m16:45:18.609526 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:45:18.610814 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m16:45:18.611572 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m16:45:18.615553 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:18.616224 [debug] [MainThread]: On master: BEGIN
[0m16:45:18.616768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:18.621612 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:45:18.622186 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:18.622813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:45:18.627394 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m16:45:18.630716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cade8406-da6b-4c8d-9613-f7c113878e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd566b0c580>]}
[0m16:45:18.631366 [debug] [MainThread]: On master: ROLLBACK
[0m16:45:18.632062 [debug] [MainThread]: On master: Close
[0m16:45:18.632800 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:45:18.633474 [info ] [MainThread]: 
[0m16:45:18.638113 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m16:45:18.638463 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.stg_product_category
[0m16:45:18.638768 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m16:45:18.639580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m16:45:18.640462 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_product_category'
[0m16:45:18.641387 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_sales_order_detail'
[0m16:45:18.642006 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m16:45:18.642658 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m16:45:18.643228 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m16:45:18.650025 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m16:45:18.652001 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m16:45:18.654272 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m16:45:18.658381 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 16:45:18.652715 => 16:45:18.658165
[0m16:45:18.658749 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 16:45:18.643780 => 16:45:18.658590
[0m16:45:18.659339 [debug] [Thread-3 (]: Began executing node model.dbt_tutorial.stg_sales_order_detail
[0m16:45:18.659692 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 16:45:18.650536 => 16:45:18.659539
[0m16:45:18.660187 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_product
[0m16:45:18.660905 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (execute): 16:45:18.660745 => 16:45:18.660758
[0m16:45:18.661479 [debug] [Thread-2 (]: Began executing node model.dbt_tutorial.stg_product_category
[0m16:45:18.662156 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (execute): 16:45:18.662007 => 16:45:18.662013
[0m16:45:18.663093 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m16:45:18.663770 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (execute): 16:45:18.663620 => 16:45:18.663626
[0m16:45:18.664657 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m16:45:18.665970 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m16:45:18.666948 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m16:45:18.668111 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_tutorial.int_sales_by_product'
[0m16:45:18.668657 [debug] [Thread-4 (]: Began compiling node model.dbt_tutorial.int_sales_by_product
[0m16:45:18.671104 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_tutorial.int_sales_by_product"
[0m16:45:18.679557 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.int_sales_by_product (compile): 16:45:18.669115 => 16:45:18.679383
[0m16:45:18.680105 [debug] [Thread-4 (]: Began executing node model.dbt_tutorial.int_sales_by_product
[0m16:45:18.680759 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.int_sales_by_product (execute): 16:45:18.680604 => 16:45:18.680614
[0m16:45:18.681633 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m16:45:18.682741 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m16:45:18.683462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product, now model.dbt_tutorial.mart_sales_by_category)
[0m16:45:18.684052 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.mart_sales_by_category
[0m16:45:18.686561 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.mart_sales_by_category"
[0m16:45:18.694451 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (compile): 16:45:18.684523 => 16:45:18.694241
[0m16:45:18.695058 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.mart_sales_by_category
[0m16:45:18.695696 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (execute): 16:45:18.695546 => 16:45:18.695554
[0m16:45:18.696736 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m16:45:18.698221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:18.698860 [debug] [MainThread]: Connection 'model.dbt_tutorial.mart_sales_by_category' was properly closed.
[0m16:45:18.699374 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product_category' was properly closed.
[0m16:45:18.699907 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_sales_order_detail' was properly closed.
[0m16:45:18.700404 [debug] [MainThread]: Connection 'model.dbt_tutorial.int_sales_by_product' was properly closed.
[0m16:45:18.701631 [debug] [MainThread]: Command end result
[0m16:45:18.734394 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m16:45:18.735082 [info ] [MainThread]: Building catalog
[0m16:45:18.737423 [debug] [ThreadPool]: Acquiring new postgres connection 'Adventureworks.information_schema'
[0m16:45:18.742858 [debug] [ThreadPool]: Using postgres connection "Adventureworks.information_schema"
[0m16:45:18.743640 [debug] [ThreadPool]: On Adventureworks.information_schema: BEGIN
[0m16:45:18.744254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:18.750500 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:45:18.751484 [debug] [ThreadPool]: Using postgres connection "Adventureworks.information_schema"
[0m16:45:18.752187 [debug] [ThreadPool]: On Adventureworks.information_schema: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "Adventureworks.information_schema"} */

    
    

    select
        'Adventureworks' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('production') or upper(sch.nspname) = upper('sales') or upper(sch.nspname) = upper('teste'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m16:45:18.759367 [debug] [ThreadPool]: SQL status: SELECT 441 in 0.0 seconds
[0m16:45:18.772204 [debug] [ThreadPool]: On Adventureworks.information_schema: ROLLBACK
[0m16:45:18.773349 [debug] [ThreadPool]: On Adventureworks.information_schema: Close
[0m16:45:18.787559 [info ] [MainThread]: Catalog written to /mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/target/catalog.json
[0m16:45:18.788706 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:45:18.788609 after 1.70 seconds
[0m16:45:18.789251 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:45:18.789777 [debug] [MainThread]: Connection 'Adventureworks.information_schema' was properly closed.
[0m16:45:18.790349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5688d5a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd567b83df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd56a9e42b0>]}
[0m16:45:18.790935 [debug] [MainThread]: Flushing usage events
[0m16:45:28.799663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54a2a1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa548e01ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa548e01bd0>]}


============================== 16:45:28.805890 | 6adad020-a9cb-4450-b5d3-728bc0148448 ==============================
[0m16:45:28.805890 [info ] [MainThread]: Running with dbt=1.5.11
[0m16:45:28.806650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'debug': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:45:29.078730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6adad020-a9cb-4450-b5d3-728bc0148448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa548e01a50>]}
[0m16:45:29.094430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6adad020-a9cb-4450-b5d3-728bc0148448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54850c8b0>]}
[0m16:45:58.653847 [error] [MainThread]: Encountered an error:

[0m16:45:58.664918 [error] [MainThread]: Traceback (most recent call last):
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/main.py", line 315, in docs_serve
    results = task.run()
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m16:45:58.665816 [debug] [MainThread]: Command `dbt docs serve` failed at 16:45:58.665722 after 29.88 seconds
[0m16:45:58.666552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54a2a1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54850ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54850df00>]}
[0m16:45:58.667605 [debug] [MainThread]: Flushing usage events
[0m16:47:20.368520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff59cb1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff58809c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff58809c00>]}


============================== 16:47:20.374893 | 1fa97a2e-0d91-4995-ad5a-1e62f92337dd ==============================
[0m16:47:20.374893 [info ] [MainThread]: Running with dbt=1.5.11
[0m16:47:20.375623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'fail_fast': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:47:20.651274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fa97a2e-0d91-4995-ad5a-1e62f92337dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff58809d80>]}
[0m16:47:20.667299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fa97a2e-0d91-4995-ad5a-1e62f92337dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff57f088b0>]}
[0m16:47:20.673160 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m16:47:20.695575 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m16:47:21.803227 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:47:21.804028 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_sales_order_detail.sql
[0m16:47:21.828584 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_order_detail.sql
[0m16:47:21.848087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fa97a2e-0d91-4995-ad5a-1e62f92337dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff57ba6d70>]}
[0m16:47:21.859308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fa97a2e-0d91-4995-ad5a-1e62f92337dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff59969030>]}
[0m16:47:21.860157 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m16:47:21.860855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fa97a2e-0d91-4995-ad5a-1e62f92337dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff58f541f0>]}
[0m16:47:21.862330 [info ] [MainThread]: 
[0m16:47:21.863501 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:47:21.865366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m16:47:21.874350 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m16:47:21.875186 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m16:47:21.875823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:21.935820 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m16:47:21.937427 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m16:47:21.938647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now create_Adventureworks_teste)
[0m16:47:21.939442 [debug] [ThreadPool]: Creating schema "database: "Adventureworks"
schema: "teste"
"
[0m16:47:21.943719 [debug] [ThreadPool]: Using postgres connection "create_Adventureworks_teste"
[0m16:47:21.944312 [debug] [ThreadPool]: On create_Adventureworks_teste: BEGIN
[0m16:47:21.944886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:21.950498 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:47:21.951386 [debug] [ThreadPool]: Using postgres connection "create_Adventureworks_teste"
[0m16:47:21.952001 [debug] [ThreadPool]: On create_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "create_Adventureworks_teste"} */
create schema if not exists "teste"
[0m16:47:21.953175 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m16:47:21.954303 [debug] [ThreadPool]: On create_Adventureworks_teste: COMMIT
[0m16:47:21.954837 [debug] [ThreadPool]: Using postgres connection "create_Adventureworks_teste"
[0m16:47:21.955346 [debug] [ThreadPool]: On create_Adventureworks_teste: COMMIT
[0m16:47:21.959005 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m16:47:21.959728 [debug] [ThreadPool]: On create_Adventureworks_teste: Close
[0m16:47:21.961809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_Adventureworks_teste, now list_Adventureworks_teste)
[0m16:47:21.966975 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m16:47:21.967686 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m16:47:21.968208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:21.973879 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:47:21.974702 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m16:47:21.975250 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m16:47:21.977888 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:47:21.979281 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m16:47:21.980126 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m16:47:21.984031 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:21.984754 [debug] [MainThread]: On master: BEGIN
[0m16:47:21.985263 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:47:21.990296 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:47:21.990847 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:21.991443 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:47:21.996172 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m16:47:21.999559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fa97a2e-0d91-4995-ad5a-1e62f92337dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff58892f20>]}
[0m16:47:22.000220 [debug] [MainThread]: On master: ROLLBACK
[0m16:47:22.000956 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:22.001458 [debug] [MainThread]: On master: BEGIN
[0m16:47:22.002371 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:47:22.002891 [debug] [MainThread]: On master: COMMIT
[0m16:47:22.003441 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:22.003918 [debug] [MainThread]: On master: COMMIT
[0m16:47:22.004613 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:47:22.005117 [debug] [MainThread]: On master: Close
[0m16:47:22.005890 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:47:22.006556 [info ] [MainThread]: 
[0m16:47:22.010945 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m16:47:22.011275 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.stg_product_category
[0m16:47:22.011577 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m16:47:22.012211 [info ] [Thread-1 (]: 1 of 5 START sql table model teste.stg_product ................................. [RUN]
[0m16:47:22.012949 [info ] [Thread-2 (]: 2 of 5 START sql table model teste.stg_product_category ........................ [RUN]
[0m16:47:22.013624 [info ] [Thread-3 (]: 3 of 5 START sql table model teste.stg_sales_order_detail ...................... [RUN]
[0m16:47:22.014493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m16:47:22.015324 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_product_category'
[0m16:47:22.016172 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_sales_order_detail'
[0m16:47:22.016793 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m16:47:22.017391 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m16:47:22.017957 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m16:47:22.025176 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m16:47:22.027306 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m16:47:22.029451 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m16:47:22.033545 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 16:47:22.027965 => 16:47:22.033229
[0m16:47:22.033989 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 16:47:22.018542 => 16:47:22.033787
[0m16:47:22.034635 [debug] [Thread-3 (]: Began executing node model.dbt_tutorial.stg_sales_order_detail
[0m16:47:22.035277 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 16:47:22.025711 => 16:47:22.035114
[0m16:47:22.035552 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_product
[0m16:47:22.057456 [debug] [Thread-2 (]: Began executing node model.dbt_tutorial.stg_product_category
[0m16:47:22.066421 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_tutorial.stg_sales_order_detail"
[0m16:47:22.069756 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product"
[0m16:47:22.073424 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product_category"
[0m16:47:22.077444 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:47:22.077781 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:47:22.078474 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: BEGIN
[0m16:47:22.078789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:47:22.079316 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: BEGIN
[0m16:47:22.079927 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:47:22.080516 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: BEGIN
[0m16:47:22.081104 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:47:22.082215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:22.086799 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:47:22.087653 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:47:22.087952 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:47:22.088258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:47:22.088867 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:47:22.089481 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */

  
    

  create  table "Adventureworks"."teste"."stg_product_category__dbt_tmp"
  
  
    as
  
  (
    SELECT
    ProductCategoryID,
    Name AS CategoryName
FROM
    "Adventureworks"."production"."productcategory"
  );
  
[0m16:47:22.090055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:47:22.090715 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */

  
    

  create  table "Adventureworks"."teste"."stg_sales_order_detail__dbt_tmp"
  
  
    as
  
  (
    SELECT
    SalesOrderID,
    ProductID,
    OrderQty,
FROM
    "Adventureworks"."sales"."salesorderdetail"
  );
  
[0m16:47:22.091662 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */

  
    

  create  table "Adventureworks"."teste"."stg_product__dbt_tmp"
  
  
    as
  
  (
    SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
  );
  
[0m16:47:22.093497 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 16: FROM
         ^

[0m16:47:22.094151 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: ROLLBACK
[0m16:47:22.094435 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.0 seconds
[0m16:47:22.095010 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.0 seconds
[0m16:47:22.095482 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (execute): 16:47:22.036102 => 16:47:22.095314
[0m16:47:22.100294 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:47:22.103320 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:47:22.104170 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: Close
[0m16:47:22.104796 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
alter table "Adventureworks"."teste"."stg_product_category__dbt_tmp" rename to "stg_product_category"
[0m16:47:22.105410 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
alter table "Adventureworks"."teste"."stg_product__dbt_tmp" rename to "stg_product"
[0m16:47:22.107248 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:47:22.107999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:47:22.122378 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m16:47:22.124004 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m16:47:22.124811 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:47:22.125532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:47:22.126248 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m16:47:22.126951 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m16:47:22.130899 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:47:22.135097 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:47:22.135424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:47:22.135976 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
drop table if exists "Adventureworks"."teste"."stg_product_category__dbt_backup" cascade
[0m16:47:22.138085 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:47:22.139263 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:47:22.139549 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
drop table if exists "Adventureworks"."teste"."stg_product__dbt_backup" cascade
[0m16:47:22.141139 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (execute): 16:47:22.070500 => 16:47:22.140953
[0m16:47:22.142170 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:47:22.142642 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: Close
[0m16:47:22.143975 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (execute): 16:47:22.067054 => 16:47:22.143838
[0m16:47:22.144889 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fa97a2e-0d91-4995-ad5a-1e62f92337dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff577b0220>]}
[0m16:47:22.145447 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: Close
[0m16:47:22.146332 [info ] [Thread-2 (]: 2 of 5 OK created sql table model teste.stg_product_category ................... [[32mSELECT 4[0m in 0.13s]
[0m16:47:22.147339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fa97a2e-0d91-4995-ad5a-1e62f92337dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5775b1c0>]}
[0m16:47:22.148050 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m16:47:22.148778 [info ] [Thread-1 (]: 1 of 5 OK created sql table model teste.stg_product ............................ [[32mSELECT 504[0m in 0.13s]
[0m16:47:22.150319 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m16:47:22.160994 [debug] [Thread-3 (]: Database Error in model stg_sales_order_detail (models/teste/staging/stg_sales_order_detail.sql)
  syntax error at or near "FROM"
  LINE 16: FROM
           ^
  compiled Code at target/run/dbt_tutorial/models/teste/staging/stg_sales_order_detail.sql
[0m16:47:22.161661 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fa97a2e-0d91-4995-ad5a-1e62f92337dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5996b9d0>]}
[0m16:47:22.162372 [error] [Thread-3 (]: 3 of 5 ERROR creating sql table model teste.stg_sales_order_detail ............. [[31mERROR[0m in 0.15s]
[0m16:47:22.163048 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m16:47:22.164193 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m16:47:22.164785 [info ] [Thread-4 (]: 4 of 5 SKIP relation teste.int_sales_by_product ................................ [[33mSKIP[0m]
[0m16:47:22.165430 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m16:47:22.166468 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m16:47:22.167084 [info ] [Thread-1 (]: 5 of 5 SKIP relation teste.mart_sales_by_category .............................. [[33mSKIP[0m]
[0m16:47:22.167786 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m16:47:22.169401 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:22.170175 [debug] [MainThread]: On master: BEGIN
[0m16:47:22.170805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:47:22.176149 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:47:22.176884 [debug] [MainThread]: On master: COMMIT
[0m16:47:22.177445 [debug] [MainThread]: Using postgres connection "master"
[0m16:47:22.177928 [debug] [MainThread]: On master: COMMIT
[0m16:47:22.178587 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:47:22.179111 [debug] [MainThread]: On master: Close
[0m16:47:22.179854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:22.180351 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product' was properly closed.
[0m16:47:22.180826 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product_category' was properly closed.
[0m16:47:22.181377 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_sales_order_detail' was properly closed.
[0m16:47:22.181926 [info ] [MainThread]: 
[0m16:47:22.182602 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m16:47:22.183604 [debug] [MainThread]: Command end result
[0m16:47:22.192928 [info ] [MainThread]: 
[0m16:47:22.193733 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:47:22.194343 [info ] [MainThread]: 
[0m16:47:22.194928 [error] [MainThread]: [33mDatabase Error in model stg_sales_order_detail (models/teste/staging/stg_sales_order_detail.sql)[0m
[0m16:47:22.195542 [error] [MainThread]:   syntax error at or near "FROM"
[0m16:47:22.196185 [error] [MainThread]:   LINE 16: FROM
[0m16:47:22.196900 [error] [MainThread]:            ^
[0m16:47:22.197607 [error] [MainThread]:   compiled Code at target/run/dbt_tutorial/models/teste/staging/stg_sales_order_detail.sql
[0m16:47:22.198251 [info ] [MainThread]: 
[0m16:47:22.198893 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m16:47:22.199651 [debug] [MainThread]: Command `dbt run` failed at 16:47:22.199562 after 1.84 seconds
[0m16:47:22.200474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff59cb1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff58892f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff599689a0>]}
[0m16:47:22.201388 [debug] [MainThread]: Flushing usage events
[0m16:48:38.862110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe474bb5a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe473709cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe473709c90>]}


============================== 16:48:38.868000 | 1a497ae6-3405-45e9-965c-383a1df06fd2 ==============================
[0m16:48:38.868000 [info ] [MainThread]: Running with dbt=1.5.11
[0m16:48:38.868763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:48:39.143338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a497ae6-3405-45e9-965c-383a1df06fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe473709e10>]}
[0m16:48:39.159195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a497ae6-3405-45e9-965c-383a1df06fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe472b048b0>]}
[0m16:48:39.164994 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m16:48:39.186292 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m16:48:40.291693 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:48:40.293077 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_sales_order_detail.sql
[0m16:48:40.322385 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_order_detail.sql
[0m16:48:40.342456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a497ae6-3405-45e9-965c-383a1df06fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4727a7700>]}
[0m16:48:40.352733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a497ae6-3405-45e9-965c-383a1df06fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47481c820>]}
[0m16:48:40.353598 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m16:48:40.354324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a497ae6-3405-45e9-965c-383a1df06fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4742ba7d0>]}
[0m16:48:40.355783 [info ] [MainThread]: 
[0m16:48:40.356756 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:48:40.358103 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m16:48:40.366424 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m16:48:40.367199 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m16:48:40.367714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:40.425858 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m16:48:40.427445 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m16:48:40.429030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now list_Adventureworks_teste)
[0m16:48:40.433624 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m16:48:40.434256 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m16:48:40.434802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:40.439752 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:48:40.440406 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m16:48:40.440925 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m16:48:40.443295 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m16:48:40.444548 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m16:48:40.445270 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m16:48:40.449246 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:40.449922 [debug] [MainThread]: On master: BEGIN
[0m16:48:40.450510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:48:40.455440 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:48:40.456000 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:40.456690 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:48:40.461329 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m16:48:40.464700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a497ae6-3405-45e9-965c-383a1df06fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47378f0a0>]}
[0m16:48:40.465358 [debug] [MainThread]: On master: ROLLBACK
[0m16:48:40.466177 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:40.466707 [debug] [MainThread]: On master: BEGIN
[0m16:48:40.467614 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:48:40.468166 [debug] [MainThread]: On master: COMMIT
[0m16:48:40.468700 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:40.469185 [debug] [MainThread]: On master: COMMIT
[0m16:48:40.470004 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:48:40.470528 [debug] [MainThread]: On master: Close
[0m16:48:40.471338 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:40.471952 [info ] [MainThread]: 
[0m16:48:40.475702 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m16:48:40.476032 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.stg_product_category
[0m16:48:40.476373 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m16:48:40.477033 [info ] [Thread-1 (]: 1 of 5 START sql table model teste.stg_product ................................. [RUN]
[0m16:48:40.477777 [info ] [Thread-2 (]: 2 of 5 START sql table model teste.stg_product_category ........................ [RUN]
[0m16:48:40.478512 [info ] [Thread-3 (]: 3 of 5 START sql table model teste.stg_sales_order_detail ...................... [RUN]
[0m16:48:40.479411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m16:48:40.480283 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_product_category'
[0m16:48:40.481082 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_sales_order_detail'
[0m16:48:40.481696 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m16:48:40.482306 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m16:48:40.482908 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m16:48:40.489782 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m16:48:40.492721 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m16:48:40.494965 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m16:48:40.498887 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 16:48:40.483813 => 16:48:40.498711
[0m16:48:40.499562 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 16:48:40.490367 => 16:48:40.499402
[0m16:48:40.499860 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_product
[0m16:48:40.500220 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 16:48:40.493438 => 16:48:40.500063
[0m16:48:40.500781 [debug] [Thread-2 (]: Began executing node model.dbt_tutorial.stg_product_category
[0m16:48:40.522474 [debug] [Thread-3 (]: Began executing node model.dbt_tutorial.stg_sales_order_detail
[0m16:48:40.531415 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product"
[0m16:48:40.534968 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product_category"
[0m16:48:40.538472 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_tutorial.stg_sales_order_detail"
[0m16:48:40.542765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:48:40.543092 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:48:40.543848 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: BEGIN
[0m16:48:40.544335 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:48:40.544906 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: BEGIN
[0m16:48:40.545507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:40.546139 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: BEGIN
[0m16:48:40.546735 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:48:40.548312 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:48:40.552351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:48:40.553110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:48:40.553877 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */

  
    

  create  table "Adventureworks"."teste"."stg_product__dbt_tmp"
  
  
    as
  
  (
    SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
  );
  
[0m16:48:40.554215 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:48:40.554609 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:48:40.555534 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:48:40.556149 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:48:40.556797 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */

  
    

  create  table "Adventureworks"."teste"."stg_sales_order_detail__dbt_tmp"
  
  
    as
  
  (
    SELECT
    SalesOrderID,
    ProductID,
    OrderQty
FROM
    "Adventureworks"."sales"."salesorderdetail"
  );
  
[0m16:48:40.557442 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */

  
    

  create  table "Adventureworks"."teste"."stg_product_category__dbt_tmp"
  
  
    as
  
  (
    SELECT
    ProductCategoryID,
    Name AS CategoryName
FROM
    "Adventureworks"."production"."productcategory"
  );
  
[0m16:48:40.558385 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.0 seconds
[0m16:48:40.563894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:48:40.564203 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.0 seconds
[0m16:48:40.564767 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
alter table "Adventureworks"."teste"."stg_product" rename to "stg_product__dbt_backup"
[0m16:48:40.567868 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:48:40.568980 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
alter table "Adventureworks"."teste"."stg_product_category" rename to "stg_product_category__dbt_backup"
[0m16:48:40.569364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:48:40.572252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:48:40.572544 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:48:40.573056 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
alter table "Adventureworks"."teste"."stg_product__dbt_tmp" rename to "stg_product"
[0m16:48:40.575446 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:48:40.576522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:48:40.576809 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
alter table "Adventureworks"."teste"."stg_product_category__dbt_tmp" rename to "stg_product_category"
[0m16:48:40.592617 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m16:48:40.593570 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:48:40.593873 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:48:40.594388 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m16:48:40.596402 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m16:48:40.597382 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:48:40.597967 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m16:48:40.613279 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:48:40.617842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:48:40.618150 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:48:40.618819 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
drop table if exists "Adventureworks"."teste"."stg_product__dbt_backup" cascade
[0m16:48:40.621826 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:48:40.623035 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
drop table if exists "Adventureworks"."teste"."stg_product_category__dbt_backup" cascade
[0m16:48:40.626458 [debug] [Thread-3 (]: SQL status: SELECT 121317 in 0.0 seconds
[0m16:48:40.629030 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:48:40.629602 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */
alter table "Adventureworks"."teste"."stg_sales_order_detail__dbt_tmp" rename to "stg_sales_order_detail"
[0m16:48:40.629881 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:48:40.631585 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (execute): 16:48:40.501319 => 16:48:40.631434
[0m16:48:40.631839 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:48:40.632357 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: Close
[0m16:48:40.634024 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: COMMIT
[0m16:48:40.634335 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:48:40.635095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497ae6-3405-45e9-965c-383a1df06fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe472373eb0>]}
[0m16:48:40.635643 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:48:40.637393 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (execute): 16:48:40.532054 => 16:48:40.637201
[0m16:48:40.638179 [info ] [Thread-1 (]: 1 of 5 OK created sql table model teste.stg_product ............................ [[32mSELECT 504[0m in 0.16s]
[0m16:48:40.638812 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: COMMIT
[0m16:48:40.639395 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: Close
[0m16:48:40.640128 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m16:48:40.641342 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497ae6-3405-45e9-965c-383a1df06fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47236f700>]}
[0m16:48:40.642383 [info ] [Thread-2 (]: 2 of 5 OK created sql table model teste.stg_product_category ................... [[32mSELECT 4[0m in 0.16s]
[0m16:48:40.643170 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m16:48:40.643640 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:48:40.646158 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:48:40.646781 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */
drop table if exists "Adventureworks"."teste"."stg_sales_order_detail__dbt_backup" cascade
[0m16:48:40.647650 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:48:40.648981 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (execute): 16:48:40.535605 => 16:48:40.648841
[0m16:48:40.649524 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: Close
[0m16:48:40.650336 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497ae6-3405-45e9-965c-383a1df06fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe471f0f6d0>]}
[0m16:48:40.651177 [info ] [Thread-3 (]: 3 of 5 OK created sql table model teste.stg_sales_order_detail ................. [[32mSELECT 121317[0m in 0.17s]
[0m16:48:40.651990 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m16:48:40.653171 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m16:48:40.654013 [info ] [Thread-4 (]: 4 of 5 START sql table model teste.int_sales_by_product ........................ [RUN]
[0m16:48:40.654975 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_tutorial.int_sales_by_product'
[0m16:48:40.655539 [debug] [Thread-4 (]: Began compiling node model.dbt_tutorial.int_sales_by_product
[0m16:48:40.658114 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_tutorial.int_sales_by_product"
[0m16:48:40.663356 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.int_sales_by_product (compile): 16:48:40.655977 => 16:48:40.663165
[0m16:48:40.663929 [debug] [Thread-4 (]: Began executing node model.dbt_tutorial.int_sales_by_product
[0m16:48:40.667427 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_tutorial.int_sales_by_product"
[0m16:48:40.675778 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m16:48:40.676447 [debug] [Thread-4 (]: On model.dbt_tutorial.int_sales_by_product: BEGIN
[0m16:48:40.676976 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:48:40.682334 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:48:40.683009 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m16:48:40.683606 [debug] [Thread-4 (]: On model.dbt_tutorial.int_sales_by_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.int_sales_by_product"} */

  
    

  create  table "Adventureworks"."teste"."int_sales_by_product__dbt_tmp"
  
  
    as
  
  (
    WITH sales AS (
    SELECT
        sod.ProductID,
        SUM(sod.LineTotal) AS TotalSales
    FROM "Adventureworks"."teste"."stg_sales_order_detail" sod
    GROUP BY sod.ProductID
)
SELECT 
    s.ProductID,
    s.TotalSales,
    p.ProductSubcategoryID
FROM sales s
JOIN "Adventureworks"."teste"."stg_product" p ON s.ProductID = p.ProductID
  );
  
[0m16:48:40.684708 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column sod.linetotal does not exist
LINE 15:         SUM(sod.LineTotal) AS TotalSales
                     ^

[0m16:48:40.685286 [debug] [Thread-4 (]: On model.dbt_tutorial.int_sales_by_product: ROLLBACK
[0m16:48:40.686168 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.int_sales_by_product (execute): 16:48:40.664378 => 16:48:40.685965
[0m16:48:40.686861 [debug] [Thread-4 (]: On model.dbt_tutorial.int_sales_by_product: Close
[0m16:48:40.712428 [debug] [Thread-4 (]: Database Error in model int_sales_by_product (models/teste/int/int_sales_by_product.sql)
  column sod.linetotal does not exist
  LINE 15:         SUM(sod.LineTotal) AS TotalSales
                       ^
  compiled Code at target/run/dbt_tutorial/models/teste/int/int_sales_by_product.sql
[0m16:48:40.713116 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a497ae6-3405-45e9-965c-383a1df06fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe471f2b130>]}
[0m16:48:40.714072 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model teste.int_sales_by_product ............... [[31mERROR[0m in 0.06s]
[0m16:48:40.714903 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m16:48:40.715957 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m16:48:40.716630 [info ] [Thread-2 (]: 5 of 5 SKIP relation teste.mart_sales_by_category .............................. [[33mSKIP[0m]
[0m16:48:40.717330 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m16:48:40.718923 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:40.719469 [debug] [MainThread]: On master: BEGIN
[0m16:48:40.719969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:48:40.725299 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:48:40.725917 [debug] [MainThread]: On master: COMMIT
[0m16:48:40.726493 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:40.726990 [debug] [MainThread]: On master: COMMIT
[0m16:48:40.727661 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:48:40.728173 [debug] [MainThread]: On master: Close
[0m16:48:40.728968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:40.729483 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product' was properly closed.
[0m16:48:40.729958 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product_category' was properly closed.
[0m16:48:40.730515 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_sales_order_detail' was properly closed.
[0m16:48:40.731007 [debug] [MainThread]: Connection 'model.dbt_tutorial.int_sales_by_product' was properly closed.
[0m16:48:40.731529 [info ] [MainThread]: 
[0m16:48:40.732105 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m16:48:40.733185 [debug] [MainThread]: Command end result
[0m16:48:40.743619 [info ] [MainThread]: 
[0m16:48:40.744433 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:48:40.745049 [info ] [MainThread]: 
[0m16:48:40.745706 [error] [MainThread]: [33mDatabase Error in model int_sales_by_product (models/teste/int/int_sales_by_product.sql)[0m
[0m16:48:40.746386 [error] [MainThread]:   column sod.linetotal does not exist
[0m16:48:40.746988 [error] [MainThread]:   LINE 15:         SUM(sod.LineTotal) AS TotalSales
[0m16:48:40.747582 [error] [MainThread]:                        ^
[0m16:48:40.748167 [error] [MainThread]:   compiled Code at target/run/dbt_tutorial/models/teste/int/int_sales_by_product.sql
[0m16:48:40.748925 [info ] [MainThread]: 
[0m16:48:40.749573 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m16:48:40.750514 [debug] [MainThread]: Command `dbt run` failed at 16:48:40.750416 after 1.90 seconds
[0m16:48:40.751247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe474bb5a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe476cbc2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe47378fac0>]}
[0m16:48:40.751929 [debug] [MainThread]: Flushing usage events
[0m16:50:30.176847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dfc21a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0de8fdc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0de8fdc60>]}


============================== 16:50:30.183109 | 2a46dbba-5ea8-4af4-aa0f-d43582dbe938 ==============================
[0m16:50:30.183109 [info ] [MainThread]: Running with dbt=1.5.11
[0m16:50:30.183832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'debug': 'False', 'version_check': 'True', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:50:30.457839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a46dbba-5ea8-4af4-aa0f-d43582dbe938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0de8fdde0>]}
[0m16:50:30.474056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a46dbba-5ea8-4af4-aa0f-d43582dbe938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0de7f88b0>]}
[0m16:50:30.480471 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m16:50:30.502445 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m16:50:31.601306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:50:31.602119 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_sales_order_detail.sql
[0m16:50:31.602729 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/int/int_sales_by_product.sql
[0m16:50:31.627221 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_order_detail.sql
[0m16:50:31.637530 [debug] [MainThread]: 1699: static parser successfully parsed int/int_sales_by_product.sql
[0m16:50:31.649521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a46dbba-5ea8-4af4-aa0f-d43582dbe938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ddb00f10>]}
[0m16:50:31.659326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a46dbba-5ea8-4af4-aa0f-d43582dbe938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0df691f90>]}
[0m16:50:31.660086 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m16:50:31.660797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a46dbba-5ea8-4af4-aa0f-d43582dbe938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0df322770>]}
[0m16:50:31.662278 [info ] [MainThread]: 
[0m16:50:31.663286 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:50:31.664809 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m16:50:31.673338 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m16:50:31.674122 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m16:50:31.674691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:31.730158 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m16:50:31.731605 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m16:50:31.733186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now list_Adventureworks_teste)
[0m16:50:31.737788 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m16:50:31.738426 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m16:50:31.738965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:31.743905 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:50:31.744556 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m16:50:31.745084 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m16:50:31.747536 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:50:31.748749 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m16:50:31.749507 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m16:50:31.753587 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:31.754218 [debug] [MainThread]: On master: BEGIN
[0m16:50:31.754751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:31.759787 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:50:31.760384 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:31.760995 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:50:31.765639 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m16:50:31.768953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a46dbba-5ea8-4af4-aa0f-d43582dbe938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ddb5d9f0>]}
[0m16:50:31.769663 [debug] [MainThread]: On master: ROLLBACK
[0m16:50:31.770444 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:31.770964 [debug] [MainThread]: On master: BEGIN
[0m16:50:31.771885 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:50:31.772436 [debug] [MainThread]: On master: COMMIT
[0m16:50:31.772953 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:31.773449 [debug] [MainThread]: On master: COMMIT
[0m16:50:31.774123 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:50:31.774615 [debug] [MainThread]: On master: Close
[0m16:50:31.775401 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:50:31.776130 [info ] [MainThread]: 
[0m16:50:31.780034 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m16:50:31.780374 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.stg_product_category
[0m16:50:31.780679 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m16:50:31.781356 [info ] [Thread-1 (]: 1 of 5 START sql table model teste.stg_product ................................. [RUN]
[0m16:50:31.782081 [info ] [Thread-2 (]: 2 of 5 START sql table model teste.stg_product_category ........................ [RUN]
[0m16:50:31.782823 [info ] [Thread-3 (]: 3 of 5 START sql table model teste.stg_sales_order_detail ...................... [RUN]
[0m16:50:31.783690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m16:50:31.784527 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_product_category'
[0m16:50:31.785334 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_sales_order_detail'
[0m16:50:31.785930 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m16:50:31.786617 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m16:50:31.787326 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m16:50:31.793751 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m16:50:31.796596 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m16:50:31.798745 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m16:50:31.802599 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 16:50:31.797222 => 16:50:31.802416
[0m16:50:31.803405 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 16:50:31.787884 => 16:50:31.803091
[0m16:50:31.803800 [debug] [Thread-3 (]: Began executing node model.dbt_tutorial.stg_sales_order_detail
[0m16:50:31.804201 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 16:50:31.794335 => 16:50:31.804037
[0m16:50:31.804957 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_product
[0m16:50:31.832251 [debug] [Thread-2 (]: Began executing node model.dbt_tutorial.stg_product_category
[0m16:50:31.836350 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_tutorial.stg_sales_order_detail"
[0m16:50:31.839789 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product"
[0m16:50:31.843186 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product_category"
[0m16:50:31.847088 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:50:31.847417 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:50:31.848004 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: BEGIN
[0m16:50:31.848361 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:50:31.848911 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: BEGIN
[0m16:50:31.849509 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:50:31.850111 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: BEGIN
[0m16:50:31.850780 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:50:31.852076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:31.856452 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:50:31.857288 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:50:31.857862 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:50:31.858162 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:50:31.858647 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:50:31.859235 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */

  
    

  create  table "Adventureworks"."teste"."stg_sales_order_detail__dbt_tmp"
  
  
    as
  
  (
    SELECT
    SalesOrderID,
    ProductID,
    OrderQty,
    unitipryce
FROM
    "Adventureworks"."sales"."salesorderdetail"
  );
  
[0m16:50:31.859813 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:50:31.860402 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */

  
    

  create  table "Adventureworks"."teste"."stg_product_category__dbt_tmp"
  
  
    as
  
  (
    SELECT
    ProductCategoryID,
    Name AS CategoryName
FROM
    "Adventureworks"."production"."productcategory"
  );
  
[0m16:50:31.861365 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */

  
    

  create  table "Adventureworks"."teste"."stg_product__dbt_tmp"
  
  
    as
  
  (
    SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
  );
  
[0m16:50:31.861688 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "unitipryce" does not exist
LINE 16:     unitipryce
             ^
HINT:  Perhaps you meant to reference the column "salesorderdetail.unitprice".

[0m16:50:31.862928 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: ROLLBACK
[0m16:50:31.863955 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (execute): 16:50:31.805546 => 16:50:31.863777
[0m16:50:31.864266 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.0 seconds
[0m16:50:31.864554 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.0 seconds
[0m16:50:31.865084 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: Close
[0m16:50:31.870254 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:50:31.873354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:50:31.874684 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
alter table "Adventureworks"."teste"."stg_product_category" rename to "stg_product_category__dbt_backup"
[0m16:50:31.875304 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
alter table "Adventureworks"."teste"."stg_product" rename to "stg_product__dbt_backup"
[0m16:50:31.876514 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:31.876788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:31.879242 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:50:31.881741 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:50:31.882590 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
alter table "Adventureworks"."teste"."stg_product_category__dbt_tmp" rename to "stg_product_category"
[0m16:50:31.883317 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
alter table "Adventureworks"."teste"."stg_product__dbt_tmp" rename to "stg_product"
[0m16:50:31.884436 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:31.884686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:50:31.901376 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m16:50:31.903270 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m16:50:31.904087 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:50:31.904753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:50:31.905419 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m16:50:31.906132 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m16:50:31.910064 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:50:31.914243 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:50:31.914572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:50:31.915244 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
drop table if exists "Adventureworks"."teste"."stg_product_category__dbt_backup" cascade
[0m16:50:31.917387 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:50:31.918631 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
drop table if exists "Adventureworks"."teste"."stg_product__dbt_backup" cascade
[0m16:50:31.921808 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:50:31.923406 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (execute): 16:50:31.840383 => 16:50:31.923253
[0m16:50:31.924104 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: Close
[0m16:50:31.924398 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:50:31.925217 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a46dbba-5ea8-4af4-aa0f-d43582dbe938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dd700070>]}
[0m16:50:31.926658 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (execute): 16:50:31.836926 => 16:50:31.926517
[0m16:50:31.927614 [info ] [Thread-2 (]: 2 of 5 OK created sql table model teste.stg_product_category ................... [[32mSELECT 4[0m in 0.14s]
[0m16:50:31.928487 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: Close
[0m16:50:31.929310 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m16:50:31.930270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a46dbba-5ea8-4af4-aa0f-d43582dbe938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ddb9abc0>]}
[0m16:50:31.931382 [info ] [Thread-1 (]: 1 of 5 OK created sql table model teste.stg_product ............................ [[32mSELECT 504[0m in 0.15s]
[0m16:50:31.932310 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m16:50:31.935948 [debug] [Thread-3 (]: Database Error in model stg_sales_order_detail (models/teste/staging/stg_sales_order_detail.sql)
  column "unitipryce" does not exist
  LINE 16:     unitipryce
               ^
  HINT:  Perhaps you meant to reference the column "salesorderdetail.unitprice".
  compiled Code at target/run/dbt_tutorial/models/teste/staging/stg_sales_order_detail.sql
[0m16:50:31.936676 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a46dbba-5ea8-4af4-aa0f-d43582dbe938', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dd73eec0>]}
[0m16:50:31.937410 [error] [Thread-3 (]: 3 of 5 ERROR creating sql table model teste.stg_sales_order_detail ............. [[31mERROR[0m in 0.15s]
[0m16:50:31.938142 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m16:50:31.939284 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m16:50:31.939945 [info ] [Thread-4 (]: 4 of 5 SKIP relation teste.int_sales_by_product ................................ [[33mSKIP[0m]
[0m16:50:31.940714 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m16:50:31.941778 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m16:50:31.942386 [info ] [Thread-1 (]: 5 of 5 SKIP relation teste.mart_sales_by_category .............................. [[33mSKIP[0m]
[0m16:50:31.943055 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m16:50:31.944923 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:31.945505 [debug] [MainThread]: On master: BEGIN
[0m16:50:31.946007 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:31.951240 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:50:31.951850 [debug] [MainThread]: On master: COMMIT
[0m16:50:31.952354 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:31.952826 [debug] [MainThread]: On master: COMMIT
[0m16:50:31.953737 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:50:31.954394 [debug] [MainThread]: On master: Close
[0m16:50:31.955413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:31.956161 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product' was properly closed.
[0m16:50:31.956691 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product_category' was properly closed.
[0m16:50:31.957301 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_sales_order_detail' was properly closed.
[0m16:50:31.957856 [info ] [MainThread]: 
[0m16:50:31.958482 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m16:50:31.959535 [debug] [MainThread]: Command end result
[0m16:50:31.968493 [info ] [MainThread]: 
[0m16:50:31.969370 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:50:31.970001 [info ] [MainThread]: 
[0m16:50:31.970904 [error] [MainThread]: [33mDatabase Error in model stg_sales_order_detail (models/teste/staging/stg_sales_order_detail.sql)[0m
[0m16:50:31.971664 [error] [MainThread]:   column "unitipryce" does not exist
[0m16:50:31.972327 [error] [MainThread]:   LINE 16:     unitipryce
[0m16:50:31.973053 [error] [MainThread]:                ^
[0m16:50:31.973819 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "salesorderdetail.unitprice".
[0m16:50:31.974448 [error] [MainThread]:   compiled Code at target/run/dbt_tutorial/models/teste/staging/stg_sales_order_detail.sql
[0m16:50:31.975222 [info ] [MainThread]: 
[0m16:50:31.976158 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m16:50:31.976992 [debug] [MainThread]: Command `dbt run` failed at 16:50:31.976896 after 1.81 seconds
[0m16:50:31.977640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dfc21a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ddb5d9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0dd747d60>]}
[0m16:50:31.978229 [debug] [MainThread]: Flushing usage events
[0m16:52:09.249934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900ed75a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900da95c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900da95c30>]}


============================== 16:52:09.255889 | 4f38af18-39d2-4b0d-8cc8-ea1d67a07636 ==============================
[0m16:52:09.255889 [info ] [MainThread]: Running with dbt=1.5.11
[0m16:52:09.256715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:52:09.528812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f38af18-39d2-4b0d-8cc8-ea1d67a07636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900da95db0>]}
[0m16:52:09.544737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f38af18-39d2-4b0d-8cc8-ea1d67a07636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900d9908b0>]}
[0m16:52:09.550806 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m16:52:09.573209 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m16:52:10.655463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:52:10.656271 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_sales_order_detail.sql
[0m16:52:10.656906 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/int/int_sales_by_product.sql
[0m16:52:10.680902 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_order_detail.sql
[0m16:52:10.691292 [debug] [MainThread]: 1699: static parser successfully parsed int/int_sales_by_product.sql
[0m16:52:10.703156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f38af18-39d2-4b0d-8cc8-ea1d67a07636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900c935510>]}
[0m16:52:10.712953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f38af18-39d2-4b0d-8cc8-ea1d67a07636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900e1b2680>]}
[0m16:52:10.713725 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m16:52:10.714400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f38af18-39d2-4b0d-8cc8-ea1d67a07636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900e452740>]}
[0m16:52:10.715867 [info ] [MainThread]: 
[0m16:52:10.716934 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:10.718314 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m16:52:10.726707 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m16:52:10.727602 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m16:52:10.728211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:10.787876 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m16:52:10.789363 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m16:52:10.790976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now list_Adventureworks_teste)
[0m16:52:10.795549 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m16:52:10.796263 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m16:52:10.796848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:10.801801 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:52:10.802390 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m16:52:10.802937 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m16:52:10.805495 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:52:10.807003 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m16:52:10.807753 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m16:52:10.811787 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:10.812442 [debug] [MainThread]: On master: BEGIN
[0m16:52:10.812985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:10.817871 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:52:10.818423 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:10.819054 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:52:10.823706 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m16:52:10.827198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f38af18-39d2-4b0d-8cc8-ea1d67a07636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900cdf99c0>]}
[0m16:52:10.827911 [debug] [MainThread]: On master: ROLLBACK
[0m16:52:10.828717 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:10.829244 [debug] [MainThread]: On master: BEGIN
[0m16:52:10.830139 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:52:10.830662 [debug] [MainThread]: On master: COMMIT
[0m16:52:10.831195 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:10.831672 [debug] [MainThread]: On master: COMMIT
[0m16:52:10.832363 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:52:10.832882 [debug] [MainThread]: On master: Close
[0m16:52:10.833662 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:52:10.834310 [info ] [MainThread]: 
[0m16:52:10.838281 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m16:52:10.838607 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.stg_product_category
[0m16:52:10.838914 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m16:52:10.839511 [info ] [Thread-1 (]: 1 of 5 START sql table model teste.stg_product ................................. [RUN]
[0m16:52:10.840278 [info ] [Thread-2 (]: 2 of 5 START sql table model teste.stg_product_category ........................ [RUN]
[0m16:52:10.841015 [info ] [Thread-3 (]: 3 of 5 START sql table model teste.stg_sales_order_detail ...................... [RUN]
[0m16:52:10.841880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m16:52:10.842705 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_product_category'
[0m16:52:10.843567 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_sales_order_detail'
[0m16:52:10.844146 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m16:52:10.844820 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m16:52:10.845413 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m16:52:10.851995 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m16:52:10.854630 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m16:52:10.856899 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m16:52:10.860967 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 16:52:10.846171 => 16:52:10.860739
[0m16:52:10.861345 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 16:52:10.855287 => 16:52:10.861187
[0m16:52:10.861954 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_product
[0m16:52:10.862638 [debug] [Thread-3 (]: Began executing node model.dbt_tutorial.stg_sales_order_detail
[0m16:52:10.863012 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 16:52:10.852453 => 16:52:10.862853
[0m16:52:10.898000 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_tutorial.stg_sales_order_detail"
[0m16:52:10.898624 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product"
[0m16:52:10.899213 [debug] [Thread-2 (]: Began executing node model.dbt_tutorial.stg_product_category
[0m16:52:10.903708 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product_category"
[0m16:52:10.907103 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:52:10.907418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:52:10.908036 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: BEGIN
[0m16:52:10.908334 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:52:10.908880 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: BEGIN
[0m16:52:10.909529 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:52:10.910125 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: BEGIN
[0m16:52:10.910698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:10.912250 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:52:10.916242 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:10.917027 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:52:10.917871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:10.918170 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */

  
    

  create  table "Adventureworks"."teste"."stg_sales_order_detail__dbt_tmp"
  
  
    as
  
  (
    SELECT
    SalesOrderID,
    ProductID,
    OrderQty,
    unitiprice
FROM
    "Adventureworks"."sales"."salesorderdetail"
  );
  
[0m16:52:10.918465 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:10.919060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:52:10.920082 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:52:10.920400 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "unitiprice" does not exist
LINE 16:     unitiprice
             ^
HINT:  Perhaps you meant to reference the column "salesorderdetail.unitprice".

[0m16:52:10.920959 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */

  
    

  create  table "Adventureworks"."teste"."stg_product__dbt_tmp"
  
  
    as
  
  (
    SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
  );
  
[0m16:52:10.921562 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */

  
    

  create  table "Adventureworks"."teste"."stg_product_category__dbt_tmp"
  
  
    as
  
  (
    SELECT
    ProductCategoryID,
    Name AS CategoryName
FROM
    "Adventureworks"."production"."productcategory"
  );
  
[0m16:52:10.922205 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: ROLLBACK
[0m16:52:10.923937 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (execute): 16:52:10.889516 => 16:52:10.923743
[0m16:52:10.924468 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: Close
[0m16:52:10.924793 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.0 seconds
[0m16:52:10.925103 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.0 seconds
[0m16:52:10.930742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:52:10.933410 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:52:10.934637 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
alter table "Adventureworks"."teste"."stg_product" rename to "stg_product__dbt_backup"
[0m16:52:10.935331 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
alter table "Adventureworks"."teste"."stg_product_category" rename to "stg_product_category__dbt_backup"
[0m16:52:10.936503 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:10.936883 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:10.939278 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:52:10.941648 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:52:10.942446 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
alter table "Adventureworks"."teste"."stg_product__dbt_tmp" rename to "stg_product"
[0m16:52:10.943183 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
alter table "Adventureworks"."teste"."stg_product_category__dbt_tmp" rename to "stg_product_category"
[0m16:52:10.944220 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:10.944850 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:10.960788 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m16:52:10.962698 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m16:52:10.963495 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:52:10.964178 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:52:10.964912 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m16:52:10.965548 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m16:52:10.969662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:10.974067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:52:10.974379 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:10.974969 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
drop table if exists "Adventureworks"."teste"."stg_product__dbt_backup" cascade
[0m16:52:10.977215 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:52:10.978416 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
drop table if exists "Adventureworks"."teste"."stg_product_category__dbt_backup" cascade
[0m16:52:10.981860 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:10.983520 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (execute): 16:52:10.863427 => 16:52:10.983372
[0m16:52:10.984224 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: Close
[0m16:52:10.984565 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:10.985492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f38af18-39d2-4b0d-8cc8-ea1d67a07636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900e438580>]}
[0m16:52:10.986867 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (execute): 16:52:10.900702 => 16:52:10.986672
[0m16:52:10.987797 [info ] [Thread-1 (]: 1 of 5 OK created sql table model teste.stg_product ............................ [[32mSELECT 504[0m in 0.14s]
[0m16:52:10.988484 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: Close
[0m16:52:10.989404 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m16:52:10.990289 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f38af18-39d2-4b0d-8cc8-ea1d67a07636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900c919f00>]}
[0m16:52:10.991528 [info ] [Thread-2 (]: 2 of 5 OK created sql table model teste.stg_product_category ................... [[32mSELECT 4[0m in 0.15s]
[0m16:52:10.992355 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m16:52:10.992847 [debug] [Thread-3 (]: Database Error in model stg_sales_order_detail (models/teste/staging/stg_sales_order_detail.sql)
  column "unitiprice" does not exist
  LINE 16:     unitiprice
               ^
  HINT:  Perhaps you meant to reference the column "salesorderdetail.unitprice".
  compiled Code at target/run/dbt_tutorial/models/teste/staging/stg_sales_order_detail.sql
[0m16:52:10.993827 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f38af18-39d2-4b0d-8cc8-ea1d67a07636', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900e93c8e0>]}
[0m16:52:10.994591 [error] [Thread-3 (]: 3 of 5 ERROR creating sql table model teste.stg_sales_order_detail ............. [[31mERROR[0m in 0.15s]
[0m16:52:10.995299 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m16:52:10.996502 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m16:52:10.997133 [info ] [Thread-4 (]: 4 of 5 SKIP relation teste.int_sales_by_product ................................ [[33mSKIP[0m]
[0m16:52:10.997836 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m16:52:10.998838 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m16:52:10.999429 [info ] [Thread-2 (]: 5 of 5 SKIP relation teste.mart_sales_by_category .............................. [[33mSKIP[0m]
[0m16:52:11.000090 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m16:52:11.002504 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:11.003182 [debug] [MainThread]: On master: BEGIN
[0m16:52:11.003753 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:52:11.009536 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:52:11.010437 [debug] [MainThread]: On master: COMMIT
[0m16:52:11.010992 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:11.011517 [debug] [MainThread]: On master: COMMIT
[0m16:52:11.012214 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:52:11.012747 [debug] [MainThread]: On master: Close
[0m16:52:11.013523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:11.014027 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product' was properly closed.
[0m16:52:11.014502 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product_category' was properly closed.
[0m16:52:11.015079 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_sales_order_detail' was properly closed.
[0m16:52:11.015606 [info ] [MainThread]: 
[0m16:52:11.016333 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m16:52:11.017393 [debug] [MainThread]: Command end result
[0m16:52:11.027296 [info ] [MainThread]: 
[0m16:52:11.028229 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:52:11.028997 [info ] [MainThread]: 
[0m16:52:11.029621 [error] [MainThread]: [33mDatabase Error in model stg_sales_order_detail (models/teste/staging/stg_sales_order_detail.sql)[0m
[0m16:52:11.030416 [error] [MainThread]:   column "unitiprice" does not exist
[0m16:52:11.031177 [error] [MainThread]:   LINE 16:     unitiprice
[0m16:52:11.031818 [error] [MainThread]:                ^
[0m16:52:11.032397 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "salesorderdetail.unitprice".
[0m16:52:11.033094 [error] [MainThread]:   compiled Code at target/run/dbt_tutorial/models/teste/staging/stg_sales_order_detail.sql
[0m16:52:11.033740 [info ] [MainThread]: 
[0m16:52:11.034425 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m16:52:11.035290 [debug] [MainThread]: Command `dbt run` failed at 16:52:11.035197 after 1.80 seconds
[0m16:52:11.035946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900ed75a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900e1b2680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f900d915de0>]}
[0m16:52:11.036600 [debug] [MainThread]: Flushing usage events
[0m16:52:40.425469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1633ddda20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1632909c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1632909c60>]}


============================== 16:52:40.431227 | 7771ea65-df3d-4ab0-a67e-fc1283a4882d ==============================
[0m16:52:40.431227 [info ] [MainThread]: Running with dbt=1.5.11
[0m16:52:40.431917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'fail_fast': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:52:40.686192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7771ea65-df3d-4ab0-a67e-fc1283a4882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1632909de0>]}
[0m16:52:40.702126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7771ea65-df3d-4ab0-a67e-fc1283a4882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1631d048b0>]}
[0m16:52:40.708019 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m16:52:40.729219 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m16:52:41.785350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:52:41.786227 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_sales_order_detail.sql
[0m16:52:41.786899 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/int/int_sales_by_product.sql
[0m16:52:41.810889 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_order_detail.sql
[0m16:52:41.821486 [debug] [MainThread]: 1699: static parser successfully parsed int/int_sales_by_product.sql
[0m16:52:41.832820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7771ea65-df3d-4ab0-a67e-fc1283a4882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16319a6f80>]}
[0m16:52:41.842415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7771ea65-df3d-4ab0-a67e-fc1283a4882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163384df90>]}
[0m16:52:41.843215 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m16:52:41.843878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7771ea65-df3d-4ab0-a67e-fc1283a4882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16334de770>]}
[0m16:52:41.845310 [info ] [MainThread]: 
[0m16:52:41.846252 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:41.847641 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m16:52:41.856154 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m16:52:41.857011 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m16:52:41.857730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:41.912023 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m16:52:41.913750 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m16:52:41.915529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now list_Adventureworks_teste)
[0m16:52:41.920442 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m16:52:41.921064 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m16:52:41.921690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:41.926993 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:52:41.927839 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m16:52:41.928463 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m16:52:41.931068 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:52:41.932367 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m16:52:41.933170 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m16:52:41.937354 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:41.938039 [debug] [MainThread]: On master: BEGIN
[0m16:52:41.938626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:41.943591 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:52:41.944205 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:41.944845 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:52:41.949523 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m16:52:41.952811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7771ea65-df3d-4ab0-a67e-fc1283a4882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163196da20>]}
[0m16:52:41.953507 [debug] [MainThread]: On master: ROLLBACK
[0m16:52:41.954251 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:41.954770 [debug] [MainThread]: On master: BEGIN
[0m16:52:41.955648 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:52:41.956180 [debug] [MainThread]: On master: COMMIT
[0m16:52:41.956733 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:41.957225 [debug] [MainThread]: On master: COMMIT
[0m16:52:41.957917 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:52:41.958459 [debug] [MainThread]: On master: Close
[0m16:52:41.959248 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:52:41.959914 [info ] [MainThread]: 
[0m16:52:41.963586 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m16:52:41.963908 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.stg_product_category
[0m16:52:41.964216 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m16:52:41.964829 [info ] [Thread-1 (]: 1 of 5 START sql table model teste.stg_product ................................. [RUN]
[0m16:52:41.965575 [info ] [Thread-2 (]: 2 of 5 START sql table model teste.stg_product_category ........................ [RUN]
[0m16:52:41.966422 [info ] [Thread-3 (]: 3 of 5 START sql table model teste.stg_sales_order_detail ...................... [RUN]
[0m16:52:41.967321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m16:52:41.968173 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_product_category'
[0m16:52:41.969053 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_sales_order_detail'
[0m16:52:41.969729 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m16:52:41.970347 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m16:52:41.971165 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m16:52:41.977858 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m16:52:41.980555 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m16:52:41.982672 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m16:52:41.986703 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 16:52:41.981192 => 16:52:41.986519
[0m16:52:41.987063 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 16:52:41.978378 => 16:52:41.986909
[0m16:52:41.987945 [debug] [Thread-3 (]: Began executing node model.dbt_tutorial.stg_sales_order_detail
[0m16:52:41.988867 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 16:52:41.971907 => 16:52:41.988602
[0m16:52:41.989265 [debug] [Thread-2 (]: Began executing node model.dbt_tutorial.stg_product_category
[0m16:52:42.016410 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_product
[0m16:52:42.021012 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_tutorial.stg_sales_order_detail"
[0m16:52:42.024844 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product_category"
[0m16:52:42.028212 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product"
[0m16:52:42.032223 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:52:42.032529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:52:42.033239 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: BEGIN
[0m16:52:42.033753 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:52:42.034290 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: BEGIN
[0m16:52:42.034891 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:52:42.035458 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: BEGIN
[0m16:52:42.036008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:42.037167 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:52:42.042002 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:42.042950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:42.043319 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:52:42.043664 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:42.044277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:52:42.044891 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */

  
    

  create  table "Adventureworks"."teste"."stg_sales_order_detail__dbt_tmp"
  
  
    as
  
  (
    SELECT
    SalesOrderID,
    ProductID,
    OrderQty,
    unitprice
FROM
    "Adventureworks"."sales"."salesorderdetail"
  );
  
[0m16:52:42.045480 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:52:42.046046 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */

  
    

  create  table "Adventureworks"."teste"."stg_product__dbt_tmp"
  
  
    as
  
  (
    SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
  );
  
[0m16:52:42.047122 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */

  
    

  create  table "Adventureworks"."teste"."stg_product_category__dbt_tmp"
  
  
    as
  
  (
    SELECT
    ProductCategoryID,
    Name AS CategoryName
FROM
    "Adventureworks"."production"."productcategory"
  );
  
[0m16:52:42.049634 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.0 seconds
[0m16:52:42.049927 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.0 seconds
[0m16:52:42.055035 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:52:42.058223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:52:42.058978 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
alter table "Adventureworks"."teste"."stg_product_category" rename to "stg_product_category__dbt_backup"
[0m16:52:42.059645 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
alter table "Adventureworks"."teste"."stg_product" rename to "stg_product__dbt_backup"
[0m16:52:42.060755 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:42.061053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:42.063314 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:52:42.065684 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:52:42.066357 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
alter table "Adventureworks"."teste"."stg_product_category__dbt_tmp" rename to "stg_product_category"
[0m16:52:42.066994 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
alter table "Adventureworks"."teste"."stg_product__dbt_tmp" rename to "stg_product"
[0m16:52:42.068072 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:42.068387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:42.084431 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m16:52:42.086454 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m16:52:42.087075 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:52:42.087770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:52:42.088341 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m16:52:42.088939 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m16:52:42.106690 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:42.111122 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m16:52:42.111440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:42.112019 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
drop table if exists "Adventureworks"."teste"."stg_product_category__dbt_backup" cascade
[0m16:52:42.114175 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m16:52:42.115197 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
drop table if exists "Adventureworks"."teste"."stg_product__dbt_backup" cascade
[0m16:52:42.120609 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:42.122434 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (execute): 16:52:42.021772 => 16:52:42.122244
[0m16:52:42.123076 [debug] [Thread-2 (]: On model.dbt_tutorial.stg_product_category: Close
[0m16:52:42.123962 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7771ea65-df3d-4ab0-a67e-fc1283a4882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16334c45e0>]}
[0m16:52:42.124262 [debug] [Thread-3 (]: SQL status: SELECT 121317 in 0.0 seconds
[0m16:52:42.124561 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:42.125232 [info ] [Thread-2 (]: 2 of 5 OK created sql table model teste.stg_product_category ................... [[32mSELECT 4[0m in 0.16s]
[0m16:52:42.127977 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:52:42.129335 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (execute): 16:52:42.025496 => 16:52:42.129194
[0m16:52:42.130078 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m16:52:42.130667 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */
alter table "Adventureworks"."teste"."stg_sales_order_detail" rename to "stg_sales_order_detail__dbt_backup"
[0m16:52:42.131257 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: Close
[0m16:52:42.133037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7771ea65-df3d-4ab0-a67e-fc1283a4882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163150c100>]}
[0m16:52:42.133331 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:42.134051 [info ] [Thread-1 (]: 1 of 5 OK created sql table model teste.stg_product ............................ [[32mSELECT 504[0m in 0.17s]
[0m16:52:42.136778 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:52:42.137985 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m16:52:42.138862 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */
alter table "Adventureworks"."teste"."stg_sales_order_detail__dbt_tmp" rename to "stg_sales_order_detail"
[0m16:52:42.140481 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:42.142474 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: COMMIT
[0m16:52:42.143039 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:52:42.143582 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: COMMIT
[0m16:52:42.148119 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:42.150357 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m16:52:42.150973 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */
drop table if exists "Adventureworks"."teste"."stg_sales_order_detail__dbt_backup" cascade
[0m16:52:42.156277 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:42.157973 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (execute): 16:52:41.989977 => 16:52:42.157822
[0m16:52:42.158595 [debug] [Thread-3 (]: On model.dbt_tutorial.stg_sales_order_detail: Close
[0m16:52:42.159430 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7771ea65-df3d-4ab0-a67e-fc1283a4882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16334c4610>]}
[0m16:52:42.160159 [info ] [Thread-3 (]: 3 of 5 OK created sql table model teste.stg_sales_order_detail ................. [[32mSELECT 121317[0m in 0.19s]
[0m16:52:42.160992 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m16:52:42.162117 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m16:52:42.162745 [info ] [Thread-4 (]: 4 of 5 START sql table model teste.int_sales_by_product ........................ [RUN]
[0m16:52:42.163670 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_tutorial.int_sales_by_product'
[0m16:52:42.164214 [debug] [Thread-4 (]: Began compiling node model.dbt_tutorial.int_sales_by_product
[0m16:52:42.166799 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_tutorial.int_sales_by_product"
[0m16:52:42.173426 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.int_sales_by_product (compile): 16:52:42.164650 => 16:52:42.172941
[0m16:52:42.174189 [debug] [Thread-4 (]: Began executing node model.dbt_tutorial.int_sales_by_product
[0m16:52:42.179414 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_tutorial.int_sales_by_product"
[0m16:52:42.184964 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m16:52:42.185624 [debug] [Thread-4 (]: On model.dbt_tutorial.int_sales_by_product: BEGIN
[0m16:52:42.186335 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:52:42.192797 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:42.193749 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m16:52:42.194419 [debug] [Thread-4 (]: On model.dbt_tutorial.int_sales_by_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.int_sales_by_product"} */

  
    

  create  table "Adventureworks"."teste"."int_sales_by_product__dbt_tmp"
  
  
    as
  
  (
    WITH sales AS (
    SELECT
        sod.ProductID,
        SUM(sod.unitprice) AS TotalSales
    FROM "Adventureworks"."teste"."stg_sales_order_detail" sod
    GROUP BY sod.ProductID
)
SELECT 
    s.ProductID,
    s.TotalSales,
    p.ProductSubcategoryID
FROM sales s
JOIN "Adventureworks"."teste"."stg_product" p ON s.ProductID = p.ProductID
  );
  
[0m16:52:42.221674 [debug] [Thread-4 (]: SQL status: SELECT 266 in 0.0 seconds
[0m16:52:42.224585 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m16:52:42.225175 [debug] [Thread-4 (]: On model.dbt_tutorial.int_sales_by_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.int_sales_by_product"} */
alter table "Adventureworks"."teste"."int_sales_by_product__dbt_tmp" rename to "int_sales_by_product"
[0m16:52:42.226187 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:42.227805 [debug] [Thread-4 (]: On model.dbt_tutorial.int_sales_by_product: COMMIT
[0m16:52:42.228325 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m16:52:42.228842 [debug] [Thread-4 (]: On model.dbt_tutorial.int_sales_by_product: COMMIT
[0m16:52:42.232488 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:42.234532 [debug] [Thread-4 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m16:52:42.235118 [debug] [Thread-4 (]: On model.dbt_tutorial.int_sales_by_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.int_sales_by_product"} */
drop table if exists "Adventureworks"."teste"."int_sales_by_product__dbt_backup" cascade
[0m16:52:42.235953 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:42.237229 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.int_sales_by_product (execute): 16:52:42.174902 => 16:52:42.237084
[0m16:52:42.237806 [debug] [Thread-4 (]: On model.dbt_tutorial.int_sales_by_product: Close
[0m16:52:42.238652 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7771ea65-df3d-4ab0-a67e-fc1283a4882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1631103490>]}
[0m16:52:42.239448 [info ] [Thread-4 (]: 4 of 5 OK created sql table model teste.int_sales_by_product ................... [[32mSELECT 266[0m in 0.08s]
[0m16:52:42.240431 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m16:52:42.241574 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m16:52:42.242200 [info ] [Thread-1 (]: 5 of 5 START sql table model teste.mart_sales_by_category ...................... [RUN]
[0m16:52:42.242985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product, now model.dbt_tutorial.mart_sales_by_category)
[0m16:52:42.243524 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.mart_sales_by_category
[0m16:52:42.246021 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.mart_sales_by_category"
[0m16:52:42.251309 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (compile): 16:52:42.243962 => 16:52:42.251055
[0m16:52:42.251952 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.mart_sales_by_category
[0m16:52:42.255314 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.mart_sales_by_category"
[0m16:52:42.263389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m16:52:42.264026 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: BEGIN
[0m16:52:42.264565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:42.269977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:52:42.270694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m16:52:42.271404 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */

  
    

  create  table "Adventureworks"."teste"."mart_sales_by_category__dbt_tmp"
  
  
    as
  
  (
    WITH category_sales AS (
    SELECT
        pc.CategoryName,
        SUM(sp.TotalSales) AS TotalSales
    FROM "Adventureworks"."teste"."int_sales_by_product" sp
    JOIN "Adventureworks"."teste"."stg_product_category" pc 
        ON sp.ProductSubcategoryID = pc.ProductCategoryID
    GROUP BY pc.CategoryName
)
SELECT * FROM category_sales
  );
  
[0m16:52:42.274397 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.0 seconds
[0m16:52:42.277195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m16:52:42.277903 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
alter table "Adventureworks"."teste"."mart_sales_by_category__dbt_tmp" rename to "mart_sales_by_category"
[0m16:52:42.278824 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:52:42.280526 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: COMMIT
[0m16:52:42.281069 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m16:52:42.281620 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: COMMIT
[0m16:52:42.285132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:52:42.287145 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m16:52:42.287765 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
drop table if exists "Adventureworks"."teste"."mart_sales_by_category__dbt_backup" cascade
[0m16:52:42.288627 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m16:52:42.289928 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (execute): 16:52:42.252398 => 16:52:42.289786
[0m16:52:42.290454 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: Close
[0m16:52:42.291245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7771ea65-df3d-4ab0-a67e-fc1283a4882d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f163150d510>]}
[0m16:52:42.291936 [info ] [Thread-1 (]: 5 of 5 OK created sql table model teste.mart_sales_by_category ................. [[32mSELECT 4[0m in 0.05s]
[0m16:52:42.292767 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m16:52:42.294417 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:42.294957 [debug] [MainThread]: On master: BEGIN
[0m16:52:42.295440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:52:42.300989 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:52:42.301771 [debug] [MainThread]: On master: COMMIT
[0m16:52:42.302320 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:42.302835 [debug] [MainThread]: On master: COMMIT
[0m16:52:42.303487 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:52:42.304022 [debug] [MainThread]: On master: Close
[0m16:52:42.304868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:42.305340 [debug] [MainThread]: Connection 'model.dbt_tutorial.mart_sales_by_category' was properly closed.
[0m16:52:42.305909 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product_category' was properly closed.
[0m16:52:42.306537 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_sales_order_detail' was properly closed.
[0m16:52:42.307039 [debug] [MainThread]: Connection 'model.dbt_tutorial.int_sales_by_product' was properly closed.
[0m16:52:42.307612 [info ] [MainThread]: 
[0m16:52:42.308290 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m16:52:42.309945 [debug] [MainThread]: Command end result
[0m16:52:42.318980 [info ] [MainThread]: 
[0m16:52:42.319717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:52:42.320312 [info ] [MainThread]: 
[0m16:52:42.321224 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:52:42.322042 [debug] [MainThread]: Command `dbt run` succeeded at 16:52:42.321952 after 1.91 seconds
[0m16:52:42.322724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1633ddda20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16334de7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1635ee02b0>]}
[0m16:52:42.323486 [debug] [MainThread]: Flushing usage events
[0m17:13:01.366728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27283b9a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2726f01c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2726f01c00>]}


============================== 17:13:01.372978 | 50f53988-235f-4670-aa5e-609c30042ef7 ==============================
[0m17:13:01.372978 [info ] [MainThread]: Running with dbt=1.5.11
[0m17:13:01.373686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:13:01.658199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50f53988-235f-4670-aa5e-609c30042ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2726f01d80>]}
[0m17:13:01.674489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50f53988-235f-4670-aa5e-609c30042ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2726ffc8b0>]}
[0m17:13:01.681189 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m17:13:01.703604 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m17:13:02.847380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m17:13:02.848220 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/mart/mart_sales_by_category.sql
[0m17:13:02.848838 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/int/int_sales_by_product.sql
[0m17:13:02.849418 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product_category.sql
[0m17:13:02.850007 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_sales_order_detail.sql
[0m17:13:02.850563 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product.sql
[0m17:13:02.877428 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_sales_by_category.sql
[0m17:13:02.888542 [debug] [MainThread]: 1699: static parser successfully parsed int/int_sales_by_product.sql
[0m17:13:02.892004 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_product_category.sql
[0m17:13:02.895906 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_order_detail.sql
[0m17:13:02.899234 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_product.sql
[0m17:13:02.911789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50f53988-235f-4670-aa5e-609c30042ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2725fa1360>]}
[0m17:13:02.922819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50f53988-235f-4670-aa5e-609c30042ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2728051030>]}
[0m17:13:02.923604 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:13:02.924389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50f53988-235f-4670-aa5e-609c30042ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2727aba740>]}
[0m17:13:02.926102 [info ] [MainThread]: 
[0m17:13:02.927319 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:13:02.928946 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m17:13:02.938571 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m17:13:02.939357 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m17:13:02.939889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:02.997743 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m17:13:02.999258 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m17:13:03.000430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now create_Adventureworks_teste)
[0m17:13:03.001196 [debug] [ThreadPool]: Creating schema "database: "Adventureworks"
schema: "teste"
"
[0m17:13:03.005477 [debug] [ThreadPool]: Using postgres connection "create_Adventureworks_teste"
[0m17:13:03.006092 [debug] [ThreadPool]: On create_Adventureworks_teste: BEGIN
[0m17:13:03.006689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:03.012762 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:13:03.013650 [debug] [ThreadPool]: Using postgres connection "create_Adventureworks_teste"
[0m17:13:03.014173 [debug] [ThreadPool]: On create_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "create_Adventureworks_teste"} */
create schema if not exists "teste"
[0m17:13:03.015129 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m17:13:03.016218 [debug] [ThreadPool]: On create_Adventureworks_teste: COMMIT
[0m17:13:03.016757 [debug] [ThreadPool]: Using postgres connection "create_Adventureworks_teste"
[0m17:13:03.017431 [debug] [ThreadPool]: On create_Adventureworks_teste: COMMIT
[0m17:13:03.021127 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m17:13:03.021776 [debug] [ThreadPool]: On create_Adventureworks_teste: Close
[0m17:13:03.023369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_Adventureworks_teste, now list_Adventureworks_teste)
[0m17:13:03.028230 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:13:03.028994 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m17:13:03.029545 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:13:03.034667 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:13:03.035219 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:13:03.035754 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m17:13:03.038248 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:13:03.039548 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m17:13:03.040271 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m17:13:03.044111 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:03.044939 [debug] [MainThread]: On master: BEGIN
[0m17:13:03.045519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:13:03.050820 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:13:03.051437 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:03.052006 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:13:03.056706 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m17:13:03.060356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50f53988-235f-4670-aa5e-609c30042ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2725f654e0>]}
[0m17:13:03.061152 [debug] [MainThread]: On master: ROLLBACK
[0m17:13:03.062008 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:03.062522 [debug] [MainThread]: On master: BEGIN
[0m17:13:03.063431 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:13:03.063958 [debug] [MainThread]: On master: COMMIT
[0m17:13:03.064443 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:03.064913 [debug] [MainThread]: On master: COMMIT
[0m17:13:03.065652 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:13:03.066220 [debug] [MainThread]: On master: Close
[0m17:13:03.067044 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:13:03.067653 [info ] [MainThread]: 
[0m17:13:03.072825 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m17:13:03.073257 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.stg_product_category
[0m17:13:03.073575 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m17:13:03.074378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m17:13:03.075375 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_product_category'
[0m17:13:03.076719 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_sales_order_detail'
[0m17:13:03.077569 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m17:13:03.078338 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m17:13:03.079070 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m17:13:03.086215 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m17:13:03.088489 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m17:13:03.090761 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m17:13:03.095140 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 17:13:03.089066 => 17:13:03.094851
[0m17:13:03.095556 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 17:13:03.079606 => 17:13:03.095401
[0m17:13:03.096923 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m17:13:03.097318 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 17:13:03.086754 => 17:13:03.097157
[0m17:13:03.098475 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m17:13:03.099968 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m17:13:03.100949 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m17:13:03.102304 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_tutorial.int_sales_by_product'
[0m17:13:03.103009 [debug] [Thread-4 (]: Began compiling node model.dbt_tutorial.int_sales_by_product
[0m17:13:03.108380 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_tutorial.int_sales_by_product"
[0m17:13:03.114618 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.int_sales_by_product (compile): 17:13:03.103489 => 17:13:03.114297
[0m17:13:03.116002 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m17:13:03.117446 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m17:13:03.118492 [info ] [Thread-1 (]: 1 of 1 START sql table model teste.mart_sales_by_category ...................... [RUN]
[0m17:13:03.119997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product, now model.dbt_tutorial.mart_sales_by_category)
[0m17:13:03.120928 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.mart_sales_by_category
[0m17:13:03.126449 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.mart_sales_by_category"
[0m17:13:03.133644 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (compile): 17:13:03.121749 => 17:13:03.133316
[0m17:13:03.134354 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.mart_sales_by_category
[0m17:13:03.166093 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.mart_sales_by_category"
[0m17:13:03.171817 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:13:03.172422 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: BEGIN
[0m17:13:03.172994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:03.179201 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:13:03.180189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:13:03.180891 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */

  
    

  create  table "Adventureworks"."teste"."mart_sales_by_category__dbt_tmp"
  
  
    as
  
  (
    

WITH  __dbt__cte__stg_sales_order_detail as (


SELECT
    SalesOrderID,
    ProductID,
    OrderQty,
    unitprice
FROM
    "Adventureworks"."sales"."salesorderdetail"
),  __dbt__cte__stg_product as (


SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
),  __dbt__cte__int_sales_by_product as (


WITH sales AS (
    SELECT
        sod.ProductID,
        SUM(sod.unitprice) AS TotalSales
    FROM __dbt__cte__stg_sales_order_detail sod
    GROUP BY sod.ProductID
)
SELECT 
    s.ProductID,
    s.TotalSales,
    p.ProductSubcategoryID
FROM sales s
JOIN __dbt__cte__stg_product p ON s.ProductID = p.ProductID
),  __dbt__cte__stg_product_category as (


SELECT
    ProductCategoryID,
    Name AS CategoryName
FROM
    "Adventureworks"."production"."productcategory"
),category_sales AS (
    SELECT
        pc.CategoryName,
        SUM(sp.TotalSales) AS TotalSales
    FROM __dbt__cte__int_sales_by_product sp
    JOIN __dbt__cte__stg_product_category pc 
        ON sp.ProductSubcategoryID = pc.ProductCategoryID
    GROUP BY pc.CategoryName
)
SELECT * FROM category_sales
  );
  
[0m17:13:03.215133 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.0 seconds
[0m17:13:03.221402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:13:03.222091 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
alter table "Adventureworks"."teste"."mart_sales_by_category__dbt_tmp" rename to "mart_sales_by_category"
[0m17:13:03.223166 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:13:03.237361 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: COMMIT
[0m17:13:03.238163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:13:03.238749 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: COMMIT
[0m17:13:03.242446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:13:03.246726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:13:03.247326 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
drop table if exists "Adventureworks"."teste"."mart_sales_by_category__dbt_backup" cascade
[0m17:13:03.248362 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:13:03.249768 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (execute): 17:13:03.134912 => 17:13:03.249619
[0m17:13:03.250324 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: Close
[0m17:13:03.251146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50f53988-235f-4670-aa5e-609c30042ef7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2725b6ead0>]}
[0m17:13:03.251870 [info ] [Thread-1 (]: 1 of 1 OK created sql table model teste.mart_sales_by_category ................. [[32mSELECT 4[0m in 0.13s]
[0m17:13:03.252708 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m17:13:03.254354 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:03.254910 [debug] [MainThread]: On master: BEGIN
[0m17:13:03.255405 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:13:03.260621 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:13:03.261346 [debug] [MainThread]: On master: COMMIT
[0m17:13:03.261900 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:03.262444 [debug] [MainThread]: On master: COMMIT
[0m17:13:03.263167 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:13:03.263750 [debug] [MainThread]: On master: Close
[0m17:13:03.264628 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:03.265187 [debug] [MainThread]: Connection 'model.dbt_tutorial.mart_sales_by_category' was properly closed.
[0m17:13:03.265768 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product_category' was properly closed.
[0m17:13:03.266417 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_sales_order_detail' was properly closed.
[0m17:13:03.266956 [debug] [MainThread]: Connection 'model.dbt_tutorial.int_sales_by_product' was properly closed.
[0m17:13:03.267513 [info ] [MainThread]: 
[0m17:13:03.268133 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m17:13:03.268978 [debug] [MainThread]: Command end result
[0m17:13:03.279477 [info ] [MainThread]: 
[0m17:13:03.280454 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:13:03.281193 [info ] [MainThread]: 
[0m17:13:03.281904 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:13:03.282703 [debug] [MainThread]: Command `dbt run` succeeded at 17:13:03.282609 after 1.93 seconds
[0m17:13:03.283313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27283b9a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2727aba770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2725b08bb0>]}
[0m17:13:03.283932 [debug] [MainThread]: Flushing usage events
[0m17:13:48.719454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05212b1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051fe05d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051fe05d50>]}


============================== 17:13:48.725478 | 6a80d49a-868a-45e2-9b7e-f70af0e84bce ==============================
[0m17:13:48.725478 [info ] [MainThread]: Running with dbt=1.5.11
[0m17:13:48.726302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'fail_fast': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:13:48.990509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a80d49a-868a-45e2-9b7e-f70af0e84bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051fe05bd0>]}
[0m17:13:49.006797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a80d49a-868a-45e2-9b7e-f70af0e84bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051f5008b0>]}
[0m17:13:49.013359 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m17:13:49.035636 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m17:13:50.167993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:13:50.168740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:13:50.173389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a80d49a-868a-45e2-9b7e-f70af0e84bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051f1811e0>]}
[0m17:13:50.177184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a80d49a-868a-45e2-9b7e-f70af0e84bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05233c0250>]}
[0m17:13:50.177977 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:13:50.178678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a80d49a-868a-45e2-9b7e-f70af0e84bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05206abf10>]}
[0m17:13:50.180173 [info ] [MainThread]: 
[0m17:13:50.181180 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:13:50.182663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks_teste'
[0m17:13:50.191380 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:13:50.192394 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m17:13:50.193241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:50.254601 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:13:50.255469 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:13:50.256167 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m17:13:50.258789 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:13:50.260154 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m17:13:50.260946 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m17:13:50.264772 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:50.265414 [debug] [MainThread]: On master: BEGIN
[0m17:13:50.265986 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:13:50.271348 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:13:50.271960 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:50.272599 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:13:50.277523 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m17:13:50.281020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a80d49a-868a-45e2-9b7e-f70af0e84bce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051f50e020>]}
[0m17:13:50.281718 [debug] [MainThread]: On master: ROLLBACK
[0m17:13:50.282489 [debug] [MainThread]: On master: Close
[0m17:13:50.283273 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:13:50.283955 [info ] [MainThread]: 
[0m17:13:50.287925 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m17:13:50.288320 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.stg_product_category
[0m17:13:50.288658 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m17:13:50.289475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m17:13:50.290707 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_product_category'
[0m17:13:50.291636 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_sales_order_detail'
[0m17:13:50.292607 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m17:13:50.293278 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m17:13:50.293897 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m17:13:50.301007 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m17:13:50.303217 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m17:13:50.305575 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m17:13:50.310026 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 17:13:50.294459 => 17:13:50.309683
[0m17:13:50.311274 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 17:13:50.303881 => 17:13:50.310839
[0m17:13:50.312025 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m17:13:50.312420 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 17:13:50.301494 => 17:13:50.312262
[0m17:13:50.313275 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m17:13:50.314619 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m17:13:50.315538 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m17:13:50.316691 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_tutorial.int_sales_by_product'
[0m17:13:50.317263 [debug] [Thread-4 (]: Began compiling node model.dbt_tutorial.int_sales_by_product
[0m17:13:50.322597 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_tutorial.int_sales_by_product"
[0m17:13:50.328794 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.int_sales_by_product (compile): 17:13:50.317785 => 17:13:50.328487
[0m17:13:50.329922 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m17:13:50.331126 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m17:13:50.331875 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_sales_order_detail, now model.dbt_tutorial.mart_sales_by_category)
[0m17:13:50.332463 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.mart_sales_by_category
[0m17:13:50.337242 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.mart_sales_by_category"
[0m17:13:50.343019 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (compile): 17:13:50.332917 => 17:13:50.342775
[0m17:13:50.343751 [debug] [Thread-3 (]: Began executing node model.dbt_tutorial.mart_sales_by_category
[0m17:13:50.344489 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (execute): 17:13:50.344290 => 17:13:50.344303
[0m17:13:50.345574 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m17:13:50.347138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:50.347762 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product' was properly closed.
[0m17:13:50.348272 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product_category' was properly closed.
[0m17:13:50.348842 [debug] [MainThread]: Connection 'model.dbt_tutorial.mart_sales_by_category' was properly closed.
[0m17:13:50.349311 [debug] [MainThread]: Connection 'model.dbt_tutorial.int_sales_by_product' was properly closed.
[0m17:13:50.350083 [debug] [MainThread]: Command end result
[0m17:13:50.383915 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:13:50.384556 [info ] [MainThread]: Building catalog
[0m17:13:50.386435 [debug] [ThreadPool]: Acquiring new postgres connection 'Adventureworks.information_schema'
[0m17:13:50.391840 [debug] [ThreadPool]: Using postgres connection "Adventureworks.information_schema"
[0m17:13:50.392723 [debug] [ThreadPool]: On Adventureworks.information_schema: BEGIN
[0m17:13:50.393347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:50.399499 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:13:50.400538 [debug] [ThreadPool]: Using postgres connection "Adventureworks.information_schema"
[0m17:13:50.401303 [debug] [ThreadPool]: On Adventureworks.information_schema: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "Adventureworks.information_schema"} */

    
    

    select
        'Adventureworks' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('teste') or upper(sch.nspname) = upper('sales') or upper(sch.nspname) = upper('production'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:13:50.408488 [debug] [ThreadPool]: SQL status: SELECT 438 in 0.0 seconds
[0m17:13:50.421631 [debug] [ThreadPool]: On Adventureworks.information_schema: ROLLBACK
[0m17:13:50.422744 [debug] [ThreadPool]: On Adventureworks.information_schema: Close
[0m17:13:50.437070 [info ] [MainThread]: Catalog written to /mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/target/catalog.json
[0m17:13:50.438523 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:13:50.438407 after 1.73 seconds
[0m17:13:50.439202 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:13:50.439859 [debug] [MainThread]: Connection 'Adventureworks.information_schema' was properly closed.
[0m17:13:50.440572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05212b1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05233c02b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051f182500>]}
[0m17:13:50.441253 [debug] [MainThread]: Flushing usage events
[0m17:14:18.653773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5555835a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5554495ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5554495bd0>]}


============================== 17:14:18.660975 | 769dbf88-f943-45f0-ade5-61afc25a757f ==============================
[0m17:14:18.660975 [info ] [MainThread]: Running with dbt=1.5.11
[0m17:14:18.661772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:14:18.956113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '769dbf88-f943-45f0-ade5-61afc25a757f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5554495a50>]}
[0m17:14:18.972445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '769dbf88-f943-45f0-ade5-61afc25a757f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55543a08b0>]}
[0m17:15:50.288325 [error] [MainThread]: Encountered an error:

[0m17:15:50.299416 [error] [MainThread]: Traceback (most recent call last):
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/main.py", line 315, in docs_serve
    results = task.run()
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m17:15:50.300482 [debug] [MainThread]: Command `dbt docs serve` failed at 17:15:50.300377 after 91.66 seconds
[0m17:15:50.301285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5555835a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55543a1ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55543a1f00>]}
[0m17:15:50.301986 [debug] [MainThread]: Flushing usage events
[0m17:43:57.873514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a7530da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a73e01c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a73e01c30>]}


============================== 17:43:57.879546 | 9459dd7d-883a-4ef2-9e3f-0335fe4ce4f4 ==============================
[0m17:43:57.879546 [info ] [MainThread]: Running with dbt=1.5.11
[0m17:43:57.880264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'version_check': 'True', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:43:58.146347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9459dd7d-883a-4ef2-9e3f-0335fe4ce4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a73e01db0>]}
[0m17:43:58.162235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9459dd7d-883a-4ef2-9e3f-0335fe4ce4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a73efc8b0>]}
[0m17:43:58.168286 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m17:43:58.189510 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m17:43:59.274525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m17:43:59.275440 [debug] [MainThread]: Partial parsing: added file: dbt_tutorial://models/teste/shema.yaml
[0m17:43:59.276340 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_sales_order_detail.sql
[0m17:43:59.302763 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_order_detail.sql
[0m17:43:59.355350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9459dd7d-883a-4ef2-9e3f-0335fe4ce4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a735e9030>]}
[0m17:43:59.364371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9459dd7d-883a-4ef2-9e3f-0335fe4ce4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a77424250>]}
[0m17:43:59.365069 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:43:59.365703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9459dd7d-883a-4ef2-9e3f-0335fe4ce4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a74a0e770>]}
[0m17:43:59.367112 [info ] [MainThread]: 
[0m17:43:59.367939 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:43:59.369040 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m17:43:59.377598 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m17:43:59.378309 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m17:43:59.378870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:59.434602 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m17:43:59.436242 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m17:43:59.437759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now list_Adventureworks_teste)
[0m17:43:59.442699 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:43:59.443315 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m17:43:59.443828 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:59.448951 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:43:59.449576 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:43:59.450051 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m17:43:59.452529 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:43:59.453725 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m17:43:59.454374 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m17:43:59.458120 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:59.458714 [debug] [MainThread]: On master: BEGIN
[0m17:43:59.459314 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:59.464261 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:43:59.464892 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:59.465456 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:43:59.470074 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m17:43:59.473344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9459dd7d-883a-4ef2-9e3f-0335fe4ce4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a73101510>]}
[0m17:43:59.473940 [debug] [MainThread]: On master: ROLLBACK
[0m17:43:59.474593 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:59.475046 [debug] [MainThread]: On master: BEGIN
[0m17:43:59.475856 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:43:59.476341 [debug] [MainThread]: On master: COMMIT
[0m17:43:59.476791 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:59.477246 [debug] [MainThread]: On master: COMMIT
[0m17:43:59.477863 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:43:59.478361 [debug] [MainThread]: On master: Close
[0m17:43:59.479077 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:43:59.479616 [info ] [MainThread]: 
[0m17:43:59.484163 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m17:43:59.484500 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.stg_product_category
[0m17:43:59.484808 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m17:43:59.485546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m17:43:59.486429 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_product_category'
[0m17:43:59.487314 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_sales_order_detail'
[0m17:43:59.487930 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m17:43:59.488581 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m17:43:59.489179 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m17:43:59.495567 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m17:43:59.497797 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m17:43:59.500225 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m17:43:59.503914 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 17:43:59.489684 => 17:43:59.503730
[0m17:43:59.504332 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 17:43:59.498440 => 17:43:59.504174
[0m17:43:59.505552 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m17:43:59.505920 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 17:43:59.496049 => 17:43:59.505761
[0m17:43:59.506937 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m17:43:59.508476 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m17:43:59.509475 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m17:43:59.510623 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_tutorial.int_sales_by_product'
[0m17:43:59.511307 [debug] [Thread-4 (]: Began compiling node model.dbt_tutorial.int_sales_by_product
[0m17:43:59.517025 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_tutorial.int_sales_by_product"
[0m17:43:59.522332 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.int_sales_by_product (compile): 17:43:59.511933 => 17:43:59.522151
[0m17:43:59.523248 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m17:43:59.524337 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m17:43:59.524977 [info ] [Thread-3 (]: 1 of 1 START sql table model teste.mart_sales_by_category ...................... [RUN]
[0m17:43:59.525794 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_sales_order_detail, now model.dbt_tutorial.mart_sales_by_category)
[0m17:43:59.526405 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.mart_sales_by_category
[0m17:43:59.531300 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.mart_sales_by_category"
[0m17:43:59.536751 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (compile): 17:43:59.526868 => 17:43:59.536567
[0m17:43:59.537314 [debug] [Thread-3 (]: Began executing node model.dbt_tutorial.mart_sales_by_category
[0m17:43:59.568460 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_tutorial.mart_sales_by_category"
[0m17:43:59.573726 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:43:59.574305 [debug] [Thread-3 (]: On model.dbt_tutorial.mart_sales_by_category: BEGIN
[0m17:43:59.574856 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:43:59.580462 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:43:59.581333 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:43:59.582315 [debug] [Thread-3 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */

  
    

  create  table "Adventureworks"."teste"."mart_sales_by_category__dbt_tmp"
  
  
    as
  
  (
    

WITH  __dbt__cte__stg_sales_order_detail as (


SELECT
    salesorderid,
    ProductID,
    OrderQty,
    unitprice
FROM
    "Adventureworks"."sales"."salesorderdetail"
),  __dbt__cte__stg_product as (


SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
),  __dbt__cte__int_sales_by_product as (


WITH sales AS (
    SELECT
        sod.ProductID,
        SUM(sod.unitprice) AS TotalSales
    FROM __dbt__cte__stg_sales_order_detail sod
    GROUP BY sod.ProductID
)
SELECT 
    s.ProductID,
    s.TotalSales,
    p.ProductSubcategoryID
FROM sales s
JOIN __dbt__cte__stg_product p ON s.ProductID = p.ProductID
),  __dbt__cte__stg_product_category as (


SELECT
    ProductCategoryID,
    Name AS CategoryName
FROM
    "Adventureworks"."production"."productcategory"
),category_sales AS (
    SELECT
        pc.CategoryName,
        SUM(sp.TotalSales) AS TotalSales
    FROM __dbt__cte__int_sales_by_product sp
    JOIN __dbt__cte__stg_product_category pc 
        ON sp.ProductSubcategoryID = pc.ProductCategoryID
    GROUP BY pc.CategoryName
)
SELECT * FROM category_sales
  );
  
[0m17:43:59.617305 [debug] [Thread-3 (]: SQL status: SELECT 4 in 0.0 seconds
[0m17:43:59.622589 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:43:59.623200 [debug] [Thread-3 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
alter table "Adventureworks"."teste"."mart_sales_by_category" rename to "mart_sales_by_category__dbt_backup"
[0m17:43:59.624201 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:43:59.626478 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:43:59.627073 [debug] [Thread-3 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
alter table "Adventureworks"."teste"."mart_sales_by_category__dbt_tmp" rename to "mart_sales_by_category"
[0m17:43:59.627978 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:43:59.643719 [debug] [Thread-3 (]: On model.dbt_tutorial.mart_sales_by_category: COMMIT
[0m17:43:59.644337 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:43:59.644898 [debug] [Thread-3 (]: On model.dbt_tutorial.mart_sales_by_category: COMMIT
[0m17:43:59.648507 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m17:43:59.652408 [debug] [Thread-3 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:43:59.652995 [debug] [Thread-3 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
drop table if exists "Adventureworks"."teste"."mart_sales_by_category__dbt_backup" cascade
[0m17:43:59.657247 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:43:59.658783 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (execute): 17:43:59.537774 => 17:43:59.658632
[0m17:43:59.659399 [debug] [Thread-3 (]: On model.dbt_tutorial.mart_sales_by_category: Close
[0m17:43:59.660234 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9459dd7d-883a-4ef2-9e3f-0335fe4ce4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a731d8910>]}
[0m17:43:59.660955 [info ] [Thread-3 (]: 1 of 1 OK created sql table model teste.mart_sales_by_category ................. [[32mSELECT 4[0m in 0.13s]
[0m17:43:59.661797 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m17:43:59.663668 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:59.664218 [debug] [MainThread]: On master: BEGIN
[0m17:43:59.664715 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:43:59.669946 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:43:59.670616 [debug] [MainThread]: On master: COMMIT
[0m17:43:59.671138 [debug] [MainThread]: Using postgres connection "master"
[0m17:43:59.671639 [debug] [MainThread]: On master: COMMIT
[0m17:43:59.672322 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:43:59.672853 [debug] [MainThread]: On master: Close
[0m17:43:59.673603 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:59.674163 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product' was properly closed.
[0m17:43:59.674853 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product_category' was properly closed.
[0m17:43:59.675480 [debug] [MainThread]: Connection 'model.dbt_tutorial.mart_sales_by_category' was properly closed.
[0m17:43:59.675988 [debug] [MainThread]: Connection 'model.dbt_tutorial.int_sales_by_product' was properly closed.
[0m17:43:59.676653 [info ] [MainThread]: 
[0m17:43:59.677297 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m17:43:59.678186 [debug] [MainThread]: Command end result
[0m17:43:59.688051 [info ] [MainThread]: 
[0m17:43:59.688930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:43:59.689595 [info ] [MainThread]: 
[0m17:43:59.690310 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:43:59.691099 [debug] [MainThread]: Command `dbt run` succeeded at 17:43:59.690970 after 1.83 seconds
[0m17:43:59.691691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a7530da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a77424250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a74706680>]}
[0m17:43:59.692276 [debug] [MainThread]: Flushing usage events
[0m17:44:15.033231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491d91da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491c40dcf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491c40dd20>]}


============================== 17:44:15.039341 | 3a8f53f1-e1aa-44d8-8e4a-3e6495343b44 ==============================
[0m17:44:15.039341 [info ] [MainThread]: Running with dbt=1.5.11
[0m17:44:15.040051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:44:15.306617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a8f53f1-e1aa-44d8-8e4a-3e6495343b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491c40dba0>]}
[0m17:44:15.322697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a8f53f1-e1aa-44d8-8e4a-3e6495343b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491be9c8b0>]}
[0m17:44:15.328566 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m17:44:15.349328 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m17:44:16.427708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:44:16.428371 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:44:16.433171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a8f53f1-e1aa-44d8-8e4a-3e6495343b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491bb91d20>]}
[0m17:44:16.436884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a8f53f1-e1aa-44d8-8e4a-3e6495343b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491bea8160>]}
[0m17:44:16.437496 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:44:16.438174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a8f53f1-e1aa-44d8-8e4a-3e6495343b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491bea8250>]}
[0m17:44:16.439717 [info ] [MainThread]: 
[0m17:44:16.440648 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:44:16.441960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks_teste'
[0m17:44:16.450712 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:44:16.451484 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m17:44:16.452048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:16.507165 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:44:16.507888 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:44:16.508412 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m17:44:16.510894 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:44:16.512273 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m17:44:16.513123 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m17:44:16.517126 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:16.517818 [debug] [MainThread]: On master: BEGIN
[0m17:44:16.518327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:44:16.523486 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:44:16.524203 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:16.524836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:44:16.529757 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m17:44:16.533177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a8f53f1-e1aa-44d8-8e4a-3e6495343b44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491bea8c70>]}
[0m17:44:16.533837 [debug] [MainThread]: On master: ROLLBACK
[0m17:44:16.534684 [debug] [MainThread]: On master: Close
[0m17:44:16.535524 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:44:16.536203 [info ] [MainThread]: 
[0m17:44:16.540484 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m17:44:16.540838 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.stg_product_category
[0m17:44:16.541149 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m17:44:16.541954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m17:44:16.542921 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_product_category'
[0m17:44:16.543821 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_sales_order_detail'
[0m17:44:16.544436 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m17:44:16.545060 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m17:44:16.545660 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m17:44:16.552825 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m17:44:16.555149 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m17:44:16.557548 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m17:44:16.561239 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 17:44:16.553422 => 17:44:16.561067
[0m17:44:16.561912 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 17:44:16.546249 => 17:44:16.561745
[0m17:44:16.562797 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m17:44:16.563161 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 17:44:16.555789 => 17:44:16.563001
[0m17:44:16.563969 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m17:44:16.565240 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m17:44:16.566398 [debug] [Thread-4 (]: Began running node test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95
[0m17:44:16.566715 [debug] [Thread-2 (]: Began running node test.dbt_tutorial.unique_stg_product_product_id.fd1037e514
[0m17:44:16.567490 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m17:44:16.567797 [debug] [Thread-3 (]: Began running node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:44:16.568533 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95'
[0m17:44:16.569281 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product_category, now test.dbt_tutorial.unique_stg_product_product_id.fd1037e514)
[0m17:44:16.570005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product, now model.dbt_tutorial.int_sales_by_product)
[0m17:44:16.570875 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_sales_order_detail, now test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a)
[0m17:44:16.571459 [debug] [Thread-4 (]: Began compiling node test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95
[0m17:44:16.572041 [debug] [Thread-2 (]: Began compiling node test.dbt_tutorial.unique_stg_product_product_id.fd1037e514
[0m17:44:16.572627 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.int_sales_by_product
[0m17:44:16.573213 [debug] [Thread-3 (]: Began compiling node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:44:16.583304 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95"
[0m17:44:16.589687 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_tutorial.unique_stg_product_product_id.fd1037e514"
[0m17:44:16.594303 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.int_sales_by_product"
[0m17:44:16.598069 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:44:16.603650 [debug] [Thread-4 (]: Timing info for test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95 (compile): 17:44:16.573706 => 17:44:16.603403
[0m17:44:16.604035 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.int_sales_by_product (compile): 17:44:16.590161 => 17:44:16.603875
[0m17:44:16.604801 [debug] [Thread-4 (]: Began executing node test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95
[0m17:44:16.605190 [debug] [Thread-2 (]: Timing info for test.dbt_tutorial.unique_stg_product_product_id.fd1037e514 (compile): 17:44:16.583805 => 17:44:16.605030
[0m17:44:16.606340 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m17:44:16.606751 [debug] [Thread-3 (]: Timing info for test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a (compile): 17:44:16.594877 => 17:44:16.606572
[0m17:44:16.607404 [debug] [Thread-4 (]: Timing info for test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95 (execute): 17:44:16.607242 => 17:44:16.607251
[0m17:44:16.608094 [debug] [Thread-2 (]: Began executing node test.dbt_tutorial.unique_stg_product_product_id.fd1037e514
[0m17:44:16.608855 [debug] [Thread-1 (]: Began running node test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815
[0m17:44:16.609823 [debug] [Thread-3 (]: Began executing node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:44:16.610966 [debug] [Thread-4 (]: Finished running node test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95
[0m17:44:16.611926 [debug] [Thread-2 (]: Timing info for test.dbt_tutorial.unique_stg_product_product_id.fd1037e514 (execute): 17:44:16.611654 => 17:44:16.611677
[0m17:44:16.612774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.int_sales_by_product, now test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815)
[0m17:44:16.613495 [debug] [Thread-3 (]: Timing info for test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a (execute): 17:44:16.613328 => 17:44:16.613337
[0m17:44:16.614261 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m17:44:16.615236 [debug] [Thread-2 (]: Finished running node test.dbt_tutorial.unique_stg_product_product_id.fd1037e514
[0m17:44:16.616006 [debug] [Thread-1 (]: Began compiling node test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815
[0m17:44:16.617019 [debug] [Thread-3 (]: Finished running node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:44:16.617773 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95, now model.dbt_tutorial.mart_sales_by_category)
[0m17:44:16.624079 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815"
[0m17:44:16.625070 [debug] [Thread-4 (]: Began compiling node model.dbt_tutorial.mart_sales_by_category
[0m17:44:16.629804 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_tutorial.mart_sales_by_category"
[0m17:44:16.633003 [debug] [Thread-1 (]: Timing info for test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815 (compile): 17:44:16.618710 => 17:44:16.632838
[0m17:44:16.633605 [debug] [Thread-1 (]: Began executing node test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815
[0m17:44:16.634364 [debug] [Thread-1 (]: Timing info for test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815 (execute): 17:44:16.634195 => 17:44:16.634205
[0m17:44:16.634689 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (compile): 17:44:16.626025 => 17:44:16.634533
[0m17:44:16.635606 [debug] [Thread-1 (]: Finished running node test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815
[0m17:44:16.636231 [debug] [Thread-4 (]: Began executing node model.dbt_tutorial.mart_sales_by_category
[0m17:44:16.637339 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (execute): 17:44:16.637181 => 17:44:16.637188
[0m17:44:16.638210 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m17:44:16.639721 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:16.640264 [debug] [MainThread]: Connection 'test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815' was properly closed.
[0m17:44:16.640764 [debug] [MainThread]: Connection 'test.dbt_tutorial.unique_stg_product_product_id.fd1037e514' was properly closed.
[0m17:44:16.641242 [debug] [MainThread]: Connection 'test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a' was properly closed.
[0m17:44:16.641707 [debug] [MainThread]: Connection 'model.dbt_tutorial.mart_sales_by_category' was properly closed.
[0m17:44:16.642907 [debug] [MainThread]: Command end result
[0m17:44:16.672918 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:44:16.673545 [info ] [MainThread]: Building catalog
[0m17:44:16.675343 [debug] [ThreadPool]: Acquiring new postgres connection 'Adventureworks.information_schema'
[0m17:44:16.680690 [debug] [ThreadPool]: Using postgres connection "Adventureworks.information_schema"
[0m17:44:16.681400 [debug] [ThreadPool]: On Adventureworks.information_schema: BEGIN
[0m17:44:16.682134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:16.687508 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:44:16.688209 [debug] [ThreadPool]: Using postgres connection "Adventureworks.information_schema"
[0m17:44:16.688823 [debug] [ThreadPool]: On Adventureworks.information_schema: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "Adventureworks.information_schema"} */

    
    

    select
        'Adventureworks' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('teste') or upper(sch.nspname) = upper('sales') or upper(sch.nspname) = upper('production'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:44:16.695539 [debug] [ThreadPool]: SQL status: SELECT 438 in 0.0 seconds
[0m17:44:16.708292 [debug] [ThreadPool]: On Adventureworks.information_schema: ROLLBACK
[0m17:44:16.709351 [debug] [ThreadPool]: On Adventureworks.information_schema: Close
[0m17:44:16.724562 [info ] [MainThread]: Catalog written to /mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/target/catalog.json
[0m17:44:16.726040 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:44:16.725891 after 1.71 seconds
[0m17:44:16.726782 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:44:16.727350 [debug] [MainThread]: Connection 'Adventureworks.information_schema' was properly closed.
[0m17:44:16.727935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491d91da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491b71cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491b71d2d0>]}
[0m17:44:16.728529 [debug] [MainThread]: Flushing usage events
[0m17:44:30.942276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2555fbda20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2554c95c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2554c95c30>]}


============================== 17:44:30.947940 | 9c7ca89c-7924-4db0-80cb-347618e97d41 ==============================
[0m17:44:30.947940 [info ] [MainThread]: Running with dbt=1.5.11
[0m17:44:30.948628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:44:31.205560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c7ca89c-7924-4db0-80cb-347618e97d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2554c95db0>]}
[0m17:44:31.221579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c7ca89c-7924-4db0-80cb-347618e97d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2554b908b0>]}
[0m17:44:31.227399 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m17:44:31.248751 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m17:44:32.316969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:44:32.317603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:44:32.322405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c7ca89c-7924-4db0-80cb-347618e97d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2553f1dc30>]}
[0m17:44:32.332281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c7ca89c-7924-4db0-80cb-347618e97d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2554b9c550>]}
[0m17:44:32.333029 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:44:32.333774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c7ca89c-7924-4db0-80cb-347618e97d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2554b9c640>]}
[0m17:44:32.335297 [info ] [MainThread]: 
[0m17:44:32.336297 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:44:32.337867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks_teste'
[0m17:44:32.346628 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:44:32.347479 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m17:44:32.348198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:32.401125 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:44:32.401826 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:44:32.402367 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m17:44:32.404777 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:44:32.406113 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m17:44:32.406815 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m17:44:32.411053 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:32.411702 [debug] [MainThread]: On master: BEGIN
[0m17:44:32.412211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:44:32.417265 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:44:32.417869 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:32.418440 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:44:32.423288 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m17:44:32.427007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c7ca89c-7924-4db0-80cb-347618e97d41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2553f02e60>]}
[0m17:44:32.427742 [debug] [MainThread]: On master: ROLLBACK
[0m17:44:32.428483 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:32.428994 [debug] [MainThread]: On master: BEGIN
[0m17:44:32.429877 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:44:32.430392 [debug] [MainThread]: On master: COMMIT
[0m17:44:32.430887 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:32.431363 [debug] [MainThread]: On master: COMMIT
[0m17:44:32.432030 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:44:32.432546 [debug] [MainThread]: On master: Close
[0m17:44:32.433313 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:44:32.433923 [info ] [MainThread]: 
[0m17:44:32.437836 [debug] [Thread-1 (]: Began running node test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95
[0m17:44:32.438161 [debug] [Thread-2 (]: Began running node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:44:32.438475 [debug] [Thread-3 (]: Began running node test.dbt_tutorial.unique_stg_product_product_id.fd1037e514
[0m17:44:32.438801 [debug] [Thread-4 (]: Began running node test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815
[0m17:44:32.439236 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_product_product_id .............................. [RUN]
[0m17:44:32.439929 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_sales_order_detail_salesorderid ................. [RUN]
[0m17:44:32.440568 [info ] [Thread-3 (]: 3 of 4 START test unique_stg_product_product_id ................................ [RUN]
[0m17:44:32.441223 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_sales_order_detail_salesorderid ................... [RUN]
[0m17:44:32.442192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95)
[0m17:44:32.443076 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a'
[0m17:44:32.443951 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_tutorial.unique_stg_product_product_id.fd1037e514'
[0m17:44:32.444804 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815'
[0m17:44:32.445453 [debug] [Thread-1 (]: Began compiling node test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95
[0m17:44:32.446110 [debug] [Thread-2 (]: Began compiling node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:44:32.446846 [debug] [Thread-3 (]: Began compiling node test.dbt_tutorial.unique_stg_product_product_id.fd1037e514
[0m17:44:32.447507 [debug] [Thread-4 (]: Began compiling node test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815
[0m17:44:32.465784 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95"
[0m17:44:32.471906 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:44:32.481662 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_tutorial.unique_stg_product_product_id.fd1037e514"
[0m17:44:32.488171 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815"
[0m17:44:32.493597 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:44:32.494089 [debug] [Thread-3 (]: Timing info for test.dbt_tutorial.unique_stg_product_product_id.fd1037e514 (compile): 17:44:32.472625 => 17:44:32.493905
[0m17:44:32.494452 [debug] [Thread-4 (]: Timing info for test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815 (compile): 17:44:32.482840 => 17:44:32.494289
[0m17:44:32.497459 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95"
[0m17:44:32.498902 [debug] [Thread-3 (]: Began executing node test.dbt_tutorial.unique_stg_product_product_id.fd1037e514
[0m17:44:32.499896 [debug] [Thread-4 (]: Began executing node test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815
[0m17:44:32.512915 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_tutorial.unique_stg_product_product_id.fd1037e514"
[0m17:44:32.514982 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815"
[0m17:44:32.515391 [debug] [Thread-2 (]: Timing info for test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a (compile): 17:44:32.466304 => 17:44:32.515214
[0m17:44:32.516142 [debug] [Thread-1 (]: Timing info for test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95 (compile): 17:44:32.448130 => 17:44:32.515947
[0m17:44:32.517119 [debug] [Thread-2 (]: Began executing node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:44:32.517778 [debug] [Thread-1 (]: Began executing node test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95
[0m17:44:32.519794 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:44:32.521754 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95"
[0m17:44:32.522643 [debug] [Thread-3 (]: Using postgres connection "test.dbt_tutorial.unique_stg_product_product_id.fd1037e514"
[0m17:44:32.523640 [debug] [Thread-4 (]: Using postgres connection "test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815"
[0m17:44:32.524293 [debug] [Thread-3 (]: On test.dbt_tutorial.unique_stg_product_product_id.fd1037e514: BEGIN
[0m17:44:32.524960 [debug] [Thread-2 (]: Using postgres connection "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:44:32.525454 [debug] [Thread-4 (]: On test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815: BEGIN
[0m17:44:32.526404 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:44:32.526912 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95"
[0m17:44:32.527492 [debug] [Thread-2 (]: On test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a: BEGIN
[0m17:44:32.528202 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:44:32.529552 [debug] [Thread-1 (]: On test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95: BEGIN
[0m17:44:32.530419 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:44:32.531841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:32.534497 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:44:32.535605 [debug] [Thread-3 (]: Using postgres connection "test.dbt_tutorial.unique_stg_product_product_id.fd1037e514"
[0m17:44:32.536486 [debug] [Thread-3 (]: On test.dbt_tutorial.unique_stg_product_product_id.fd1037e514: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "test.dbt_tutorial.unique_stg_product_product_id.fd1037e514"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stg_product as (


SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
)select
    product_id as unique_field,
    count(*) as n_records

from __dbt__cte__stg_product
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:44:32.536855 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:44:32.537775 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:44:32.538080 [debug] [Thread-4 (]: Using postgres connection "test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815"
[0m17:44:32.538396 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "product_id" does not exist
LINE 21:     product_id as unique_field,
             ^
HINT:  Perhaps you meant to reference the column "__dbt__cte__stg_product.productid".

[0m17:44:32.538714 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:44:32.539335 [debug] [Thread-2 (]: Using postgres connection "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:44:32.539966 [debug] [Thread-4 (]: On test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stg_sales_order_detail as (


SELECT
    salesorderid,
    ProductID,
    OrderQty,
    unitprice
FROM
    "Adventureworks"."sales"."salesorderdetail"
)select
    salesorderid as unique_field,
    count(*) as n_records

from __dbt__cte__stg_sales_order_detail
where salesorderid is not null
group by salesorderid
having count(*) > 1



      
    ) dbt_internal_test
[0m17:44:32.540565 [debug] [Thread-3 (]: On test.dbt_tutorial.unique_stg_product_product_id.fd1037e514: ROLLBACK
[0m17:44:32.541160 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95"
[0m17:44:32.541772 [debug] [Thread-2 (]: On test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stg_sales_order_detail as (


SELECT
    salesorderid,
    ProductID,
    OrderQty,
    unitprice
FROM
    "Adventureworks"."sales"."salesorderdetail"
)select salesorderid
from __dbt__cte__stg_sales_order_detail
where salesorderid is null



      
    ) dbt_internal_test
[0m17:44:32.543109 [debug] [Thread-3 (]: Timing info for test.dbt_tutorial.unique_stg_product_product_id.fd1037e514 (execute): 17:44:32.501524 => 17:44:32.542939
[0m17:44:32.543541 [debug] [Thread-1 (]: On test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stg_product as (


SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
)select product_id
from __dbt__cte__stg_product
where product_id is null



      
    ) dbt_internal_test
[0m17:44:32.544568 [debug] [Thread-3 (]: On test.dbt_tutorial.unique_stg_product_product_id.fd1037e514: Close
[0m17:44:32.544960 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:44:32.546375 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "product_id" does not exist
LINE 22: )select product_id
                 ^
HINT:  Perhaps you meant to reference the column "__dbt__cte__stg_product.productid".

[0m17:44:32.548358 [debug] [Thread-2 (]: Timing info for test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a (execute): 17:44:32.518311 => 17:44:32.548184
[0m17:44:32.549075 [debug] [Thread-1 (]: On test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95: ROLLBACK
[0m17:44:32.549729 [debug] [Thread-2 (]: On test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a: ROLLBACK
[0m17:44:32.550968 [debug] [Thread-1 (]: Timing info for test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95 (execute): 17:44:32.520355 => 17:44:32.550811
[0m17:44:32.551781 [debug] [Thread-2 (]: On test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a: Close
[0m17:44:32.552087 [debug] [Thread-1 (]: On test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95: Close
[0m17:44:32.553104 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_sales_order_detail_salesorderid ....................... [[32mPASS[0m in 0.11s]
[0m17:44:32.554863 [debug] [Thread-2 (]: Finished running node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:44:32.571018 [debug] [Thread-1 (]: Database Error in test not_null_stg_product_product_id (models/teste/shema.yaml)
  column "product_id" does not exist
  LINE 22: )select product_id
                   ^
  HINT:  Perhaps you meant to reference the column "__dbt__cte__stg_product.productid".
  compiled Code at target/run/dbt_tutorial/models/teste/shema.yaml/not_null_stg_product_product_id.sql
[0m17:44:32.571584 [debug] [Thread-3 (]: Database Error in test unique_stg_product_product_id (models/teste/shema.yaml)
  column "product_id" does not exist
  LINE 21:     product_id as unique_field,
               ^
  HINT:  Perhaps you meant to reference the column "__dbt__cte__stg_product.productid".
  compiled Code at target/run/dbt_tutorial/models/teste/shema.yaml/unique_stg_product_product_id.sql
[0m17:44:32.571940 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:44:32.572483 [error] [Thread-1 (]: 1 of 4 ERROR not_null_stg_product_product_id ................................... [[31mERROR[0m in 0.13s]
[0m17:44:32.573184 [error] [Thread-3 (]: 3 of 4 ERROR unique_stg_product_product_id ..................................... [[31mERROR[0m in 0.13s]
[0m17:44:32.574683 [debug] [Thread-4 (]: Timing info for test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815 (execute): 17:44:32.513464 => 17:44:32.574501
[0m17:44:32.575319 [debug] [Thread-1 (]: Finished running node test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95
[0m17:44:32.575941 [debug] [Thread-3 (]: Finished running node test.dbt_tutorial.unique_stg_product_product_id.fd1037e514
[0m17:44:32.576601 [debug] [Thread-4 (]: On test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815: ROLLBACK
[0m17:44:32.578290 [debug] [Thread-4 (]: On test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815: Close
[0m17:44:32.579203 [error] [Thread-4 (]: 4 of 4 FAIL 21209 unique_stg_sales_order_detail_salesorderid ................... [[31mFAIL 21209[0m in 0.13s]
[0m17:44:32.580161 [debug] [Thread-4 (]: Finished running node test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815
[0m17:44:32.582055 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:32.582740 [debug] [MainThread]: On master: BEGIN
[0m17:44:32.583280 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:44:32.588466 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:44:32.589144 [debug] [MainThread]: On master: COMMIT
[0m17:44:32.589698 [debug] [MainThread]: Using postgres connection "master"
[0m17:44:32.590205 [debug] [MainThread]: On master: COMMIT
[0m17:44:32.590875 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:44:32.591396 [debug] [MainThread]: On master: Close
[0m17:44:32.592343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:32.592905 [debug] [MainThread]: Connection 'test.dbt_tutorial.not_null_stg_product_product_id.5e35fa3f95' was properly closed.
[0m17:44:32.593409 [debug] [MainThread]: Connection 'test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a' was properly closed.
[0m17:44:32.594001 [debug] [MainThread]: Connection 'test.dbt_tutorial.unique_stg_product_product_id.fd1037e514' was properly closed.
[0m17:44:32.594473 [debug] [MainThread]: Connection 'test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815' was properly closed.
[0m17:44:32.594991 [info ] [MainThread]: 
[0m17:44:32.595583 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m17:44:32.596615 [debug] [MainThread]: Command end result
[0m17:44:32.606941 [info ] [MainThread]: 
[0m17:44:32.607758 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m17:44:32.608387 [info ] [MainThread]: 
[0m17:44:32.608977 [error] [MainThread]: [33mDatabase Error in test not_null_stg_product_product_id (models/teste/shema.yaml)[0m
[0m17:44:32.609553 [error] [MainThread]:   column "product_id" does not exist
[0m17:44:32.610168 [error] [MainThread]:   LINE 22: )select product_id
[0m17:44:32.610740 [error] [MainThread]:                    ^
[0m17:44:32.611304 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "__dbt__cte__stg_product.productid".
[0m17:44:32.611870 [error] [MainThread]:   compiled Code at target/run/dbt_tutorial/models/teste/shema.yaml/not_null_stg_product_product_id.sql
[0m17:44:32.612545 [info ] [MainThread]: 
[0m17:44:32.613180 [error] [MainThread]: [33mDatabase Error in test unique_stg_product_product_id (models/teste/shema.yaml)[0m
[0m17:44:32.613924 [error] [MainThread]:   column "product_id" does not exist
[0m17:44:32.614718 [error] [MainThread]:   LINE 21:     product_id as unique_field,
[0m17:44:32.615483 [error] [MainThread]:                ^
[0m17:44:32.616245 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "__dbt__cte__stg_product.productid".
[0m17:44:32.616935 [error] [MainThread]:   compiled Code at target/run/dbt_tutorial/models/teste/shema.yaml/unique_stg_product_product_id.sql
[0m17:44:32.617614 [info ] [MainThread]: 
[0m17:44:32.618268 [error] [MainThread]: [31mFailure in test unique_stg_sales_order_detail_salesorderid (models/teste/shema.yaml)[0m
[0m17:44:32.619019 [error] [MainThread]:   Got 21209 results, configured to fail if != 0
[0m17:44:32.619630 [info ] [MainThread]: 
[0m17:44:32.620251 [info ] [MainThread]:   compiled Code at target/compiled/dbt_tutorial/models/teste/shema.yaml/unique_stg_sales_order_detail_salesorderid.sql
[0m17:44:32.620907 [info ] [MainThread]: 
[0m17:44:32.621576 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=0 TOTAL=4
[0m17:44:32.622377 [debug] [MainThread]: Command `dbt test` failed at 17:44:32.622288 after 1.69 seconds
[0m17:44:32.622941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2555fbda20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2554b9c160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2554b9ceb0>]}
[0m17:44:32.623529 [debug] [MainThread]: Flushing usage events
[0m17:46:32.544882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99433a1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9942095c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9942095c60>]}


============================== 17:46:32.551355 | fdb12454-d645-479f-8a7a-4e17a57788fc ==============================
[0m17:46:32.551355 [info ] [MainThread]: Running with dbt=1.5.11
[0m17:46:32.552062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:46:32.818757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdb12454-d645-479f-8a7a-4e17a57788fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9942095de0>]}
[0m17:46:32.834941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdb12454-d645-479f-8a7a-4e17a57788fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9941f908b0>]}
[0m17:46:32.841151 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m17:46:32.863002 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m17:46:33.980206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:46:33.981179 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/shema.yaml
[0m17:46:34.006024 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_product.sql
[0m17:46:34.055037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdb12454-d645-479f-8a7a-4e17a57788fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9940f8fd90>]}
[0m17:46:34.065524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdb12454-d645-479f-8a7a-4e17a57788fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9941f9c550>]}
[0m17:46:34.066358 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:46:34.066979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdb12454-d645-479f-8a7a-4e17a57788fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9941f9d870>]}
[0m17:46:34.068758 [info ] [MainThread]: 
[0m17:46:34.069769 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:46:34.071183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks_teste'
[0m17:46:34.080086 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:46:34.080850 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m17:46:34.081471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:34.136929 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:46:34.137691 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:46:34.138438 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m17:46:34.141104 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:46:34.142470 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m17:46:34.143198 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m17:46:34.147075 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:34.147646 [debug] [MainThread]: On master: BEGIN
[0m17:46:34.148163 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:46:34.153230 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:46:34.153962 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:34.154740 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:46:34.159648 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m17:46:34.163238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdb12454-d645-479f-8a7a-4e17a57788fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9941f9d7e0>]}
[0m17:46:34.163948 [debug] [MainThread]: On master: ROLLBACK
[0m17:46:34.164782 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:34.165318 [debug] [MainThread]: On master: BEGIN
[0m17:46:34.166379 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:46:34.166940 [debug] [MainThread]: On master: COMMIT
[0m17:46:34.167496 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:34.167999 [debug] [MainThread]: On master: COMMIT
[0m17:46:34.168664 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:46:34.169173 [debug] [MainThread]: On master: Close
[0m17:46:34.169979 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:46:34.170606 [info ] [MainThread]: 
[0m17:46:34.175612 [debug] [Thread-1 (]: Began running node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m17:46:34.175996 [debug] [Thread-2 (]: Began running node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:46:34.176351 [debug] [Thread-3 (]: Began running node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m17:46:34.176681 [debug] [Thread-4 (]: Began running node test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815
[0m17:46:34.177136 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_product_productid ............................... [RUN]
[0m17:46:34.177806 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_sales_order_detail_salesorderid ................. [RUN]
[0m17:46:34.178660 [info ] [Thread-3 (]: 3 of 4 START test unique_stg_product_productid ................................. [RUN]
[0m17:46:34.179385 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_sales_order_detail_salesorderid ................... [RUN]
[0m17:46:34.180249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee)
[0m17:46:34.181109 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a'
[0m17:46:34.181961 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_tutorial.unique_stg_product_productid.90ff986d4a'
[0m17:46:34.182912 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815'
[0m17:46:34.183637 [debug] [Thread-1 (]: Began compiling node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m17:46:34.184410 [debug] [Thread-2 (]: Began compiling node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:46:34.185165 [debug] [Thread-3 (]: Began compiling node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m17:46:34.185794 [debug] [Thread-4 (]: Began compiling node test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815
[0m17:46:34.201094 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee"
[0m17:46:34.206413 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:46:34.212952 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_tutorial.unique_stg_product_productid.90ff986d4a"
[0m17:46:34.218462 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815"
[0m17:46:34.222851 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee"
[0m17:46:34.223753 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:46:34.224180 [debug] [Thread-3 (]: Timing info for test.dbt_tutorial.unique_stg_product_productid.90ff986d4a (compile): 17:46:34.207081 => 17:46:34.224005
[0m17:46:34.225249 [debug] [Thread-4 (]: Timing info for test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815 (compile): 17:46:34.213393 => 17:46:34.224935
[0m17:46:34.226176 [debug] [Thread-3 (]: Began executing node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m17:46:34.226571 [debug] [Thread-1 (]: Timing info for test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee (compile): 17:46:34.186516 => 17:46:34.226410
[0m17:46:34.227297 [debug] [Thread-4 (]: Began executing node test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815
[0m17:46:34.233434 [debug] [Thread-2 (]: Timing info for test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a (compile): 17:46:34.201584 => 17:46:34.233172
[0m17:46:34.238986 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_tutorial.unique_stg_product_productid.90ff986d4a"
[0m17:46:34.239794 [debug] [Thread-1 (]: Began executing node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m17:46:34.241961 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815"
[0m17:46:34.242586 [debug] [Thread-2 (]: Began executing node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:46:34.245050 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee"
[0m17:46:34.247441 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:46:34.248609 [debug] [Thread-3 (]: Using postgres connection "test.dbt_tutorial.unique_stg_product_productid.90ff986d4a"
[0m17:46:34.250340 [debug] [Thread-4 (]: Using postgres connection "test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815"
[0m17:46:34.250773 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee"
[0m17:46:34.251207 [debug] [Thread-3 (]: On test.dbt_tutorial.unique_stg_product_productid.90ff986d4a: BEGIN
[0m17:46:34.252271 [debug] [Thread-4 (]: On test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815: BEGIN
[0m17:46:34.253110 [debug] [Thread-2 (]: Using postgres connection "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:46:34.253453 [debug] [Thread-1 (]: On test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee: BEGIN
[0m17:46:34.254084 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:46:34.254703 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:46:34.255364 [debug] [Thread-2 (]: On test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a: BEGIN
[0m17:46:34.255986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:34.257848 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:46:34.261960 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:46:34.262330 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m17:46:34.262940 [debug] [Thread-3 (]: Using postgres connection "test.dbt_tutorial.unique_stg_product_productid.90ff986d4a"
[0m17:46:34.263355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:46:34.263726 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:46:34.264171 [debug] [Thread-4 (]: Using postgres connection "test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815"
[0m17:46:34.264814 [debug] [Thread-3 (]: On test.dbt_tutorial.unique_stg_product_productid.90ff986d4a: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "test.dbt_tutorial.unique_stg_product_productid.90ff986d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stg_product as (


SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
)select
    productid as unique_field,
    count(*) as n_records

from __dbt__cte__stg_product
where productid is not null
group by productid
having count(*) > 1



      
    ) dbt_internal_test
[0m17:46:34.265638 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee"
[0m17:46:34.266371 [debug] [Thread-2 (]: Using postgres connection "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:46:34.267012 [debug] [Thread-4 (]: On test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stg_sales_order_detail as (


SELECT
    salesorderid,
    ProductID,
    OrderQty,
    unitprice
FROM
    "Adventureworks"."sales"."salesorderdetail"
)select
    salesorderid as unique_field,
    count(*) as n_records

from __dbt__cte__stg_sales_order_detail
where salesorderid is not null
group by salesorderid
having count(*) > 1



      
    ) dbt_internal_test
[0m17:46:34.267997 [debug] [Thread-1 (]: On test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stg_product as (


SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
)select productid
from __dbt__cte__stg_product
where productid is null



      
    ) dbt_internal_test
[0m17:46:34.268636 [debug] [Thread-2 (]: On test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stg_sales_order_detail as (


SELECT
    salesorderid,
    ProductID,
    OrderQty,
    unitprice
FROM
    "Adventureworks"."sales"."salesorderdetail"
)select salesorderid
from __dbt__cte__stg_sales_order_detail
where salesorderid is null



      
    ) dbt_internal_test
[0m17:46:34.269024 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:46:34.270842 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:46:34.272849 [debug] [Thread-3 (]: Timing info for test.dbt_tutorial.unique_stg_product_productid.90ff986d4a (execute): 17:46:34.228019 => 17:46:34.272660
[0m17:46:34.273242 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:46:34.274645 [debug] [Thread-1 (]: Timing info for test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee (execute): 17:46:34.243509 => 17:46:34.274491
[0m17:46:34.275272 [debug] [Thread-3 (]: On test.dbt_tutorial.unique_stg_product_productid.90ff986d4a: ROLLBACK
[0m17:46:34.276613 [debug] [Thread-2 (]: Timing info for test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a (execute): 17:46:34.246022 => 17:46:34.276461
[0m17:46:34.277230 [debug] [Thread-1 (]: On test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee: ROLLBACK
[0m17:46:34.278126 [debug] [Thread-3 (]: On test.dbt_tutorial.unique_stg_product_productid.90ff986d4a: Close
[0m17:46:34.278424 [debug] [Thread-2 (]: On test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a: ROLLBACK
[0m17:46:34.279304 [debug] [Thread-1 (]: On test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee: Close
[0m17:46:34.280115 [info ] [Thread-3 (]: 3 of 4 PASS unique_stg_product_productid ....................................... [[32mPASS[0m in 0.10s]
[0m17:46:34.280933 [debug] [Thread-2 (]: On test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a: Close
[0m17:46:34.281826 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_product_productid ..................................... [[32mPASS[0m in 0.10s]
[0m17:46:34.282661 [debug] [Thread-3 (]: Finished running node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m17:46:34.283600 [info ] [Thread-2 (]: 2 of 4 PASS not_null_stg_sales_order_detail_salesorderid ....................... [[32mPASS[0m in 0.10s]
[0m17:46:34.284322 [debug] [Thread-1 (]: Finished running node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m17:46:34.285637 [debug] [Thread-2 (]: Finished running node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:46:34.298715 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:46:34.300635 [debug] [Thread-4 (]: Timing info for test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815 (execute): 17:46:34.240376 => 17:46:34.300454
[0m17:46:34.301371 [debug] [Thread-4 (]: On test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815: ROLLBACK
[0m17:46:34.302243 [debug] [Thread-4 (]: On test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815: Close
[0m17:46:34.303260 [error] [Thread-4 (]: 4 of 4 FAIL 21209 unique_stg_sales_order_detail_salesorderid ................... [[31mFAIL 21209[0m in 0.12s]
[0m17:46:34.304182 [debug] [Thread-4 (]: Finished running node test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815
[0m17:46:34.306018 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:34.306637 [debug] [MainThread]: On master: BEGIN
[0m17:46:34.307167 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:46:34.312335 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:46:34.313021 [debug] [MainThread]: On master: COMMIT
[0m17:46:34.313564 [debug] [MainThread]: Using postgres connection "master"
[0m17:46:34.314086 [debug] [MainThread]: On master: COMMIT
[0m17:46:34.314760 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:46:34.315303 [debug] [MainThread]: On master: Close
[0m17:46:34.316356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:34.316909 [debug] [MainThread]: Connection 'test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee' was properly closed.
[0m17:46:34.317438 [debug] [MainThread]: Connection 'test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a' was properly closed.
[0m17:46:34.317944 [debug] [MainThread]: Connection 'test.dbt_tutorial.unique_stg_product_productid.90ff986d4a' was properly closed.
[0m17:46:34.318471 [debug] [MainThread]: Connection 'test.dbt_tutorial.unique_stg_sales_order_detail_salesorderid.c5b244b815' was properly closed.
[0m17:46:34.319014 [info ] [MainThread]: 
[0m17:46:34.319690 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m17:46:34.321006 [debug] [MainThread]: Command end result
[0m17:46:34.331014 [info ] [MainThread]: 
[0m17:46:34.331808 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:46:34.332865 [info ] [MainThread]: 
[0m17:46:34.333792 [error] [MainThread]: [31mFailure in test unique_stg_sales_order_detail_salesorderid (models/teste/shema.yaml)[0m
[0m17:46:34.334638 [error] [MainThread]:   Got 21209 results, configured to fail if != 0
[0m17:46:34.335424 [info ] [MainThread]: 
[0m17:46:34.336189 [info ] [MainThread]:   compiled Code at target/compiled/dbt_tutorial/models/teste/shema.yaml/unique_stg_sales_order_detail_salesorderid.sql
[0m17:46:34.336958 [info ] [MainThread]: 
[0m17:46:34.337712 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:46:34.338676 [debug] [MainThread]: Command `dbt test` failed at 17:46:34.338572 after 1.81 seconds
[0m17:46:34.339470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99433a1a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9940f14730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9940f15390>]}
[0m17:46:34.340291 [debug] [MainThread]: Flushing usage events
[0m17:47:22.897955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464d02ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464bb01bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464bb01ba0>]}


============================== 17:47:22.903890 | 1eaf6ec0-0dbc-4597-b428-163c3dfc1297 ==============================
[0m17:47:22.903890 [info ] [MainThread]: Running with dbt=1.5.11
[0m17:47:22.904578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:47:23.163799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eaf6ec0-0dbc-4597-b428-163c3dfc1297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464bb01d20>]}
[0m17:47:23.179630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1eaf6ec0-0dbc-4597-b428-163c3dfc1297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464bbfcac0>]}
[0m17:47:23.185460 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m17:47:23.206001 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m17:47:24.293003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:47:24.293905 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/shema.yaml
[0m17:47:24.318587 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_order_detail.sql
[0m17:47:24.364299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1eaf6ec0-0dbc-4597-b428-163c3dfc1297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464afe4340>]}
[0m17:47:24.374213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1eaf6ec0-0dbc-4597-b428-163c3dfc1297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464b30a950>]}
[0m17:47:24.374931 [info ] [MainThread]: Found 5 models, 3 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:47:24.375588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eaf6ec0-0dbc-4597-b428-163c3dfc1297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464b309540>]}
[0m17:47:24.377038 [info ] [MainThread]: 
[0m17:47:24.377994 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:47:24.379212 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks_teste'
[0m17:47:24.387658 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:47:24.388396 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m17:47:24.389171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:24.442198 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:47:24.442884 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:47:24.443403 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m17:47:24.445920 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:47:24.447275 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m17:47:24.448036 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m17:47:24.452184 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:24.452827 [debug] [MainThread]: On master: BEGIN
[0m17:47:24.453422 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:24.458459 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:47:24.459032 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:24.459619 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:47:24.464291 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m17:47:24.467742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eaf6ec0-0dbc-4597-b428-163c3dfc1297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464af79090>]}
[0m17:47:24.468410 [debug] [MainThread]: On master: ROLLBACK
[0m17:47:24.469139 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:24.469634 [debug] [MainThread]: On master: BEGIN
[0m17:47:24.470495 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:47:24.471048 [debug] [MainThread]: On master: COMMIT
[0m17:47:24.471564 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:24.472041 [debug] [MainThread]: On master: COMMIT
[0m17:47:24.472713 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:47:24.473224 [debug] [MainThread]: On master: Close
[0m17:47:24.473964 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:47:24.474560 [info ] [MainThread]: 
[0m17:47:24.478415 [debug] [Thread-1 (]: Began running node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m17:47:24.478770 [debug] [Thread-2 (]: Began running node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:47:24.479075 [debug] [Thread-3 (]: Began running node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m17:47:24.479638 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_product_productid ............................... [RUN]
[0m17:47:24.480311 [info ] [Thread-2 (]: 2 of 3 START test not_null_stg_sales_order_detail_salesorderid ................. [RUN]
[0m17:47:24.480943 [info ] [Thread-3 (]: 3 of 3 START test unique_stg_product_productid ................................. [RUN]
[0m17:47:24.481764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee)
[0m17:47:24.482608 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a'
[0m17:47:24.483466 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_tutorial.unique_stg_product_productid.90ff986d4a'
[0m17:47:24.484098 [debug] [Thread-1 (]: Began compiling node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m17:47:24.484737 [debug] [Thread-2 (]: Began compiling node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:47:24.485317 [debug] [Thread-3 (]: Began compiling node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m17:47:24.500439 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee"
[0m17:47:24.505206 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:47:24.511837 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_tutorial.unique_stg_product_productid.90ff986d4a"
[0m17:47:24.516212 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee"
[0m17:47:24.517418 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:47:24.517918 [debug] [Thread-3 (]: Timing info for test.dbt_tutorial.unique_stg_product_productid.90ff986d4a (compile): 17:47:24.505866 => 17:47:24.517723
[0m17:47:24.519415 [debug] [Thread-3 (]: Began executing node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m17:47:24.530871 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_tutorial.unique_stg_product_productid.90ff986d4a"
[0m17:47:24.532007 [debug] [Thread-2 (]: Timing info for test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a (compile): 17:47:24.500923 => 17:47:24.531835
[0m17:47:24.532683 [debug] [Thread-1 (]: Timing info for test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee (compile): 17:47:24.485957 => 17:47:24.532524
[0m17:47:24.533201 [debug] [Thread-2 (]: Began executing node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:47:24.533963 [debug] [Thread-1 (]: Began executing node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m17:47:24.536171 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:47:24.538113 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee"
[0m17:47:24.538444 [debug] [Thread-3 (]: Using postgres connection "test.dbt_tutorial.unique_stg_product_productid.90ff986d4a"
[0m17:47:24.539793 [debug] [Thread-3 (]: On test.dbt_tutorial.unique_stg_product_productid.90ff986d4a: BEGIN
[0m17:47:24.540330 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:47:24.543215 [debug] [Thread-2 (]: Using postgres connection "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:47:24.544141 [debug] [Thread-2 (]: On test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a: BEGIN
[0m17:47:24.544579 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee"
[0m17:47:24.545129 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:47:24.545764 [debug] [Thread-1 (]: On test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee: BEGIN
[0m17:47:24.546137 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m17:47:24.547169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:47:24.547815 [debug] [Thread-3 (]: Using postgres connection "test.dbt_tutorial.unique_stg_product_productid.90ff986d4a"
[0m17:47:24.548937 [debug] [Thread-3 (]: On test.dbt_tutorial.unique_stg_product_productid.90ff986d4a: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "test.dbt_tutorial.unique_stg_product_productid.90ff986d4a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with __dbt__cte__stg_product as (


SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
)select
    productid as unique_field,
    count(*) as n_records

from __dbt__cte__stg_product
where productid is not null
group by productid
having count(*) > 1



      
    ) dbt_internal_test
[0m17:47:24.551056 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:47:24.551570 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:47:24.553649 [debug] [Thread-3 (]: Timing info for test.dbt_tutorial.unique_stg_product_productid.90ff986d4a (execute): 17:47:24.519932 => 17:47:24.553457
[0m17:47:24.554389 [debug] [Thread-2 (]: Using postgres connection "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:47:24.554753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:47:24.555274 [debug] [Thread-3 (]: On test.dbt_tutorial.unique_stg_product_productid.90ff986d4a: ROLLBACK
[0m17:47:24.555919 [debug] [Thread-2 (]: On test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stg_sales_order_detail as (


SELECT
    salesorderid,
    ProductID,
    OrderQty,
    unitprice
FROM
    "Adventureworks"."sales"."salesorderdetail"
)select salesorderid
from __dbt__cte__stg_sales_order_detail
where salesorderid is null



      
    ) dbt_internal_test
[0m17:47:24.556657 [debug] [Thread-1 (]: Using postgres connection "test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee"
[0m17:47:24.557493 [debug] [Thread-3 (]: On test.dbt_tutorial.unique_stg_product_productid.90ff986d4a: Close
[0m17:47:24.558341 [debug] [Thread-1 (]: On test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



with __dbt__cte__stg_product as (


SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
)select productid
from __dbt__cte__stg_product
where productid is null



      
    ) dbt_internal_test
[0m17:47:24.558767 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:47:24.559639 [info ] [Thread-3 (]: 3 of 3 PASS unique_stg_product_productid ....................................... [[32mPASS[0m in 0.08s]
[0m17:47:24.561432 [debug] [Thread-2 (]: Timing info for test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a (execute): 17:47:24.534501 => 17:47:24.561258
[0m17:47:24.561766 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m17:47:24.562405 [debug] [Thread-3 (]: Finished running node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m17:47:24.563021 [debug] [Thread-2 (]: On test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a: ROLLBACK
[0m17:47:24.564278 [debug] [Thread-1 (]: Timing info for test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee (execute): 17:47:24.536757 => 17:47:24.564128
[0m17:47:24.565534 [debug] [Thread-2 (]: On test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a: Close
[0m17:47:24.566007 [debug] [Thread-1 (]: On test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee: ROLLBACK
[0m17:47:24.567058 [info ] [Thread-2 (]: 2 of 3 PASS not_null_stg_sales_order_detail_salesorderid ....................... [[32mPASS[0m in 0.08s]
[0m17:47:24.567904 [debug] [Thread-1 (]: On test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee: Close
[0m17:47:24.568467 [debug] [Thread-2 (]: Finished running node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:47:24.569405 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_product_productid ..................................... [[32mPASS[0m in 0.09s]
[0m17:47:24.570532 [debug] [Thread-1 (]: Finished running node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m17:47:24.572239 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:24.572829 [debug] [MainThread]: On master: BEGIN
[0m17:47:24.573347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:24.578564 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:47:24.579161 [debug] [MainThread]: On master: COMMIT
[0m17:47:24.579689 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:24.580182 [debug] [MainThread]: On master: COMMIT
[0m17:47:24.580865 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:47:24.581385 [debug] [MainThread]: On master: Close
[0m17:47:24.582175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:24.582828 [debug] [MainThread]: Connection 'test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee' was properly closed.
[0m17:47:24.583349 [debug] [MainThread]: Connection 'test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a' was properly closed.
[0m17:47:24.583929 [debug] [MainThread]: Connection 'test.dbt_tutorial.unique_stg_product_productid.90ff986d4a' was properly closed.
[0m17:47:24.584466 [info ] [MainThread]: 
[0m17:47:24.585169 [info ] [MainThread]: Finished running 3 tests in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m17:47:24.586300 [debug] [MainThread]: Command end result
[0m17:47:24.595882 [info ] [MainThread]: 
[0m17:47:24.596737 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:24.597338 [info ] [MainThread]: 
[0m17:47:24.598088 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:47:24.598918 [debug] [MainThread]: Command `dbt test` succeeded at 17:47:24.598825 after 1.71 seconds
[0m17:47:24.599672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464d02ed10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464bbfcac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f464c715120>]}
[0m17:47:24.600403 [debug] [MainThread]: Flushing usage events
[0m17:47:44.870736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c1931a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c0405c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c0405c30>]}


============================== 17:47:44.875868 | d73c020b-31ba-4e00-8b28-3987e0fb9c76 ==============================
[0m17:47:44.875868 [info ] [MainThread]: Running with dbt=1.5.11
[0m17:47:44.876766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:47:45.167406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd73c020b-31ba-4e00-8b28-3987e0fb9c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c0405db0>]}
[0m17:47:45.183896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd73c020b-31ba-4e00-8b28-3987e0fb9c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bfe948b0>]}
[0m17:47:45.190494 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m17:47:45.213364 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m17:47:46.391366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:47:46.392020 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:47:46.396812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd73c020b-31ba-4e00-8b28-3987e0fb9c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bfb899c0>]}
[0m17:47:46.406749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd73c020b-31ba-4e00-8b28-3987e0fb9c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bfea05b0>]}
[0m17:47:46.407495 [info ] [MainThread]: Found 5 models, 3 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:47:46.408174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd73c020b-31ba-4e00-8b28-3987e0fb9c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bfea06a0>]}
[0m17:47:46.409673 [info ] [MainThread]: 
[0m17:47:46.410659 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:47:46.412443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m17:47:46.421107 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m17:47:46.421904 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m17:47:46.422440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:46.479389 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m17:47:46.480856 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m17:47:46.482314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now list_Adventureworks_teste)
[0m17:47:46.488085 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:47:46.488693 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m17:47:46.489206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:47:46.494282 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:47:46.494873 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:47:46.495390 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m17:47:46.497876 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:47:46.499149 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m17:47:46.500157 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m17:47:46.504279 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:46.504885 [debug] [MainThread]: On master: BEGIN
[0m17:47:46.505396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:47:46.510477 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:47:46.511032 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:46.511593 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:47:46.516311 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m17:47:46.519626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd73c020b-31ba-4e00-8b28-3987e0fb9c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bfbca920>]}
[0m17:47:46.520310 [debug] [MainThread]: On master: ROLLBACK
[0m17:47:46.521078 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:46.521604 [debug] [MainThread]: On master: BEGIN
[0m17:47:46.522619 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:47:46.523163 [debug] [MainThread]: On master: COMMIT
[0m17:47:46.523666 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:46.524172 [debug] [MainThread]: On master: COMMIT
[0m17:47:46.524830 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:47:46.525389 [debug] [MainThread]: On master: Close
[0m17:47:46.526203 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:47:46.526927 [info ] [MainThread]: 
[0m17:47:46.530969 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m17:47:46.531302 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.stg_product_category
[0m17:47:46.531612 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m17:47:46.532344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m17:47:46.533384 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_product_category'
[0m17:47:46.534225 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_sales_order_detail'
[0m17:47:46.534853 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m17:47:46.535452 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m17:47:46.536035 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m17:47:46.542597 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m17:47:46.544711 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m17:47:46.547018 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m17:47:46.551333 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 17:47:46.536604 => 17:47:46.551030
[0m17:47:46.551774 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 17:47:46.543033 => 17:47:46.551588
[0m17:47:46.552865 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m17:47:46.553228 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 17:47:46.545322 => 17:47:46.553072
[0m17:47:46.554120 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m17:47:46.555576 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m17:47:46.557479 [debug] [Thread-4 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m17:47:46.558313 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_tutorial.int_sales_by_product'
[0m17:47:46.558850 [debug] [Thread-4 (]: Began compiling node model.dbt_tutorial.int_sales_by_product
[0m17:47:46.564129 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_tutorial.int_sales_by_product"
[0m17:47:46.569754 [debug] [Thread-4 (]: Timing info for model.dbt_tutorial.int_sales_by_product (compile): 17:47:46.559299 => 17:47:46.569476
[0m17:47:46.570967 [debug] [Thread-4 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m17:47:46.572144 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m17:47:46.572915 [info ] [Thread-2 (]: 1 of 1 START sql table model teste.mart_sales_by_category ...................... [RUN]
[0m17:47:46.573766 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product_category, now model.dbt_tutorial.mart_sales_by_category)
[0m17:47:46.574380 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.mart_sales_by_category
[0m17:47:46.579446 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.mart_sales_by_category"
[0m17:47:46.585606 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (compile): 17:47:46.574916 => 17:47:46.585279
[0m17:47:46.586467 [debug] [Thread-2 (]: Began executing node model.dbt_tutorial.mart_sales_by_category
[0m17:47:46.619637 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_tutorial.mart_sales_by_category"
[0m17:47:46.625278 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:47:46.625965 [debug] [Thread-2 (]: On model.dbt_tutorial.mart_sales_by_category: BEGIN
[0m17:47:46.626554 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:47:46.631977 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m17:47:46.632687 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:47:46.633501 [debug] [Thread-2 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */

  
    

  create  table "Adventureworks"."teste"."mart_sales_by_category__dbt_tmp"
  
  
    as
  
  (
    

WITH  __dbt__cte__stg_sales_order_detail as (


SELECT
    salesorderid,
    ProductID,
    OrderQty,
    unitprice
FROM
    "Adventureworks"."sales"."salesorderdetail"
),  __dbt__cte__stg_product as (


SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
),  __dbt__cte__int_sales_by_product as (


WITH sales AS (
    SELECT
        sod.ProductID,
        SUM(sod.unitprice) AS TotalSales
    FROM __dbt__cte__stg_sales_order_detail sod
    GROUP BY sod.ProductID
)
SELECT 
    s.ProductID,
    s.TotalSales,
    p.ProductSubcategoryID
FROM sales s
JOIN __dbt__cte__stg_product p ON s.ProductID = p.ProductID
),  __dbt__cte__stg_product_category as (


SELECT
    ProductCategoryID,
    Name AS CategoryName
FROM
    "Adventureworks"."production"."productcategory"
),category_sales AS (
    SELECT
        pc.CategoryName,
        SUM(sp.TotalSales) AS TotalSales
    FROM __dbt__cte__int_sales_by_product sp
    JOIN __dbt__cte__stg_product_category pc 
        ON sp.ProductSubcategoryID = pc.ProductCategoryID
    GROUP BY pc.CategoryName
)
SELECT * FROM category_sales
  );
  
[0m17:47:46.667182 [debug] [Thread-2 (]: SQL status: SELECT 4 in 0.0 seconds
[0m17:47:46.672495 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:47:46.673133 [debug] [Thread-2 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
alter table "Adventureworks"."teste"."mart_sales_by_category" rename to "mart_sales_by_category__dbt_backup"
[0m17:47:46.674128 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:46.676409 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:47:46.677023 [debug] [Thread-2 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
alter table "Adventureworks"."teste"."mart_sales_by_category__dbt_tmp" rename to "mart_sales_by_category"
[0m17:47:46.677901 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:47:46.693538 [debug] [Thread-2 (]: On model.dbt_tutorial.mart_sales_by_category: COMMIT
[0m17:47:46.694195 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:47:46.694749 [debug] [Thread-2 (]: On model.dbt_tutorial.mart_sales_by_category: COMMIT
[0m17:47:46.698087 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m17:47:46.702074 [debug] [Thread-2 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m17:47:46.702691 [debug] [Thread-2 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
drop table if exists "Adventureworks"."teste"."mart_sales_by_category__dbt_backup" cascade
[0m17:47:46.706875 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:47:46.708399 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (execute): 17:47:46.587004 => 17:47:46.708246
[0m17:47:46.708957 [debug] [Thread-2 (]: On model.dbt_tutorial.mart_sales_by_category: Close
[0m17:47:46.709752 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd73c020b-31ba-4e00-8b28-3987e0fb9c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bf71fe50>]}
[0m17:47:46.710544 [info ] [Thread-2 (]: 1 of 1 OK created sql table model teste.mart_sales_by_category ................. [[32mSELECT 4[0m in 0.14s]
[0m17:47:46.711358 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m17:47:46.713200 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:46.713731 [debug] [MainThread]: On master: BEGIN
[0m17:47:46.714241 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:47:46.719310 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:47:46.719944 [debug] [MainThread]: On master: COMMIT
[0m17:47:46.720434 [debug] [MainThread]: Using postgres connection "master"
[0m17:47:46.720915 [debug] [MainThread]: On master: COMMIT
[0m17:47:46.721602 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:47:46.722117 [debug] [MainThread]: On master: Close
[0m17:47:46.722873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:46.723437 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_product' was properly closed.
[0m17:47:46.724002 [debug] [MainThread]: Connection 'model.dbt_tutorial.mart_sales_by_category' was properly closed.
[0m17:47:46.724655 [debug] [MainThread]: Connection 'model.dbt_tutorial.stg_sales_order_detail' was properly closed.
[0m17:47:46.725191 [debug] [MainThread]: Connection 'model.dbt_tutorial.int_sales_by_product' was properly closed.
[0m17:47:46.725707 [info ] [MainThread]: 
[0m17:47:46.726379 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m17:47:46.727351 [debug] [MainThread]: Command end result
[0m17:47:46.737077 [info ] [MainThread]: 
[0m17:47:46.737824 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:46.738448 [info ] [MainThread]: 
[0m17:47:46.739050 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:47:46.739748 [debug] [MainThread]: Command `dbt run` succeeded at 17:47:46.739660 after 1.88 seconds
[0m17:47:46.740351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22c1931a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bfbca950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bf71ffa0>]}
[0m17:47:46.740943 [debug] [MainThread]: Flushing usage events
[0m17:49:57.799223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb2cf65a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb2ba01cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb2ba01cf0>]}


============================== 17:49:57.805104 | 30054d5b-1d86-4fce-b68c-dd33e876b502 ==============================
[0m17:49:57.805104 [info ] [MainThread]: Running with dbt=1.5.11
[0m17:49:57.805812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:49:58.081005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30054d5b-1d86-4fce-b68c-dd33e876b502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb2ba01b70>]}
[0m17:49:58.097374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30054d5b-1d86-4fce-b68c-dd33e876b502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb2bafc8b0>]}
[0m17:49:58.103631 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m17:49:58.124817 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m17:49:59.212917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:59.213571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:59.218340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30054d5b-1d86-4fce-b68c-dd33e876b502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb2ab85ab0>]}
[0m17:49:59.221935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30054d5b-1d86-4fce-b68c-dd33e876b502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb2af081c0>]}
[0m17:49:59.222548 [info ] [MainThread]: Found 5 models, 3 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m17:49:59.223195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30054d5b-1d86-4fce-b68c-dd33e876b502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb2af084c0>]}
[0m17:49:59.224726 [info ] [MainThread]: 
[0m17:49:59.225601 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:49:59.227247 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks_teste'
[0m17:49:59.235906 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:49:59.236720 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m17:49:59.237261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:59.292531 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:49:59.293229 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m17:49:59.293744 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m17:49:59.296220 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:49:59.297558 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m17:49:59.298260 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m17:49:59.302134 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:59.302811 [debug] [MainThread]: On master: BEGIN
[0m17:49:59.303318 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:59.308531 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:49:59.309240 [debug] [MainThread]: Using postgres connection "master"
[0m17:49:59.309851 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:49:59.314512 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m17:49:59.317911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30054d5b-1d86-4fce-b68c-dd33e876b502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb2af0ad70>]}
[0m17:49:59.318671 [debug] [MainThread]: On master: ROLLBACK
[0m17:49:59.319479 [debug] [MainThread]: On master: Close
[0m17:49:59.320308 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:49:59.320935 [info ] [MainThread]: 
[0m17:49:59.324913 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m17:49:59.325291 [debug] [Thread-2 (]: Began running node model.dbt_tutorial.stg_product_category
[0m17:49:59.325598 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m17:49:59.326374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m17:49:59.327356 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_product_category'
[0m17:49:59.328217 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_tutorial.stg_sales_order_detail'
[0m17:49:59.328813 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m17:49:59.329405 [debug] [Thread-2 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m17:49:59.329990 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m17:49:59.337062 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m17:49:59.339395 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m17:49:59.341838 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m17:49:59.345577 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 17:49:59.330505 => 17:49:59.345397
[0m17:49:59.345949 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 17:49:59.339978 => 17:49:59.345785
[0m17:49:59.347038 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m17:49:59.347423 [debug] [Thread-2 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 17:49:59.337649 => 17:49:59.347262
[0m17:49:59.348219 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m17:49:59.349230 [debug] [Thread-4 (]: Began running node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m17:49:59.349519 [debug] [Thread-1 (]: Began running node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m17:49:59.350240 [debug] [Thread-2 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m17:49:59.351301 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m17:49:59.351958 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee'
[0m17:49:59.352704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product, now test.dbt_tutorial.unique_stg_product_productid.90ff986d4a)
[0m17:49:59.353353 [debug] [Thread-2 (]: Began running node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:49:59.354264 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_sales_order_detail, now model.dbt_tutorial.int_sales_by_product)
[0m17:49:59.354838 [debug] [Thread-4 (]: Began compiling node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m17:49:59.355419 [debug] [Thread-1 (]: Began compiling node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m17:49:59.356161 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product_category, now test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a)
[0m17:49:59.356831 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.int_sales_by_product
[0m17:49:59.367000 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee"
[0m17:49:59.373203 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tutorial.unique_stg_product_productid.90ff986d4a"
[0m17:49:59.373728 [debug] [Thread-2 (]: Began compiling node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:49:59.378505 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.int_sales_by_product"
[0m17:49:59.383113 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m17:49:59.387070 [debug] [Thread-4 (]: Timing info for test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee (compile): 17:49:59.357390 => 17:49:59.386868
[0m17:49:59.387503 [debug] [Thread-1 (]: Timing info for test.dbt_tutorial.unique_stg_product_productid.90ff986d4a (compile): 17:49:59.367498 => 17:49:59.387347
[0m17:49:59.388331 [debug] [Thread-4 (]: Began executing node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m17:49:59.388711 [debug] [Thread-2 (]: Timing info for test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a (compile): 17:49:59.379912 => 17:49:59.388549
[0m17:49:59.389112 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.int_sales_by_product (compile): 17:49:59.374244 => 17:49:59.388953
[0m17:49:59.389577 [debug] [Thread-1 (]: Began executing node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m17:49:59.390279 [debug] [Thread-4 (]: Timing info for test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee (execute): 17:49:59.390095 => 17:49:59.390107
[0m17:49:59.390876 [debug] [Thread-2 (]: Began executing node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:49:59.391874 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m17:49:59.392578 [debug] [Thread-1 (]: Timing info for test.dbt_tutorial.unique_stg_product_productid.90ff986d4a (execute): 17:49:59.392423 => 17:49:59.392429
[0m17:49:59.393509 [debug] [Thread-4 (]: Finished running node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m17:49:59.394182 [debug] [Thread-2 (]: Timing info for test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a (execute): 17:49:59.394004 => 17:49:59.394011
[0m17:49:59.395137 [debug] [Thread-3 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m17:49:59.395874 [debug] [Thread-1 (]: Finished running node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m17:49:59.397299 [debug] [Thread-2 (]: Finished running node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m17:49:59.398074 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.int_sales_by_product, now model.dbt_tutorial.mart_sales_by_category)
[0m17:49:59.399534 [debug] [Thread-3 (]: Began compiling node model.dbt_tutorial.mart_sales_by_category
[0m17:49:59.404271 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_tutorial.mart_sales_by_category"
[0m17:49:59.409761 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (compile): 17:49:59.400022 => 17:49:59.409600
[0m17:49:59.410322 [debug] [Thread-3 (]: Began executing node model.dbt_tutorial.mart_sales_by_category
[0m17:49:59.410934 [debug] [Thread-3 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (execute): 17:49:59.410785 => 17:49:59.410792
[0m17:49:59.411820 [debug] [Thread-3 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m17:49:59.413349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:59.413852 [debug] [MainThread]: Connection 'test.dbt_tutorial.unique_stg_product_productid.90ff986d4a' was properly closed.
[0m17:49:59.414377 [debug] [MainThread]: Connection 'test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a' was properly closed.
[0m17:49:59.414833 [debug] [MainThread]: Connection 'model.dbt_tutorial.mart_sales_by_category' was properly closed.
[0m17:49:59.415342 [debug] [MainThread]: Connection 'test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee' was properly closed.
[0m17:49:59.416384 [debug] [MainThread]: Command end result
[0m17:49:59.449415 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:49:59.450036 [info ] [MainThread]: Building catalog
[0m17:49:59.451883 [debug] [ThreadPool]: Acquiring new postgres connection 'Adventureworks.information_schema'
[0m17:49:59.457314 [debug] [ThreadPool]: Using postgres connection "Adventureworks.information_schema"
[0m17:49:59.458259 [debug] [ThreadPool]: On Adventureworks.information_schema: BEGIN
[0m17:49:59.459018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:59.464692 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:49:59.465650 [debug] [ThreadPool]: Using postgres connection "Adventureworks.information_schema"
[0m17:49:59.466470 [debug] [ThreadPool]: On Adventureworks.information_schema: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "Adventureworks.information_schema"} */

    
    

    select
        'Adventureworks' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('teste') or upper(sch.nspname) = upper('sales') or upper(sch.nspname) = upper('production'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:49:59.473538 [debug] [ThreadPool]: SQL status: SELECT 438 in 0.0 seconds
[0m17:49:59.486114 [debug] [ThreadPool]: On Adventureworks.information_schema: ROLLBACK
[0m17:49:59.487231 [debug] [ThreadPool]: On Adventureworks.information_schema: Close
[0m17:49:59.502818 [info ] [MainThread]: Catalog written to /mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/target/catalog.json
[0m17:49:59.504113 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:49:59.504002 after 1.72 seconds
[0m17:49:59.504705 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:49:59.505308 [debug] [MainThread]: Connection 'Adventureworks.information_schema' was properly closed.
[0m17:49:59.505938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb2cf65a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb2a7188e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb2a7198d0>]}
[0m17:49:59.506609 [debug] [MainThread]: Flushing usage events
[0m17:50:12.463465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6aa8da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f69501b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f69501b40>]}


============================== 17:50:12.469377 | f393cd4b-eebb-42cf-9332-5d38d7c663c0 ==============================
[0m17:50:12.469377 [info ] [MainThread]: Running with dbt=1.5.11
[0m17:50:12.470138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:50:12.753786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f393cd4b-eebb-42cf-9332-5d38d7c663c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f695019c0>]}
[0m17:50:12.770236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f393cd4b-eebb-42cf-9332-5d38d7c663c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f68d0c8b0>]}
[0m17:52:37.879773 [error] [MainThread]: Encountered an error:

[0m17:52:37.893227 [error] [MainThread]: Traceback (most recent call last):
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/cli/main.py", line 315, in docs_serve
    results = task.run()
  File "/mnt/d/Treinamento dbt/.venv/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 237, in serve_forever
    self._handle_request_noblock()
  File "/usr/lib/python3.10/socketserver.py", line 316, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/lib/python3.10/socketserver.py", line 347, in process_request
    self.finish_request(request, client_address)
  File "/usr/lib/python3.10/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/lib/python3.10/http/server.py", line 668, in __init__
    super().__init__(*args, **kwargs)
  File "/usr/lib/python3.10/socketserver.py", line 747, in __init__
    self.handle()
  File "/usr/lib/python3.10/http/server.py", line 433, in handle
    self.handle_one_request()
  File "/usr/lib/python3.10/http/server.py", line 401, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
KeyboardInterrupt

[0m17:52:37.894480 [debug] [MainThread]: Command `dbt docs serve` failed at 17:52:37.894371 after 145.44 seconds
[0m17:52:37.895205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f6aa8da20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f68d0fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0f68d0fa90>]}
[0m17:52:37.895852 [debug] [MainThread]: Flushing usage events
[0m18:16:38.115863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee06acda20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0560dcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0560dc90>]}


============================== 18:16:38.122020 | 6e1241fd-e609-450d-be30-0f401e09c27e ==============================
[0m18:16:38.122020 [info ] [MainThread]: Running with dbt=1.5.11
[0m18:16:38.122819 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:16:38.411385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e1241fd-e609-450d-be30-0f401e09c27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0560de10>]}
[0m18:16:38.427814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e1241fd-e609-450d-be30-0f401e09c27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee04d088b0>]}
[0m18:16:38.435556 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m18:16:38.461823 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m18:16:38.504987 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:16:38.505829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e1241fd-e609-450d-be30-0f401e09c27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee04d16320>]}
[0m18:16:40.062788 [debug] [MainThread]: 1699: static parser successfully parsed int/int_sales_by_product.sql
[0m18:16:40.073250 [debug] [MainThread]: 1699: static parser successfully parsed mart/mart_sales_by_category.sql
[0m18:16:40.076525 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_product.sql
[0m18:16:40.079749 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_product_category.sql
[0m18:16:40.083243 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_order_detail.sql
[0m18:16:40.162806 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_tutorial.test_due_date_before_order_date' (tests/test_due_date_before_order_date.sql) depends on a node named 'sales_order_header' in package '' which was not found
[0m18:16:40.186735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e1241fd-e609-450d-be30-0f401e09c27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee04df4f70>]}
[0m18:16:40.197978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e1241fd-e609-450d-be30-0f401e09c27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee049b7f70>]}
[0m18:16:40.198774 [info ] [MainThread]: Found 5 models, 3 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m18:16:40.199494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e1241fd-e609-450d-be30-0f401e09c27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee049b5b70>]}
[0m18:16:40.201050 [info ] [MainThread]: 
[0m18:16:40.202059 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:16:40.203211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m18:16:40.211655 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m18:16:40.212420 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m18:16:40.213068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:40.273236 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m18:16:40.274782 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m18:16:40.276416 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now list_Adventureworks_teste)
[0m18:16:40.281161 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m18:16:40.281789 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m18:16:40.282411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:16:40.287430 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:16:40.288109 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m18:16:40.288649 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m18:16:40.291133 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:16:40.292392 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m18:16:40.293155 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m18:16:40.297009 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:40.297643 [debug] [MainThread]: On master: BEGIN
[0m18:16:40.298172 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:40.303028 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:16:40.303577 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:40.304206 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:16:40.308885 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m18:16:40.312249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e1241fd-e609-450d-be30-0f401e09c27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee04d09d20>]}
[0m18:16:40.312920 [debug] [MainThread]: On master: ROLLBACK
[0m18:16:40.313663 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:40.314193 [debug] [MainThread]: On master: BEGIN
[0m18:16:40.315120 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:16:40.315726 [debug] [MainThread]: On master: COMMIT
[0m18:16:40.316368 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:40.316903 [debug] [MainThread]: On master: COMMIT
[0m18:16:40.317605 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:16:40.318130 [debug] [MainThread]: On master: Close
[0m18:16:40.318951 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:16:40.319563 [info ] [MainThread]: 
[0m18:16:40.323783 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m18:16:40.324685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m18:16:40.325363 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m18:16:40.331793 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m18:16:40.337199 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 18:16:40.325830 => 18:16:40.336977
[0m18:16:40.338215 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m18:16:40.338834 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product_category
[0m18:16:40.339584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product, now model.dbt_tutorial.stg_product_category)
[0m18:16:40.340145 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m18:16:40.342647 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m18:16:40.348386 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 18:16:40.340625 => 18:16:40.348204
[0m18:16:40.349332 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m18:16:40.349994 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m18:16:40.350744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product_category, now model.dbt_tutorial.stg_sales_order_detail)
[0m18:16:40.351300 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m18:16:40.353727 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m18:16:40.358607 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 18:16:40.351743 => 18:16:40.358448
[0m18:16:40.359536 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m18:16:40.360576 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m18:16:40.361318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_sales_order_detail, now model.dbt_tutorial.int_sales_by_product)
[0m18:16:40.361852 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.int_sales_by_product
[0m18:16:40.367652 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.int_sales_by_product"
[0m18:16:40.372918 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.int_sales_by_product (compile): 18:16:40.362348 => 18:16:40.372746
[0m18:16:40.373849 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m18:16:40.374939 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m18:16:40.375612 [info ] [Thread-1 (]: 1 of 1 START sql table model teste.mart_sales_by_category ...................... [RUN]
[0m18:16:40.376569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.int_sales_by_product, now model.dbt_tutorial.mart_sales_by_category)
[0m18:16:40.377171 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.mart_sales_by_category
[0m18:16:40.381945 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.mart_sales_by_category"
[0m18:16:40.387652 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (compile): 18:16:40.377659 => 18:16:40.387467
[0m18:16:40.388248 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.mart_sales_by_category
[0m18:16:40.419349 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.mart_sales_by_category"
[0m18:16:40.425588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:16:40.426692 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: BEGIN
[0m18:16:40.427492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:40.433584 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:16:40.434336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:16:40.434968 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */

  
    

  create  table "Adventureworks"."teste"."mart_sales_by_category__dbt_tmp"
  
  
    as
  
  (
    

WITH  __dbt__cte__stg_sales_order_detail as (


SELECT
    salesorderid,
    ProductID,
    OrderQty,
    unitprice
FROM
    "Adventureworks"."sales"."salesorderdetail"
),  __dbt__cte__stg_product as (


SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
),  __dbt__cte__int_sales_by_product as (


WITH sales AS (
    SELECT
        sod.ProductID,
        SUM(sod.unitprice) AS TotalSales
    FROM __dbt__cte__stg_sales_order_detail sod
    GROUP BY sod.ProductID
)
SELECT 
    s.ProductID,
    s.TotalSales,
    p.ProductSubcategoryID
FROM sales s
JOIN __dbt__cte__stg_product p ON s.ProductID = p.ProductID
),  __dbt__cte__stg_product_category as (


SELECT
    ProductCategoryID,
    Name AS CategoryName
FROM
    "Adventureworks"."production"."productcategory"
),category_sales AS (
    SELECT
        pc.CategoryName,
        SUM(sp.TotalSales) AS TotalSales
    FROM __dbt__cte__int_sales_by_product sp
    JOIN __dbt__cte__stg_product_category pc 
        ON sp.ProductSubcategoryID = pc.ProductCategoryID
    GROUP BY pc.CategoryName
)
SELECT * FROM category_sales
  );
  
[0m18:16:40.470363 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.0 seconds
[0m18:16:40.475812 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:16:40.476512 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
alter table "Adventureworks"."teste"."mart_sales_by_category" rename to "mart_sales_by_category__dbt_backup"
[0m18:16:40.477527 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:16:40.479944 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:16:40.480518 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
alter table "Adventureworks"."teste"."mart_sales_by_category__dbt_tmp" rename to "mart_sales_by_category"
[0m18:16:40.481444 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:16:40.496887 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: COMMIT
[0m18:16:40.497560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:16:40.498119 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: COMMIT
[0m18:16:40.501696 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:16:40.505892 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:16:40.506545 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
drop table if exists "Adventureworks"."teste"."mart_sales_by_category__dbt_backup" cascade
[0m18:16:40.510932 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:16:40.512400 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (execute): 18:16:40.388759 => 18:16:40.512245
[0m18:16:40.512959 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: Close
[0m18:16:40.513810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e1241fd-e609-450d-be30-0f401e09c27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee049db9d0>]}
[0m18:16:40.514553 [info ] [Thread-1 (]: 1 of 1 OK created sql table model teste.mart_sales_by_category ................. [[32mSELECT 4[0m in 0.14s]
[0m18:16:40.515439 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m18:16:40.517167 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:40.517761 [debug] [MainThread]: On master: BEGIN
[0m18:16:40.518272 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:16:40.523357 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:16:40.524024 [debug] [MainThread]: On master: COMMIT
[0m18:16:40.524620 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:40.525140 [debug] [MainThread]: On master: COMMIT
[0m18:16:40.525831 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:16:40.526456 [debug] [MainThread]: On master: Close
[0m18:16:40.527336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:40.527947 [debug] [MainThread]: Connection 'model.dbt_tutorial.mart_sales_by_category' was properly closed.
[0m18:16:40.528551 [info ] [MainThread]: 
[0m18:16:40.529220 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m18:16:40.530122 [debug] [MainThread]: Command end result
[0m18:16:40.540598 [info ] [MainThread]: 
[0m18:16:40.541438 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:16:40.542174 [info ] [MainThread]: 
[0m18:16:40.542920 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:16:40.543778 [debug] [MainThread]: Command `dbt run` succeeded at 18:16:40.543668 after 2.44 seconds
[0m18:16:40.544521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee06acda20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee06894d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee05693ac0>]}
[0m18:16:40.545131 [debug] [MainThread]: Flushing usage events
[0m18:17:45.308606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d45c25a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d448fdc60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d448fdc30>]}


============================== 18:17:45.316667 | c80b3dcd-9ba8-4a97-b190-30fbbd2bf5c5 ==============================
[0m18:17:45.316667 [info ] [MainThread]: Running with dbt=1.5.11
[0m18:17:45.317467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:17:45.589184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c80b3dcd-9ba8-4a97-b190-30fbbd2bf5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d448fddb0>]}
[0m18:17:45.605178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c80b3dcd-9ba8-4a97-b190-30fbbd2bf5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d447f88b0>]}
[0m18:17:45.611519 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m18:17:45.634225 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m18:17:46.771003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m18:17:46.771838 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product_category.sql
[0m18:17:46.772489 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_sales_order_detail.sql
[0m18:17:46.773081 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/int/int_sales_by_product.sql
[0m18:17:46.773686 [debug] [MainThread]: Partial parsing: updated file: dbt_tutorial://models/teste/staging/stg_product.sql
[0m18:17:46.798250 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_product_category.sql
[0m18:17:46.808913 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_sales_order_detail.sql
[0m18:17:46.812456 [debug] [MainThread]: 1699: static parser successfully parsed int/int_sales_by_product.sql
[0m18:17:46.815911 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_product.sql
[0m18:17:46.861552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c80b3dcd-9ba8-4a97-b190-30fbbd2bf5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d43be4b80>]}
[0m18:17:46.873926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c80b3dcd-9ba8-4a97-b190-30fbbd2bf5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d43f049a0>]}
[0m18:17:46.874902 [info ] [MainThread]: Found 5 models, 3 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m18:17:46.875766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c80b3dcd-9ba8-4a97-b190-30fbbd2bf5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d43f041f0>]}
[0m18:17:46.877556 [info ] [MainThread]: 
[0m18:17:46.878607 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:17:46.880724 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m18:17:46.889944 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m18:17:46.890908 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m18:17:46.891593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:46.963258 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m18:17:46.964910 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m18:17:46.967066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now list_Adventureworks_teste)
[0m18:17:46.972029 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m18:17:46.972770 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m18:17:46.973307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:46.978582 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:17:46.979242 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m18:17:46.979855 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m18:17:46.982330 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:17:46.983812 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m18:17:46.984535 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m18:17:46.988465 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:46.989079 [debug] [MainThread]: On master: BEGIN
[0m18:17:46.989664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:46.994606 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:46.995222 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:46.995810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:17:47.000502 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m18:17:47.003865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c80b3dcd-9ba8-4a97-b190-30fbbd2bf5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d43be4670>]}
[0m18:17:47.004575 [debug] [MainThread]: On master: ROLLBACK
[0m18:17:47.005285 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:47.005821 [debug] [MainThread]: On master: BEGIN
[0m18:17:47.006785 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:47.007374 [debug] [MainThread]: On master: COMMIT
[0m18:17:47.007898 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:47.008444 [debug] [MainThread]: On master: COMMIT
[0m18:17:47.009143 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:17:47.009695 [debug] [MainThread]: On master: Close
[0m18:17:47.010449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:47.011182 [info ] [MainThread]: 
[0m18:17:47.014276 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m18:17:47.015093 [info ] [Thread-1 (]: 1 of 5 START sql table model teste.stg_product ................................. [RUN]
[0m18:17:47.016053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m18:17:47.016707 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m18:17:47.023271 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m18:17:47.029301 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 18:17:47.017273 => 18:17:47.029098
[0m18:17:47.029962 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_product
[0m18:17:47.059858 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product"
[0m18:17:47.064992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:17:47.065571 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: BEGIN
[0m18:17:47.066155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:47.071585 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:17:47.072443 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:17:47.073100 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */

  
    

  create  table "Adventureworks"."teste"."stg_product__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
  );
  
[0m18:17:47.075899 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.0 seconds
[0m18:17:47.081018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:17:47.081672 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
alter table "Adventureworks"."teste"."stg_product__dbt_tmp" rename to "stg_product"
[0m18:17:47.082613 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:47.102273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:17:47.102973 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */

    
  
  comment on table "Adventureworks"."teste"."stg_product" is $dbt_comment_literal_block$Modelo de produtos$dbt_comment_literal_block$;

  
[0m18:17:47.104400 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m18:17:47.113330 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:17:47.113965 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "Adventureworks".INFORMATION_SCHEMA.columns
      where table_name = 'stg_product'
        
        and table_schema = 'teste'
        
      order by ordinal_position

  
[0m18:17:47.119373 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m18:17:47.122486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:17:47.123198 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */

    
  
  
    
    
    comment on column "Adventureworks"."teste"."stg_product".productid is $dbt_comment_literal_block$ID do produto$dbt_comment_literal_block$;
  

  
[0m18:17:47.124005 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m18:17:47.125128 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m18:17:47.125682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:17:47.126248 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m18:17:47.129790 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:17:47.133908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:17:47.134502 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
drop table if exists "Adventureworks"."teste"."stg_product__dbt_backup" cascade
[0m18:17:47.135424 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:17:47.136774 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (execute): 18:17:47.030460 => 18:17:47.136622
[0m18:17:47.137362 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: Close
[0m18:17:47.138181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c80b3dcd-9ba8-4a97-b190-30fbbd2bf5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d437cd9c0>]}
[0m18:17:47.139012 [info ] [Thread-1 (]: 1 of 5 OK created sql table model teste.stg_product ............................ [[32mSELECT 504[0m in 0.12s]
[0m18:17:47.139835 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m18:17:47.140583 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product_category
[0m18:17:47.141240 [info ] [Thread-1 (]: 2 of 5 START sql table model teste.stg_product_category ........................ [RUN]
[0m18:17:47.142092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product, now model.dbt_tutorial.stg_product_category)
[0m18:17:47.142645 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m18:17:47.145090 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m18:17:47.150963 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 18:17:47.143121 => 18:17:47.150746
[0m18:17:47.151616 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_product_category
[0m18:17:47.155383 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product_category"
[0m18:17:47.161118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m18:17:47.161781 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product_category: BEGIN
[0m18:17:47.162342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:47.167968 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:17:47.168766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m18:17:47.169333 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */

  
    

  create  table "Adventureworks"."teste"."stg_product_category__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    ProductCategoryID,
    Name AS CategoryName
FROM
    "Adventureworks"."production"."productcategory"
  );
  
[0m18:17:47.171463 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.0 seconds
[0m18:17:47.174207 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m18:17:47.174837 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
alter table "Adventureworks"."teste"."stg_product_category__dbt_tmp" rename to "stg_product_category"
[0m18:17:47.175812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:47.177701 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m18:17:47.178275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m18:17:47.178829 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m18:17:47.182192 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:17:47.184430 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m18:17:47.185015 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
drop table if exists "Adventureworks"."teste"."stg_product_category__dbt_backup" cascade
[0m18:17:47.185833 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:17:47.187179 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product_category (execute): 18:17:47.152154 => 18:17:47.187033
[0m18:17:47.187752 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product_category: Close
[0m18:17:47.188553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c80b3dcd-9ba8-4a97-b190-30fbbd2bf5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d437e8250>]}
[0m18:17:47.189316 [info ] [Thread-1 (]: 2 of 5 OK created sql table model teste.stg_product_category ................... [[32mSELECT 4[0m in 0.05s]
[0m18:17:47.190144 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m18:17:47.190849 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m18:17:47.191472 [info ] [Thread-1 (]: 3 of 5 START sql table model teste.stg_sales_order_detail ...................... [RUN]
[0m18:17:47.192448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product_category, now model.dbt_tutorial.stg_sales_order_detail)
[0m18:17:47.193038 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m18:17:47.195550 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m18:17:47.201422 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 18:17:47.193523 => 18:17:47.201203
[0m18:17:47.202036 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_sales_order_detail
[0m18:17:47.206509 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.stg_sales_order_detail"
[0m18:17:47.211855 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:17:47.212454 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: BEGIN
[0m18:17:47.213159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:47.218766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:17:47.219748 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:17:47.220435 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */

  
    

  create  table "Adventureworks"."teste"."stg_sales_order_detail__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    salesorderid,
    ProductID,
    OrderQty,
    unitprice
FROM
    "Adventureworks"."sales"."salesorderdetail"
  );
  
[0m18:17:47.293040 [debug] [Thread-1 (]: SQL status: SELECT 121317 in 0.0 seconds
[0m18:17:47.296192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:17:47.296946 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */
alter table "Adventureworks"."teste"."stg_sales_order_detail__dbt_tmp" rename to "stg_sales_order_detail"
[0m18:17:47.297970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:47.300106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:17:47.300742 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */

    
  
  comment on table "Adventureworks"."teste"."stg_sales_order_detail" is $dbt_comment_literal_block$Modelo de TESTE$dbt_comment_literal_block$;

  
[0m18:17:47.301828 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m18:17:47.304646 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:17:47.305342 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "Adventureworks".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sales_order_detail'
        
        and table_schema = 'teste'
        
      order by ordinal_position

  
[0m18:17:47.310932 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.0 seconds
[0m18:17:47.312766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:17:47.313370 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */

    
  
  
    
    
    comment on column "Adventureworks"."teste"."stg_sales_order_detail".salesorderid is $dbt_comment_literal_block$TESTE$dbt_comment_literal_block$;
  

  
[0m18:17:47.314252 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m18:17:47.315358 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: COMMIT
[0m18:17:47.316041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:17:47.316647 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: COMMIT
[0m18:17:47.334422 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:17:47.336888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:17:47.337597 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */
drop table if exists "Adventureworks"."teste"."stg_sales_order_detail__dbt_backup" cascade
[0m18:17:47.338531 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:17:47.339894 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (execute): 18:17:47.202524 => 18:17:47.339746
[0m18:17:47.340474 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: Close
[0m18:17:47.341322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c80b3dcd-9ba8-4a97-b190-30fbbd2bf5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d437f98d0>]}
[0m18:17:47.342033 [info ] [Thread-1 (]: 3 of 5 OK created sql table model teste.stg_sales_order_detail ................. [[32mSELECT 121317[0m in 0.15s]
[0m18:17:47.342917 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m18:17:47.344090 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m18:17:47.344774 [info ] [Thread-1 (]: 4 of 5 START sql table model teste.int_sales_by_product ........................ [RUN]
[0m18:17:47.345609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_sales_order_detail, now model.dbt_tutorial.int_sales_by_product)
[0m18:17:47.346242 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.int_sales_by_product
[0m18:17:47.348952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.int_sales_by_product"
[0m18:17:47.354778 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.int_sales_by_product (compile): 18:17:47.346734 => 18:17:47.354521
[0m18:17:47.355634 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.int_sales_by_product
[0m18:17:47.359648 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.int_sales_by_product"
[0m18:17:47.365526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m18:17:47.366173 [debug] [Thread-1 (]: On model.dbt_tutorial.int_sales_by_product: BEGIN
[0m18:17:47.366742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:47.371993 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:17:47.372751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m18:17:47.373381 [debug] [Thread-1 (]: On model.dbt_tutorial.int_sales_by_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.int_sales_by_product"} */

  
    

  create  table "Adventureworks"."teste"."int_sales_by_product__dbt_tmp"
  
  
    as
  
  (
    

WITH sales AS (
    SELECT
        sod.ProductID,
        SUM(sod.unitprice) AS TotalSales
    FROM "Adventureworks"."teste"."stg_sales_order_detail" sod
    GROUP BY sod.ProductID
)
SELECT 
    s.ProductID,
    s.TotalSales,
    p.ProductSubcategoryID
FROM sales s
JOIN "Adventureworks"."teste"."stg_product" p ON s.ProductID = p.ProductID
  );
  
[0m18:17:47.400283 [debug] [Thread-1 (]: SQL status: SELECT 266 in 0.0 seconds
[0m18:17:47.403343 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m18:17:47.404107 [debug] [Thread-1 (]: On model.dbt_tutorial.int_sales_by_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.int_sales_by_product"} */
alter table "Adventureworks"."teste"."int_sales_by_product__dbt_tmp" rename to "int_sales_by_product"
[0m18:17:47.405074 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:47.406918 [debug] [Thread-1 (]: On model.dbt_tutorial.int_sales_by_product: COMMIT
[0m18:17:47.407480 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m18:17:47.408044 [debug] [Thread-1 (]: On model.dbt_tutorial.int_sales_by_product: COMMIT
[0m18:17:47.411723 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:17:47.413949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m18:17:47.414533 [debug] [Thread-1 (]: On model.dbt_tutorial.int_sales_by_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.int_sales_by_product"} */
drop table if exists "Adventureworks"."teste"."int_sales_by_product__dbt_backup" cascade
[0m18:17:47.415332 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:17:47.416714 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.int_sales_by_product (execute): 18:17:47.356376 => 18:17:47.416563
[0m18:17:47.417297 [debug] [Thread-1 (]: On model.dbt_tutorial.int_sales_by_product: Close
[0m18:17:47.418178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c80b3dcd-9ba8-4a97-b190-30fbbd2bf5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d437ce470>]}
[0m18:17:47.418968 [info ] [Thread-1 (]: 4 of 5 OK created sql table model teste.int_sales_by_product ................... [[32mSELECT 266[0m in 0.07s]
[0m18:17:47.419762 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m18:17:47.420895 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m18:17:47.421539 [info ] [Thread-1 (]: 5 of 5 START sql table model teste.mart_sales_by_category ...................... [RUN]
[0m18:17:47.422386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.int_sales_by_product, now model.dbt_tutorial.mart_sales_by_category)
[0m18:17:47.422933 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.mart_sales_by_category
[0m18:17:47.425541 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.mart_sales_by_category"
[0m18:17:47.430955 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (compile): 18:17:47.423390 => 18:17:47.430758
[0m18:17:47.431580 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.mart_sales_by_category
[0m18:17:47.436514 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.mart_sales_by_category"
[0m18:17:47.441846 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:17:47.442577 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: BEGIN
[0m18:17:47.443218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:47.448955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:17:47.449905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:17:47.450584 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */

  
    

  create  table "Adventureworks"."teste"."mart_sales_by_category__dbt_tmp"
  
  
    as
  
  (
    

WITH category_sales AS (
    SELECT
        pc.CategoryName,
        SUM(sp.TotalSales) AS TotalSales
    FROM "Adventureworks"."teste"."int_sales_by_product" sp
    JOIN "Adventureworks"."teste"."stg_product_category" pc 
        ON sp.ProductSubcategoryID = pc.ProductCategoryID
    GROUP BY pc.CategoryName
)
SELECT * FROM category_sales
  );
  
[0m18:17:47.453340 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.0 seconds
[0m18:17:47.456197 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:17:47.456848 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
alter table "Adventureworks"."teste"."mart_sales_by_category" rename to "mart_sales_by_category__dbt_backup"
[0m18:17:47.457753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:47.460081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:17:47.460653 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
alter table "Adventureworks"."teste"."mart_sales_by_category__dbt_tmp" rename to "mart_sales_by_category"
[0m18:17:47.461738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:47.465233 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: COMMIT
[0m18:17:47.465960 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:17:47.466557 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: COMMIT
[0m18:17:47.470058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:17:47.472210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:17:47.472830 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
drop table if exists "Adventureworks"."teste"."mart_sales_by_category__dbt_backup" cascade
[0m18:17:47.476774 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:17:47.478225 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (execute): 18:17:47.432140 => 18:17:47.478075
[0m18:17:47.478795 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: Close
[0m18:17:47.479657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c80b3dcd-9ba8-4a97-b190-30fbbd2bf5c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d437ce6b0>]}
[0m18:17:47.480385 [info ] [Thread-1 (]: 5 of 5 OK created sql table model teste.mart_sales_by_category ................. [[32mSELECT 4[0m in 0.06s]
[0m18:17:47.481391 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m18:17:47.482967 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:47.483601 [debug] [MainThread]: On master: BEGIN
[0m18:17:47.484135 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:17:47.489192 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:47.489882 [debug] [MainThread]: On master: COMMIT
[0m18:17:47.490394 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:47.490953 [debug] [MainThread]: On master: COMMIT
[0m18:17:47.491721 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:17:47.492435 [debug] [MainThread]: On master: Close
[0m18:17:47.493237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:47.493809 [debug] [MainThread]: Connection 'model.dbt_tutorial.mart_sales_by_category' was properly closed.
[0m18:17:47.494424 [info ] [MainThread]: 
[0m18:17:47.495157 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m18:17:47.496568 [debug] [MainThread]: Command end result
[0m18:17:47.506145 [info ] [MainThread]: 
[0m18:17:47.507027 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:47.507705 [info ] [MainThread]: 
[0m18:17:47.508378 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:17:47.509311 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:47.509211 after 2.22 seconds
[0m18:17:47.510191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d45c25a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d433064d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d43346050>]}
[0m18:17:47.510963 [debug] [MainThread]: Flushing usage events
[0m18:18:10.189164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554de99a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554ca01c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554ca01c30>]}


============================== 18:18:10.195242 | eccc538a-9421-42d0-a410-01f2e70b7dad ==============================
[0m18:18:10.195242 [info ] [MainThread]: Running with dbt=1.5.11
[0m18:18:10.196000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial/logs', 'version_check': 'True', 'profiles_dir': '/mnt/d/Treinamento dbt/dbt-tutorial/dbt_tutorial', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:18:10.472475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eccc538a-9421-42d0-a410-01f2e70b7dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554ca01db0>]}
[0m18:18:10.488732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eccc538a-9421-42d0-a410-01f2e70b7dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554cafc8b0>]}
[0m18:18:10.494875 [info ] [MainThread]: Registered adapter: postgres=1.5.11
[0m18:18:10.517550 [debug] [MainThread]: checksum: 007b492a958e08141e13011e4198bea48e7f359a98b57e51b7a963fca8fc83af, vars: {}, profile: , target: , version: 1.5.11
[0m18:18:11.593118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:18:11.593803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:18:11.598553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eccc538a-9421-42d0-a410-01f2e70b7dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554bd89960>]}
[0m18:18:11.608146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eccc538a-9421-42d0-a410-01f2e70b7dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554c1085b0>]}
[0m18:18:11.608834 [info ] [MainThread]: Found 5 models, 3 tests, 0 snapshots, 0 analyses, 310 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m18:18:11.609511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eccc538a-9421-42d0-a410-01f2e70b7dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554c1086a0>]}
[0m18:18:11.610964 [info ] [MainThread]: 
[0m18:18:11.611867 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:18:11.613509 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks'
[0m18:18:11.622110 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks"
[0m18:18:11.623033 [debug] [ThreadPool]: On list_Adventureworks: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks"} */

    select distinct nspname from pg_namespace
  
[0m18:18:11.623572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:11.679620 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m18:18:11.681078 [debug] [ThreadPool]: On list_Adventureworks: Close
[0m18:18:11.682689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_Adventureworks, now list_Adventureworks_teste)
[0m18:18:11.687635 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m18:18:11.688186 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m18:18:11.688715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:18:11.693846 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:18:11.694588 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m18:18:11.695152 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
  
[0m18:18:11.697609 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:18:11.698937 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m18:18:11.699653 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m18:18:11.704020 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:11.704673 [debug] [MainThread]: On master: BEGIN
[0m18:18:11.705265 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:18:11.710169 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:18:11.710719 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:11.711284 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:18:11.715903 [debug] [MainThread]: SQL status: SELECT 146 in 0.0 seconds
[0m18:18:11.719206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eccc538a-9421-42d0-a410-01f2e70b7dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554bdca920>]}
[0m18:18:11.719848 [debug] [MainThread]: On master: ROLLBACK
[0m18:18:11.720569 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:11.721071 [debug] [MainThread]: On master: BEGIN
[0m18:18:11.721957 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:18:11.722486 [debug] [MainThread]: On master: COMMIT
[0m18:18:11.722986 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:11.723481 [debug] [MainThread]: On master: COMMIT
[0m18:18:11.724177 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:18:11.724725 [debug] [MainThread]: On master: Close
[0m18:18:11.725490 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:18:11.726118 [info ] [MainThread]: 
[0m18:18:11.729415 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m18:18:11.730052 [info ] [Thread-1 (]: 1 of 5 START sql table model teste.stg_product ................................. [RUN]
[0m18:18:11.730922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m18:18:11.731514 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m18:18:11.737967 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m18:18:11.743537 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (compile): 18:18:11.731999 => 18:18:11.743317
[0m18:18:11.744168 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_product
[0m18:18:11.774123 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product"
[0m18:18:11.779724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:18:11.780458 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: BEGIN
[0m18:18:11.781045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:11.786482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:18:11.787216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:18:11.787858 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */

  
    

  create  table "Adventureworks"."teste"."stg_product__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    ProductID,
    Name AS ProductName,
    ProductSubcategoryID
FROM
    "Adventureworks"."production"."product"
  );
  
[0m18:18:11.790452 [debug] [Thread-1 (]: SQL status: SELECT 504 in 0.0 seconds
[0m18:18:11.795842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:18:11.796532 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
alter table "Adventureworks"."teste"."stg_product" rename to "stg_product__dbt_backup"
[0m18:18:11.797548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:11.800018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:18:11.800673 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
alter table "Adventureworks"."teste"."stg_product__dbt_tmp" rename to "stg_product"
[0m18:18:11.801612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:11.823644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:18:11.824417 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */

    
  
  comment on table "Adventureworks"."teste"."stg_product" is $dbt_comment_literal_block$Modelo de produtos$dbt_comment_literal_block$;

  
[0m18:18:11.825506 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m18:18:11.834479 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:18:11.835122 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "Adventureworks".INFORMATION_SCHEMA.columns
      where table_name = 'stg_product'
        
        and table_schema = 'teste'
        
      order by ordinal_position

  
[0m18:18:11.840563 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.0 seconds
[0m18:18:11.843631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:18:11.844230 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */

    
  
  
    
    
    comment on column "Adventureworks"."teste"."stg_product".productid is $dbt_comment_literal_block$ID do produto$dbt_comment_literal_block$;
  

  
[0m18:18:11.845067 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m18:18:11.846205 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m18:18:11.846759 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:18:11.847341 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: COMMIT
[0m18:18:11.850898 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:18:11.855081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product"
[0m18:18:11.855703 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product"} */
drop table if exists "Adventureworks"."teste"."stg_product__dbt_backup" cascade
[0m18:18:11.859588 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:18:11.861024 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product (execute): 18:18:11.744672 => 18:18:11.860873
[0m18:18:11.861582 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product: Close
[0m18:18:11.862420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eccc538a-9421-42d0-a410-01f2e70b7dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554b958670>]}
[0m18:18:11.863151 [info ] [Thread-1 (]: 1 of 5 OK created sql table model teste.stg_product ............................ [[32mSELECT 504[0m in 0.13s]
[0m18:18:11.863964 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m18:18:11.864714 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product_category
[0m18:18:11.865358 [info ] [Thread-1 (]: 2 of 5 START sql table model teste.stg_product_category ........................ [RUN]
[0m18:18:11.866209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product, now model.dbt_tutorial.stg_product_category)
[0m18:18:11.866814 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m18:18:11.869265 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m18:18:11.874679 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product_category (compile): 18:18:11.867286 => 18:18:11.874503
[0m18:18:11.875275 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_product_category
[0m18:18:11.879538 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.stg_product_category"
[0m18:18:11.884507 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m18:18:11.885047 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product_category: BEGIN
[0m18:18:11.885591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:11.890742 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:18:11.891367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m18:18:11.891930 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */

  
    

  create  table "Adventureworks"."teste"."stg_product_category__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    ProductCategoryID,
    Name AS CategoryName
FROM
    "Adventureworks"."production"."productcategory"
  );
  
[0m18:18:11.894525 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.0 seconds
[0m18:18:11.897408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m18:18:11.897987 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
alter table "Adventureworks"."teste"."stg_product_category" rename to "stg_product_category__dbt_backup"
[0m18:18:11.898909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:11.901084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m18:18:11.901646 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
alter table "Adventureworks"."teste"."stg_product_category__dbt_tmp" rename to "stg_product_category"
[0m18:18:11.902442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:11.904284 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m18:18:11.904840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m18:18:11.905384 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product_category: COMMIT
[0m18:18:11.908570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:18:11.910904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_product_category"
[0m18:18:11.911503 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_product_category"} */
drop table if exists "Adventureworks"."teste"."stg_product_category__dbt_backup" cascade
[0m18:18:11.915419 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:18:11.916863 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_product_category (execute): 18:18:11.875879 => 18:18:11.916710
[0m18:18:11.917408 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_product_category: Close
[0m18:18:11.918209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eccc538a-9421-42d0-a410-01f2e70b7dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554b9b2980>]}
[0m18:18:11.918958 [info ] [Thread-1 (]: 2 of 5 OK created sql table model teste.stg_product_category ................... [[32mSELECT 4[0m in 0.05s]
[0m18:18:11.919797 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m18:18:11.920442 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m18:18:11.921063 [info ] [Thread-1 (]: 3 of 5 START sql table model teste.stg_sales_order_detail ...................... [RUN]
[0m18:18:11.921846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product_category, now model.dbt_tutorial.stg_sales_order_detail)
[0m18:18:11.922377 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m18:18:11.925729 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m18:18:11.931132 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (compile): 18:18:11.922816 => 18:18:11.930932
[0m18:18:11.931704 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_sales_order_detail
[0m18:18:11.935180 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.stg_sales_order_detail"
[0m18:18:11.940056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:18:11.940613 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: BEGIN
[0m18:18:11.941153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:11.946602 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:18:11.947505 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:18:11.948156 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */

  
    

  create  table "Adventureworks"."teste"."stg_sales_order_detail__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    salesorderid,
    ProductID,
    OrderQty,
    unitprice
FROM
    "Adventureworks"."sales"."salesorderdetail"
  );
  
[0m18:18:12.011068 [debug] [Thread-1 (]: SQL status: SELECT 121317 in 0.0 seconds
[0m18:18:12.014102 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:18:12.014726 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */
alter table "Adventureworks"."teste"."stg_sales_order_detail" rename to "stg_sales_order_detail__dbt_backup"
[0m18:18:12.015678 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:12.017925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:18:12.018516 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */
alter table "Adventureworks"."teste"."stg_sales_order_detail__dbt_tmp" rename to "stg_sales_order_detail"
[0m18:18:12.019370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:12.021506 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:18:12.022065 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */

    
  
  comment on table "Adventureworks"."teste"."stg_sales_order_detail" is $dbt_comment_literal_block$Modelo de TESTE$dbt_comment_literal_block$;

  
[0m18:18:12.022936 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m18:18:12.025381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:18:12.025967 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "Adventureworks".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sales_order_detail'
        
        and table_schema = 'teste'
        
      order by ordinal_position

  
[0m18:18:12.031176 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.0 seconds
[0m18:18:12.032899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:18:12.033468 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */

    
  
  
    
    
    comment on column "Adventureworks"."teste"."stg_sales_order_detail".salesorderid is $dbt_comment_literal_block$TESTE$dbt_comment_literal_block$;
  

  
[0m18:18:12.034279 [debug] [Thread-1 (]: SQL status: COMMENT in 0.0 seconds
[0m18:18:12.035339 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: COMMIT
[0m18:18:12.035885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:18:12.036495 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: COMMIT
[0m18:18:12.054916 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:18:12.057252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.stg_sales_order_detail"
[0m18:18:12.057810 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.stg_sales_order_detail"} */
drop table if exists "Adventureworks"."teste"."stg_sales_order_detail__dbt_backup" cascade
[0m18:18:12.061919 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:18:12.063362 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.stg_sales_order_detail (execute): 18:18:11.932174 => 18:18:12.063214
[0m18:18:12.063908 [debug] [Thread-1 (]: On model.dbt_tutorial.stg_sales_order_detail: Close
[0m18:18:12.064725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eccc538a-9421-42d0-a410-01f2e70b7dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554cafc760>]}
[0m18:18:12.065469 [info ] [Thread-1 (]: 3 of 5 OK created sql table model teste.stg_sales_order_detail ................. [[32mSELECT 121317[0m in 0.14s]
[0m18:18:12.066310 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m18:18:12.067495 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m18:18:12.068135 [info ] [Thread-1 (]: 4 of 5 START sql table model teste.int_sales_by_product ........................ [RUN]
[0m18:18:12.068978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_sales_order_detail, now model.dbt_tutorial.int_sales_by_product)
[0m18:18:12.069549 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.int_sales_by_product
[0m18:18:12.072219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.int_sales_by_product"
[0m18:18:12.077831 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.int_sales_by_product (compile): 18:18:12.070006 => 18:18:12.077465
[0m18:18:12.078662 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.int_sales_by_product
[0m18:18:12.082405 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.int_sales_by_product"
[0m18:18:12.087576 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m18:18:12.088138 [debug] [Thread-1 (]: On model.dbt_tutorial.int_sales_by_product: BEGIN
[0m18:18:12.088684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:12.093937 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:18:12.094627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m18:18:12.095200 [debug] [Thread-1 (]: On model.dbt_tutorial.int_sales_by_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.int_sales_by_product"} */

  
    

  create  table "Adventureworks"."teste"."int_sales_by_product__dbt_tmp"
  
  
    as
  
  (
    

WITH sales AS (
    SELECT
        sod.ProductID,
        SUM(sod.unitprice) AS TotalSales
    FROM "Adventureworks"."teste"."stg_sales_order_detail" sod
    GROUP BY sod.ProductID
)
SELECT 
    s.ProductID,
    s.TotalSales,
    p.ProductSubcategoryID
FROM sales s
JOIN "Adventureworks"."teste"."stg_product" p ON s.ProductID = p.ProductID
  );
  
[0m18:18:12.121821 [debug] [Thread-1 (]: SQL status: SELECT 266 in 0.0 seconds
[0m18:18:12.124754 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m18:18:12.125362 [debug] [Thread-1 (]: On model.dbt_tutorial.int_sales_by_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.int_sales_by_product"} */
alter table "Adventureworks"."teste"."int_sales_by_product" rename to "int_sales_by_product__dbt_backup"
[0m18:18:12.126601 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:12.129959 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m18:18:12.130618 [debug] [Thread-1 (]: On model.dbt_tutorial.int_sales_by_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.int_sales_by_product"} */
alter table "Adventureworks"."teste"."int_sales_by_product__dbt_tmp" rename to "int_sales_by_product"
[0m18:18:12.131574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:12.133377 [debug] [Thread-1 (]: On model.dbt_tutorial.int_sales_by_product: COMMIT
[0m18:18:12.133917 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m18:18:12.134457 [debug] [Thread-1 (]: On model.dbt_tutorial.int_sales_by_product: COMMIT
[0m18:18:12.137692 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:18:12.139708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.int_sales_by_product"
[0m18:18:12.140275 [debug] [Thread-1 (]: On model.dbt_tutorial.int_sales_by_product: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.int_sales_by_product"} */
drop table if exists "Adventureworks"."teste"."int_sales_by_product__dbt_backup" cascade
[0m18:18:12.144099 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:18:12.145412 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.int_sales_by_product (execute): 18:18:12.079204 => 18:18:12.145265
[0m18:18:12.145956 [debug] [Thread-1 (]: On model.dbt_tutorial.int_sales_by_product: Close
[0m18:18:12.146860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eccc538a-9421-42d0-a410-01f2e70b7dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554b99e2f0>]}
[0m18:18:12.147582 [info ] [Thread-1 (]: 4 of 5 OK created sql table model teste.int_sales_by_product ................... [[32mSELECT 266[0m in 0.08s]
[0m18:18:12.148381 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m18:18:12.149563 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m18:18:12.150181 [info ] [Thread-1 (]: 5 of 5 START sql table model teste.mart_sales_by_category ...................... [RUN]
[0m18:18:12.150961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.int_sales_by_product, now model.dbt_tutorial.mart_sales_by_category)
[0m18:18:12.151518 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.mart_sales_by_category
[0m18:18:12.154269 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.mart_sales_by_category"
[0m18:18:12.159722 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (compile): 18:18:12.151992 => 18:18:12.159523
[0m18:18:12.160545 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.mart_sales_by_category
[0m18:18:12.164150 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_tutorial.mart_sales_by_category"
[0m18:18:12.169276 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:18:12.169833 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: BEGIN
[0m18:18:12.170400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:12.175661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:18:12.176449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:18:12.177047 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */

  
    

  create  table "Adventureworks"."teste"."mart_sales_by_category__dbt_tmp"
  
  
    as
  
  (
    

WITH category_sales AS (
    SELECT
        pc.CategoryName,
        SUM(sp.TotalSales) AS TotalSales
    FROM "Adventureworks"."teste"."int_sales_by_product" sp
    JOIN "Adventureworks"."teste"."stg_product_category" pc 
        ON sp.ProductSubcategoryID = pc.ProductCategoryID
    GROUP BY pc.CategoryName
)
SELECT * FROM category_sales
  );
  
[0m18:18:12.179887 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.0 seconds
[0m18:18:12.182682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:18:12.183283 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
alter table "Adventureworks"."teste"."mart_sales_by_category" rename to "mart_sales_by_category__dbt_backup"
[0m18:18:12.184139 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:12.186432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:18:12.187014 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
alter table "Adventureworks"."teste"."mart_sales_by_category__dbt_tmp" rename to "mart_sales_by_category"
[0m18:18:12.187865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:12.189635 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: COMMIT
[0m18:18:12.190161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:18:12.190685 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: COMMIT
[0m18:18:12.194102 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:18:12.196215 [debug] [Thread-1 (]: Using postgres connection "model.dbt_tutorial.mart_sales_by_category"
[0m18:18:12.196810 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: /* {"app": "dbt", "dbt_version": "1.5.11", "profile_name": "dbt_tutorial", "target_name": "dev", "node_id": "model.dbt_tutorial.mart_sales_by_category"} */
drop table if exists "Adventureworks"."teste"."mart_sales_by_category__dbt_backup" cascade
[0m18:18:12.200728 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:18:12.202167 [debug] [Thread-1 (]: Timing info for model.dbt_tutorial.mart_sales_by_category (execute): 18:18:12.161078 => 18:18:12.201994
[0m18:18:12.202710 [debug] [Thread-1 (]: On model.dbt_tutorial.mart_sales_by_category: Close
[0m18:18:12.203526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eccc538a-9421-42d0-a410-01f2e70b7dad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554b958d90>]}
[0m18:18:12.204254 [info ] [Thread-1 (]: 5 of 5 OK created sql table model teste.mart_sales_by_category ................. [[32mSELECT 4[0m in 0.05s]
[0m18:18:12.205098 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m18:18:12.206626 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:12.207151 [debug] [MainThread]: On master: BEGIN
[0m18:18:12.207644 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:18:12.212834 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:18:12.213470 [debug] [MainThread]: On master: COMMIT
[0m18:18:12.213989 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:12.214502 [debug] [MainThread]: On master: COMMIT
[0m18:18:12.215183 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:18:12.215686 [debug] [MainThread]: On master: Close
[0m18:18:12.216462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:12.216957 [debug] [MainThread]: Connection 'model.dbt_tutorial.mart_sales_by_category' was properly closed.
[0m18:18:12.217544 [info ] [MainThread]: 
[0m18:18:12.218213 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m18:18:12.219506 [debug] [MainThread]: Command end result
[0m18:18:12.228705 [info ] [MainThread]: 
[0m18:18:12.229794 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:18:12.230713 [info ] [MainThread]: 
[0m18:18:12.231456 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:18:12.232263 [debug] [MainThread]: Command `dbt run` succeeded at 18:18:12.232165 after 2.06 seconds
[0m18:18:12.232852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554de99a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554b9958d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f554c10bf70>]}
[0m18:18:12.233509 [debug] [MainThread]: Flushing usage events
[0m21:37:45.514728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85519605f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f855391bef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85542db9b0>]}


============================== 21:37:45.517844 | d7752d1c-de72-4ef7-9617-ac0b59daa2d6 ==============================
[0m21:37:45.517844 [info ] [MainThread]: Running with dbt=1.10.0-b1
[0m21:37:45.518606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/dbt/dbt_tutorial/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate --profiles-dir /usr/local/airflow/dbt --project-dir /usr/local/airflow/dbt/dbt_tutorial', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:37:45.523334 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dbt_tutorial'
[0m21:37:45.524574 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.06694512, "process_in_blocks": "0", "process_kernel_time": 0.150935, "process_mem_max_rss": "105936", "process_out_blocks": "0", "process_user_time": 1.207483}
[0m21:37:45.525276 [debug] [MainThread]: Command `dbt docs generate` failed at 21:37:45.525178 after 0.07 seconds
[0m21:37:45.525784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85519876b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8551c9c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f855592adb0>]}
[0m21:37:45.526322 [debug] [MainThread]: Flushing usage events
[0m21:37:46.150406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:40:01.619897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6ab55d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6acf0c3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6ab419d60>]}


============================== 21:40:01.623883 | dcbdca0b-7770-4bb4-8496-28b11a3d2045 ==============================
[0m21:40:01.623883 [info ] [MainThread]: Running with dbt=1.10.0-b1
[0m21:40:01.624779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/dbt/dbt_tutorial', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/local/airflow/dbt/dbt_tutorial/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --profiles-dir /usr/local/airflow/dbt/dbt_tutorial --project-dir /usr/local/airflow/dbt/dbt_tutorial', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:40:01.906892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dcbdca0b-7770-4bb4-8496-28b11a3d2045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6aa68c470>]}
[0m21:40:01.967606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dcbdca0b-7770-4bb4-8496-28b11a3d2045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6abaf7950>]}
[0m21:40:01.968746 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:40:02.070984 [debug] [MainThread]: checksum: 41a201eb6e4746d10b1b4ad7b6a399a51bc67700905b139141d6683a36b897b6, vars: {}, profile: , target: , version: 1.10.0b1
[0m21:40:02.186338 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m21:40:02.187095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dcbdca0b-7770-4bb4-8496-28b11a3d2045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a93340b0>]}
[0m21:40:03.706549 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_tutorial.test_due_date_before_order_date' (tests/test_due_date_before_order_date.sql) depends on a node named 'sales_order_header' in package '' which was not found
[0m21:40:03.814873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcbdca0b-7770-4bb4-8496-28b11a3d2045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a8b0dca0>]}
[0m21:40:03.838300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcbdca0b-7770-4bb4-8496-28b11a3d2045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6abdc70e0>]}
[0m21:40:03.839032 [info ] [MainThread]: Found 5 models, 3 data tests, 3 sources, 432 macros
[0m21:40:03.839661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcbdca0b-7770-4bb4-8496-28b11a3d2045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a8b02660>]}
[0m21:40:03.841822 [info ] [MainThread]: 
[0m21:40:03.842573 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:40:03.843313 [info ] [MainThread]: 
[0m21:40:03.844141 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:40:03.849073 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks_teste'
[0m21:40:03.886806 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m21:40:03.887450 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m21:40:03.887985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:03.889800 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m21:40:03.890693 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m21:40:03.891263 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m21:40:03.891785 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m21:40:03.892245 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m21:40:03.892667 [debug] [ThreadPool]: On list_Adventureworks_teste: No close available on handle
[0m21:40:03.893574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:03.894022 [debug] [MainThread]: Connection 'list_Adventureworks_teste' was properly closed.
[0m21:40:03.894629 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m21:40:03.896184 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 2.3324525, "process_in_blocks": "72352", "process_kernel_time": 0.342039, "process_mem_max_rss": "130308", "process_out_blocks": "0", "process_user_time": 3.108537}
[0m21:40:03.896984 [debug] [MainThread]: Command `dbt docs generate` failed at 21:40:03.896835 after 2.33 seconds
[0m21:40:03.897550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6aa7480b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6aef071a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a87b6450>]}
[0m21:40:03.898109 [debug] [MainThread]: Flushing usage events
[0m21:40:04.774090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:57:56.770550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd06487a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0650f57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd06377d5b0>]}


============================== 21:57:56.773448 | aed4b8e3-7abd-45da-9689-661e85ddc6b6 ==============================
[0m21:57:56.773448 [info ] [MainThread]: Running with dbt=1.10.0-b1
[0m21:57:56.774337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/dbt/dbt_tutorial', 'log_path': '/usr/local/airflow/dbt/dbt_tutorial/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate --profiles-dir /usr/local/airflow/dbt/dbt_tutorial --project-dir /usr/local/airflow/dbt/dbt_tutorial', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:57:56.956634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aed4b8e3-7abd-45da-9689-661e85ddc6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd063355e20>]}
[0m21:57:57.017001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aed4b8e3-7abd-45da-9689-661e85ddc6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0647073e0>]}
[0m21:57:57.017967 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m21:57:57.117801 [debug] [MainThread]: checksum: 41a201eb6e4746d10b1b4ad7b6a399a51bc67700905b139141d6683a36b897b6, vars: {}, profile: , target: , version: 1.10.0b1
[0m21:57:57.237933 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:57:57.238659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aed4b8e3-7abd-45da-9689-661e85ddc6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd061fa51c0>]}
[0m21:57:58.748246 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_tutorial.test_due_date_before_order_date' (tests/test_due_date_before_order_date.sql) depends on a node named 'sales_order_header' in package '' which was not found
[0m21:57:58.857026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aed4b8e3-7abd-45da-9689-661e85ddc6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd06175fb00>]}
[0m21:57:58.873343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aed4b8e3-7abd-45da-9689-661e85ddc6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd06010fdd0>]}
[0m21:57:58.873976 [info ] [MainThread]: Found 5 models, 3 data tests, 3 sources, 432 macros
[0m21:57:58.874566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aed4b8e3-7abd-45da-9689-661e85ddc6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd06017cda0>]}
[0m21:57:58.876736 [info ] [MainThread]: 
[0m21:57:58.877483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:57:58.878229 [info ] [MainThread]: 
[0m21:57:58.879038 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:57:58.883812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_Adventureworks_teste'
[0m21:57:58.917040 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m21:57:58.917674 [debug] [ThreadPool]: On list_Adventureworks_teste: BEGIN
[0m21:57:58.918087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:58.923759 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m21:57:58.924217 [debug] [ThreadPool]: Using postgres connection "list_Adventureworks_teste"
[0m21:57:58.924671 [debug] [ThreadPool]: On list_Adventureworks_teste: /* {"app": "dbt", "dbt_version": "1.10.0b1", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "list_Adventureworks_teste"} */
select
      'Adventureworks' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'teste'
    union all
    select
      'Adventureworks' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'teste'
  
[0m21:57:58.927516 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m21:57:58.928940 [debug] [ThreadPool]: On list_Adventureworks_teste: ROLLBACK
[0m21:57:58.929536 [debug] [ThreadPool]: On list_Adventureworks_teste: Close
[0m21:57:58.935569 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:58.936083 [debug] [MainThread]: On master: BEGIN
[0m21:57:58.936624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:57:58.941526 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m21:57:58.942004 [debug] [MainThread]: Using postgres connection "master"
[0m21:57:58.942524 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.0b1", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:57:58.947211 [debug] [MainThread]: SQL status: SELECT 152 in 0.004 seconds
[0m21:57:58.952682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aed4b8e3-7abd-45da-9689-661e85ddc6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd062b4ae40>]}
[0m21:57:58.953316 [debug] [MainThread]: On master: ROLLBACK
[0m21:57:58.954025 [debug] [MainThread]: On master: Close
[0m21:57:58.956493 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product
[0m21:57:58.957022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_Adventureworks_teste, now model.dbt_tutorial.stg_product)
[0m21:57:58.957483 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product
[0m21:57:58.964667 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product"
[0m21:57:58.970086 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_product
[0m21:57:58.970884 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product
[0m21:57:58.971390 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_product_category
[0m21:57:58.971997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product, now model.dbt_tutorial.stg_product_category)
[0m21:57:58.972479 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_product_category
[0m21:57:58.975058 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_product_category"
[0m21:57:58.980193 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_product_category
[0m21:57:58.981038 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_product_category
[0m21:57:58.981535 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.stg_sales_order_detail
[0m21:57:58.982029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_product_category, now model.dbt_tutorial.stg_sales_order_detail)
[0m21:57:58.982460 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.stg_sales_order_detail
[0m21:57:58.985027 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.stg_sales_order_detail"
[0m21:57:58.990239 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.stg_sales_order_detail
[0m21:57:58.991017 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.stg_sales_order_detail
[0m21:57:58.991526 [debug] [Thread-1 (]: Began running node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m21:57:58.992093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.stg_sales_order_detail, now test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee)
[0m21:57:58.992602 [debug] [Thread-1 (]: Began compiling node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m21:57:59.004297 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee"
[0m21:57:59.009763 [debug] [Thread-1 (]: Began executing node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m21:57:59.010480 [debug] [Thread-1 (]: Finished running node test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee
[0m21:57:59.011031 [debug] [Thread-1 (]: Began running node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m21:57:59.011560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_tutorial.not_null_stg_product_productid.fbad0530ee, now test.dbt_tutorial.unique_stg_product_productid.90ff986d4a)
[0m21:57:59.011985 [debug] [Thread-1 (]: Began compiling node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m21:57:59.017922 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tutorial.unique_stg_product_productid.90ff986d4a"
[0m21:57:59.023426 [debug] [Thread-1 (]: Began executing node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m21:57:59.024140 [debug] [Thread-1 (]: Finished running node test.dbt_tutorial.unique_stg_product_productid.90ff986d4a
[0m21:57:59.024638 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.int_sales_by_product
[0m21:57:59.025121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_tutorial.unique_stg_product_productid.90ff986d4a, now model.dbt_tutorial.int_sales_by_product)
[0m21:57:59.025566 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.int_sales_by_product
[0m21:57:59.028492 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.int_sales_by_product"
[0m21:57:59.033737 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.int_sales_by_product
[0m21:57:59.034440 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.int_sales_by_product
[0m21:57:59.034907 [debug] [Thread-1 (]: Began running node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m21:57:59.035449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_tutorial.int_sales_by_product, now test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a)
[0m21:57:59.035940 [debug] [Thread-1 (]: Began compiling node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m21:57:59.039457 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a"
[0m21:57:59.044924 [debug] [Thread-1 (]: Began executing node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m21:57:59.045616 [debug] [Thread-1 (]: Finished running node test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a
[0m21:57:59.046080 [debug] [Thread-1 (]: Began running node model.dbt_tutorial.mart_sales_by_category
[0m21:57:59.046580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_tutorial.not_null_stg_sales_order_detail_salesorderid.0049f8ed3a, now model.dbt_tutorial.mart_sales_by_category)
[0m21:57:59.046990 [debug] [Thread-1 (]: Began compiling node model.dbt_tutorial.mart_sales_by_category
[0m21:57:59.049793 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_tutorial.mart_sales_by_category"
[0m21:57:59.055014 [debug] [Thread-1 (]: Began executing node model.dbt_tutorial.mart_sales_by_category
[0m21:57:59.055719 [debug] [Thread-1 (]: Finished running node model.dbt_tutorial.mart_sales_by_category
[0m21:57:59.057007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:59.057439 [debug] [MainThread]: Connection 'model.dbt_tutorial.mart_sales_by_category' was properly closed.
[0m21:57:59.059252 [debug] [MainThread]: Command end result
[0m21:57:59.173051 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dbt/dbt_tutorial/target/manifest.json
[0m21:57:59.177821 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dbt/dbt_tutorial/target/semantic_manifest.json
[0m21:57:59.187598 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/local/airflow/dbt/dbt_tutorial/target/run_results.json
[0m21:57:59.202993 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m21:57:59.203545 [info ] [MainThread]: Building catalog
[0m21:57:59.213888 [debug] [ThreadPool]: Acquiring new postgres connection 'Adventureworks.information_schema'
[0m21:57:59.221148 [debug] [ThreadPool]: Using postgres connection "Adventureworks.information_schema"
[0m21:57:59.221732 [debug] [ThreadPool]: On Adventureworks.information_schema: BEGIN
[0m21:57:59.222150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:59.227713 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m21:57:59.228247 [debug] [ThreadPool]: Using postgres connection "Adventureworks.information_schema"
[0m21:57:59.228775 [debug] [ThreadPool]: On Adventureworks.information_schema: /* {"app": "dbt", "dbt_version": "1.10.0b1", "profile_name": "dbt_tutorial", "target_name": "dev", "connection_name": "Adventureworks.information_schema"} */

    
    

    select
        'Adventureworks' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('production') and
           upper(tbl.relname) = upper('product')) or (upper(sch.nspname) = upper('teste') and
           upper(tbl.relname) = upper('stg_product_category')) or (upper(sch.nspname) = upper('teste') and
           upper(tbl.relname) = upper('int_sales_by_product')) or (upper(sch.nspname) = upper('teste') and
           upper(tbl.relname) = upper('mart_sales_by_category')) or (upper(sch.nspname) = upper('sales') and
           upper(tbl.relname) = upper('salesorderdetail')) or (upper(sch.nspname) = upper('production') and
           upper(tbl.relname) = upper('productcategory')) or (upper(sch.nspname) = upper('teste') and
           upper(tbl.relname) = upper('stg_product')) or (upper(sch.nspname) = upper('teste') and
           upper(tbl.relname) = upper('stg_sales_order_detail')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m21:57:59.232837 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.003 seconds
[0m21:57:59.238397 [debug] [ThreadPool]: On Adventureworks.information_schema: ROLLBACK
[0m21:57:59.239155 [debug] [ThreadPool]: On Adventureworks.information_schema: Close
[0m21:57:59.253906 [debug] [MainThread]: Wrote artifact CatalogArtifact to /usr/local/airflow/dbt/dbt_tutorial/target/catalog.json
[0m21:57:59.287080 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/local/airflow/dbt/dbt_tutorial/target/manifest.json
[0m21:57:59.291074 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/local/airflow/dbt/dbt_tutorial/target/semantic_manifest.json
[0m21:57:59.291574 [info ] [MainThread]: Catalog written to /usr/local/airflow/dbt/dbt_tutorial/target/catalog.json
[0m21:57:59.293045 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 2.5809593, "process_in_blocks": "0", "process_kernel_time": 0.219286, "process_mem_max_rss": "136244", "process_out_blocks": "0", "process_user_time": 3.408906}
[0m21:57:59.293906 [debug] [MainThread]: Command `dbt docs generate` succeeded at 21:57:59.293781 after 2.58 seconds
[0m21:57:59.294433 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m21:57:59.294946 [debug] [MainThread]: Connection 'Adventureworks.information_schema' was properly closed.
[0m21:57:59.295510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd063308b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd06014a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd063d26d50>]}
[0m21:57:59.296017 [debug] [MainThread]: Flushing usage events
[0m21:58:00.299958 [debug] [MainThread]: An error was encountered while trying to flush usage events
